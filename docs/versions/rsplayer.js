var RetailSpot;(()=>{var e={495:function(e,t){!function(e){"use strict";function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function n(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?t(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function d(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=c(e);if(t){var i=c(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}function f(e){return function(e){if(Array.isArray(e))return h(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:e.id||null,adId:e.adId||null,sequence:e.sequence||null,apiFramework:e.apiFramework||null,universalAdIds:[],creativeExtensions:[]}}var y=["ADCATEGORIES","ADCOUNT","ADPLAYHEAD","ADSERVINGID","ADTYPE","APIFRAMEWORKS","APPBUNDLE","ASSETURI","BLOCKEDADCATEGORIES","BREAKMAXADLENGTH","BREAKMAXADS","BREAKMAXDURATION","BREAKMINADLENGTH","BREAKMINDURATION","BREAKPOSITION","CLICKPOS","CLICKTYPE","CLIENTUA","CONTENTID","CONTENTPLAYHEAD","CONTENTURI","DEVICEIP","DEVICEUA","DOMAIN","EXTENSIONS","GDPRCONSENT","IFA","IFATYPE","INVENTORYSTATE","LATLONG","LIMITADTRACKING","MEDIAMIME","MEDIAPLAYHEAD","OMIDPARTNER","PAGEURL","PLACEMENTTYPE","PLAYERCAPABILITIES","PLAYERSIZE","PLAYERSTATE","PODSEQUENCE","REGULATIONS","SERVERSIDE","SERVERUA","TRANSACTIONID","UNIVERSALADID","VASTVERSIONS","VERIFICATIONVENDORS"];function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[],i=A(e);for(var o in!t.ERRORCODE||n.isCustomCode||/^[0-9]{3}$/.test(t.ERRORCODE)||(t.ERRORCODE=900),t.CACHEBUSTING=E(Math.round(1e8*Math.random())),t.TIMESTAMP=(new Date).toISOString(),t.RANDOM=t.random=t.CACHEBUSTING,t)t[o]=T(t[o]);for(var a in i){var s=i[a];"string"==typeof s&&r.push(g(s,t))}return r}function g(e,t){var n=(e=b(e,t)).match(/[^[\]]+(?=])/g);if(!n)return e;var r=n.filter((function(e){return y.indexOf(e)>-1}));return 0===r.length?e:b(e,r=r.reduce((function(e,t){return e[t]=-1,e}),{}))}function b(e,t){var n=e;for(var r in t){var i=t[r];n=n.replace(new RegExp("(?:\\[|%%)(".concat(r,")(?:\\]|%%)"),"g"),i)}return n}function A(e){return Array.isArray(e)?e.map((function(e){return e&&e.hasOwnProperty("url")?e.url:e})):e}function w(e,t){for(var n=0;n<t.length;n++)if(k(t[n],e))return!0;return!1}function k(e,t){if(e&&t){var n=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(t);return n.length===r.length&&e.id===t.id&&e.url===t.url}return!1}function T(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%".concat(e.charCodeAt(0).toString(16))}))}function E(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;return e.toString().padStart(t,"0")}var R={track:function(e,t,n){m(e,t,n).forEach((function(e){"undefined"!=typeof window&&null!==window&&((new Image).src=e)}))},resolveURLTemplates:m,extractURLsFromTemplates:A,containsTemplateObject:w,isTemplateObjectEqual:k,encodeURIComponentRFC3986:T,replaceUrlMacros:g,isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},flatten:function e(t){return t.reduce((function(t,n){return t.concat(Array.isArray(n)?e(n):n)}),[])},joinArrayOfUniqueTemplateObjs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=Array.isArray(e)?e:[],r=Array.isArray(t)?t:[];return n.concat(r).reduce((function(e,t){return w(t,e)||e.push(t),e}),[])},isValidTimeValue:function(e){return Number.isFinite(e)&&e>=-2},addLeadingZeros:E};function S(e){return-1!==["true","TRUE","True","1"].indexOf(e)}var O={childByName:function(e,t){var n=e.childNodes;for(var r in n){var i=n[r];if(i.nodeName===t)return i}},childrenByName:function(e,t){var n=[],r=e.childNodes;for(var i in r){var o=r[i];o.nodeName===t&&n.push(o)}return n},resolveVastAdTagURI:function(e,t){if(!t)return e;if(0===e.indexOf("//")){var n=location.protocol;return"".concat(n).concat(e)}if(-1===e.indexOf("://")){var r=t.slice(0,t.lastIndexOf("/"));return"".concat(r,"/").concat(e)}return e},parseBoolean:S,parseNodeText:function(e){return e&&(e.textContent||e.text||"").trim()},copyNodeAttribute:function(e,t,n){var r=t.getAttribute(e);r&&n.setAttribute(e,r)},parseAttributes:function(e){for(var t=e.attributes,n={},r=0;r<t.length;r++)n[t[r].nodeName]=t[r].nodeValue;return n},parseDuration:function(e){if(null==e)return-1;if(R.isNumeric(e))return parseInt(e);var t=e.split(":");if(3!==t.length)return-1;var n=t[2].split("."),r=parseInt(n[0]);2===n.length&&(r+=parseFloat("0.".concat(n[1])));var i=parseInt(60*t[1]),o=parseInt(60*t[0]*60);return isNaN(o)||isNaN(i)||isNaN(r)||i>3600||r>60?-1:o+i+r},splitVAST:function(e){var t=[],n=null;return e.forEach((function(r,i){if(r.sequence&&(r.sequence=parseInt(r.sequence,10)),r.sequence>1){var o=e[i-1];if(o&&o.sequence===r.sequence-1)return void(n&&n.push(r));delete r.sequence}n=[r],t.push(n)})),t},assignAttributes:function(e,t){if(e)for(var n in e){var r=e[n];if(r.nodeName&&r.nodeValue&&t.hasOwnProperty(r.nodeName)){var i=r.nodeValue;"boolean"==typeof t[r.nodeName]&&(i=S(i)),t[r.nodeName]=i}}},mergeWrapperAdData:function(e,t){e.errorURLTemplates=t.errorURLTemplates.concat(e.errorURLTemplates),e.impressionURLTemplates=t.impressionURLTemplates.concat(e.impressionURLTemplates),e.extensions=t.extensions.concat(e.extensions),t.viewableImpression.length>0&&(e.viewableImpression=[].concat(f(e.viewableImpression),f(t.viewableImpression))),e.followAdditionalWrappers=t.followAdditionalWrappers,e.allowMultipleAds=t.allowMultipleAds,e.fallbackOnNoAd=t.fallbackOnNoAd;var n=(t.creatives||[]).filter((function(e){return e&&"companion"===e.type})),r=n.reduce((function(e,t){return(t.variations||[]).forEach((function(t){(t.companionClickTrackingURLTemplates||[]).forEach((function(t){R.containsTemplateObject(t,e)||e.push(t)}))})),e}),[]);e.creatives=n.concat(e.creatives);var i=t.videoClickTrackingURLTemplates&&t.videoClickTrackingURLTemplates.length,o=t.videoCustomClickURLTemplates&&t.videoCustomClickURLTemplates.length;e.creatives.forEach((function(e){if(t.trackingEvents&&t.trackingEvents[e.type])for(var n in t.trackingEvents[e.type]){var a=t.trackingEvents[e.type][n];Array.isArray(e.trackingEvents[n])||(e.trackingEvents[n]=[]),e.trackingEvents[n]=e.trackingEvents[n].concat(a)}"linear"===e.type&&(i&&(e.videoClickTrackingURLTemplates=e.videoClickTrackingURLTemplates.concat(t.videoClickTrackingURLTemplates)),o&&(e.videoCustomClickURLTemplates=e.videoCustomClickURLTemplates.concat(t.videoCustomClickURLTemplates)),!t.videoClickThroughURLTemplate||null!==e.videoClickThroughURLTemplate&&void 0!==e.videoClickThroughURLTemplate||(e.videoClickThroughURLTemplate=t.videoClickThroughURLTemplate)),"companion"===e.type&&r.length&&(e.variations||[]).forEach((function(e){e.companionClickTrackingURLTemplates=R.joinArrayOfUniqueTemplateObjs(e.companionClickTrackingURLTemplates,r)}))})),t.adVerifications&&(e.adVerifications=e.adVerifications.concat(t.adVerifications)),t.blockedAdCategories&&(e.blockedAdCategories=e.blockedAdCategories.concat(t.blockedAdCategories))}};function C(e,t){var n=function(){var e=v(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return{id:e.id,adId:e.adId,sequence:e.sequence,apiFramework:e.apiFramework,type:"companion",required:null,variations:[]}}(t);return n.required=e.getAttribute("required")||null,n.variations=O.childrenByName(e,"Companion").map((function(e){var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:e.id||null,adType:"companionAd",width:e.width||0,height:e.height||0,assetWidth:e.assetWidth||null,assetHeight:e.assetHeight||null,expandedWidth:e.expandedWidth||null,expandedHeight:e.expandedHeight||null,apiFramework:e.apiFramework||null,adSlotID:e.adSlotID||null,pxratio:e.pxratio||"1",renderingMode:e.renderingMode||"default",staticResources:[],htmlResources:[],iframeResources:[],adParameters:null,xmlEncoded:null,altText:null,companionClickThroughURLTemplate:null,companionClickTrackingURLTemplates:[],trackingEvents:{}}}(O.parseAttributes(e));t.htmlResources=O.childrenByName(e,"HTMLResource").reduce((function(e,t){var n=O.parseNodeText(t);return n?e.concat(n):e}),[]),t.iframeResources=O.childrenByName(e,"IFrameResource").reduce((function(e,t){var n=O.parseNodeText(t);return n?e.concat(n):e}),[]),t.staticResources=O.childrenByName(e,"StaticResource").reduce((function(e,t){var n=O.parseNodeText(t);return n?e.concat({url:n,creativeType:t.getAttribute("creativeType")||null}):e}),[]),t.altText=O.parseNodeText(O.childByName(e,"AltText"))||null;var n=O.childByName(e,"TrackingEvents");n&&O.childrenByName(n,"Tracking").forEach((function(e){var n=e.getAttribute("event"),r=O.parseNodeText(e);n&&r&&(Array.isArray(t.trackingEvents[n])||(t.trackingEvents[n]=[]),t.trackingEvents[n].push(r))})),t.companionClickTrackingURLTemplates=O.childrenByName(e,"CompanionClickTracking").map((function(e){return{id:e.getAttribute("id")||null,url:O.parseNodeText(e)}})),t.companionClickThroughURLTemplate=O.parseNodeText(O.childByName(e,"CompanionClickThrough"))||null;var r=O.childByName(e,"AdParameters");return r&&(t.adParameters=O.parseNodeText(r),t.xmlEncoded=r.getAttribute("xmlEncoded")||null),t})),n}function P(e){return"linear"===e.type}function L(e,t){var n,r=function(){var e=v(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return{id:e.id,adId:e.adId,sequence:e.sequence,apiFramework:e.apiFramework,type:"linear",duration:0,skipDelay:null,mediaFiles:[],mezzanine:null,interactiveCreativeFile:null,closedCaptionFiles:[],videoClickThroughURLTemplate:null,videoClickTrackingURLTemplates:[],videoCustomClickURLTemplates:[],adParameters:null,icons:[],trackingEvents:{}}}(t);r.duration=O.parseDuration(O.parseNodeText(O.childByName(e,"Duration")));var i=e.getAttribute("skipoffset");if(null==i)r.skipDelay=null;else if("%"===i.charAt(i.length-1)&&-1!==r.duration){var o=parseInt(i,10);r.skipDelay=r.duration*(o/100)}else r.skipDelay=O.parseDuration(i);var a=O.childByName(e,"VideoClicks");if(a){var s=O.childByName(a,"ClickThrough");r.videoClickThroughURLTemplate=s?{id:s.getAttribute("id")||null,url:O.parseNodeText(s)}:null,O.childrenByName(a,"ClickTracking").forEach((function(e){r.videoClickTrackingURLTemplates.push({id:e.getAttribute("id")||null,url:O.parseNodeText(e)})})),O.childrenByName(a,"CustomClick").forEach((function(e){r.videoCustomClickURLTemplates.push({id:e.getAttribute("id")||null,url:O.parseNodeText(e)})}))}var l=O.childByName(e,"AdParameters");l&&(r.adParameters=O.parseNodeText(l)),O.childrenByName(e,"TrackingEvents").forEach((function(e){O.childrenByName(e,"Tracking").forEach((function(e){var t=e.getAttribute("event"),i=O.parseNodeText(e);if(t&&i){if("progress"===t){if(!(n=e.getAttribute("offset")))return;t="%"===n.charAt(n.length-1)?"progress-".concat(n):"progress-".concat(Math.round(O.parseDuration(n)))}Array.isArray(r.trackingEvents[t])||(r.trackingEvents[t]=[]),r.trackingEvents[t].push(i)}}))})),O.childrenByName(e,"MediaFiles").forEach((function(e){O.childrenByName(e,"MediaFile").forEach((function(e){r.mediaFiles.push(function(e){var t={id:null,fileURL:null,fileSize:0,deliveryType:"progressive",mimeType:null,mediaType:null,codec:null,bitrate:0,minBitrate:0,maxBitrate:0,width:0,height:0,apiFramework:null,scalable:null,maintainAspectRatio:null};t.id=e.getAttribute("id"),t.fileURL=O.parseNodeText(e),t.deliveryType=e.getAttribute("delivery"),t.codec=e.getAttribute("codec"),t.mimeType=e.getAttribute("type"),t.mediaType=e.getAttribute("mediaType")||"2D",t.apiFramework=e.getAttribute("apiFramework"),t.fileSize=parseInt(e.getAttribute("fileSize")||0),t.bitrate=parseInt(e.getAttribute("bitrate")||0),t.minBitrate=parseInt(e.getAttribute("minBitrate")||0),t.maxBitrate=parseInt(e.getAttribute("maxBitrate")||0),t.width=parseInt(e.getAttribute("width")||0),t.height=parseInt(e.getAttribute("height")||0);var n=e.getAttribute("scalable");n&&"string"==typeof n&&(t.scalable=O.parseBoolean(n));var r=e.getAttribute("maintainAspectRatio");return r&&"string"==typeof r&&(t.maintainAspectRatio=O.parseBoolean(r)),t}(e))}));var t=O.childByName(e,"InteractiveCreativeFile");t&&(r.interactiveCreativeFile=function(e){var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:e.type||null,apiFramework:e.apiFramework||null,variableDuration:O.parseBoolean(e.variableDuration),fileURL:null}}(O.parseAttributes(e));return t.fileURL=O.parseNodeText(e),t}(t));var n=O.childByName(e,"ClosedCaptionFiles");n&&O.childrenByName(n,"ClosedCaptionFile").forEach((function(e){var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:e.type||null,language:e.language||null,fileURL:null}}(O.parseAttributes(e));t.fileURL=O.parseNodeText(e),r.closedCaptionFiles.push(t)}));var i,o,a,s=O.childByName(e,"Mezzanine"),l=(i=s,o={},a=!1,["delivery","type","width","height"].forEach((function(e){i&&i.getAttribute(e)?o[e]=i.getAttribute(e):a=!0})),a?null:o);if(l){var c={id:null,fileURL:null,delivery:null,codec:null,type:null,width:0,height:0,fileSize:0,mediaType:"2D"};c.id=s.getAttribute("id"),c.fileURL=O.parseNodeText(s),c.delivery=l.delivery,c.codec=s.getAttribute("codec"),c.type=l.type,c.width=parseInt(l.width,10),c.height=parseInt(l.height,10),c.fileSize=parseInt(s.getAttribute("fileSize"),10),c.mediaType=s.getAttribute("mediaType")||"2D",r.mezzanine=c}}));var c=O.childByName(e,"Icons");return c&&O.childrenByName(c,"Icon").forEach((function(e){r.icons.push(function(e){var t={program:null,height:0,width:0,xPosition:0,yPosition:0,apiFramework:null,offset:null,duration:0,type:null,staticResource:null,htmlResource:null,iframeResource:null,pxratio:"1",iconClickThroughURLTemplate:null,iconClickTrackingURLTemplates:[],iconViewTrackingURLTemplate:null};t.program=e.getAttribute("program"),t.height=parseInt(e.getAttribute("height")||0),t.width=parseInt(e.getAttribute("width")||0),t.xPosition=function(e){return-1!==["left","right"].indexOf(e)?e:parseInt(e||0)}(e.getAttribute("xPosition")),t.yPosition=function(e){return-1!==["top","bottom"].indexOf(e)?e:parseInt(e||0)}(e.getAttribute("yPosition")),t.apiFramework=e.getAttribute("apiFramework"),t.pxratio=e.getAttribute("pxratio")||"1",t.offset=O.parseDuration(e.getAttribute("offset")),t.duration=O.parseDuration(e.getAttribute("duration")),O.childrenByName(e,"HTMLResource").forEach((function(e){t.type=e.getAttribute("creativeType")||"text/html",t.htmlResource=O.parseNodeText(e)})),O.childrenByName(e,"IFrameResource").forEach((function(e){t.type=e.getAttribute("creativeType")||0,t.iframeResource=O.parseNodeText(e)})),O.childrenByName(e,"StaticResource").forEach((function(e){t.type=e.getAttribute("creativeType")||0,t.staticResource=O.parseNodeText(e)}));var n=O.childByName(e,"IconClicks");return n&&(t.iconClickThroughURLTemplate=O.parseNodeText(O.childByName(n,"IconClickThrough")),O.childrenByName(n,"IconClickTracking").forEach((function(e){t.iconClickTrackingURLTemplates.push({id:e.getAttribute("id")||null,url:O.parseNodeText(e)})}))),t.iconViewTrackingURLTemplate=O.parseNodeText(O.childByName(e,"IconViewTracking")),t}(e))})),r}function x(e,t){var n=function(){var e=v(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return{id:e.id,adId:e.adId,sequence:e.sequence,apiFramework:e.apiFramework,type:"nonlinear",variations:[],trackingEvents:{}}}(t);return O.childrenByName(e,"TrackingEvents").forEach((function(e){var t,r;O.childrenByName(e,"Tracking").forEach((function(e){t=e.getAttribute("event"),r=O.parseNodeText(e),t&&r&&(Array.isArray(n.trackingEvents[t])||(n.trackingEvents[t]=[]),n.trackingEvents[t].push(r))}))})),O.childrenByName(e,"NonLinear").forEach((function(e){var t={id:null,width:0,height:0,expandedWidth:0,expandedHeight:0,scalable:!0,maintainAspectRatio:!0,minSuggestedDuration:0,apiFramework:"static",adType:"nonLinearAd",type:null,staticResource:null,htmlResource:null,iframeResource:null,nonlinearClickThroughURLTemplate:null,nonlinearClickTrackingURLTemplates:[],adParameters:null};t.id=e.getAttribute("id")||null,t.width=e.getAttribute("width"),t.height=e.getAttribute("height"),t.expandedWidth=e.getAttribute("expandedWidth"),t.expandedHeight=e.getAttribute("expandedHeight"),t.scalable=O.parseBoolean(e.getAttribute("scalable")),t.maintainAspectRatio=O.parseBoolean(e.getAttribute("maintainAspectRatio")),t.minSuggestedDuration=O.parseDuration(e.getAttribute("minSuggestedDuration")),t.apiFramework=e.getAttribute("apiFramework"),O.childrenByName(e,"HTMLResource").forEach((function(e){t.type=e.getAttribute("creativeType")||"text/html",t.htmlResource=O.parseNodeText(e)})),O.childrenByName(e,"IFrameResource").forEach((function(e){t.type=e.getAttribute("creativeType")||0,t.iframeResource=O.parseNodeText(e)})),O.childrenByName(e,"StaticResource").forEach((function(e){t.type=e.getAttribute("creativeType")||0,t.staticResource=O.parseNodeText(e)}));var r=O.childByName(e,"AdParameters");r&&(t.adParameters=O.parseNodeText(r)),t.nonlinearClickThroughURLTemplate=O.parseNodeText(O.childByName(e,"NonLinearClickThrough")),O.childrenByName(e,"NonLinearClickTracking").forEach((function(e){t.nonlinearClickTrackingURLTemplates.push({id:e.getAttribute("id")||null,url:O.parseNodeText(e)})})),n.variations.push(t)})),n}function I(e){var t=[];return e.forEach((function(e){var n=N(e);n&&t.push(n)})),t}function N(e){if("#comment"===e.nodeName)return null;var t,n={name:null,value:null,attributes:{},children:[]},r=e.attributes,i=e.childNodes;if(n.name=e.nodeName,e.attributes)for(var o in r)if(r.hasOwnProperty(o)){var a=r[o];a.nodeName&&a.nodeValue&&(n.attributes[a.nodeName]=a.nodeValue)}for(var s in i)if(i.hasOwnProperty(s)){var l=N(i[s]);l&&n.children.push(l)}if(0===n.children.length||1===n.children.length&&["#cdata-section","#text"].indexOf(n.children[0].name)>=0){var c=O.parseNodeText(e);""!==c&&(n.value=c),n.children=[]}return null===(t=n).value&&0===Object.keys(t.attributes).length&&0===t.children.length?null:n}function j(e){var t=[];return e.forEach((function(e){var n,r={id:e.getAttribute("id")||null,adId:D(e),sequence:e.getAttribute("sequence")||null,apiFramework:e.getAttribute("apiFramework")||null},i=[];O.childrenByName(e,"UniversalAdId").forEach((function(e){var t={idRegistry:e.getAttribute("idRegistry")||"unknown",value:O.parseNodeText(e)};i.push(t)}));var o=O.childByName(e,"CreativeExtensions");for(var a in o&&(n=I(O.childrenByName(o,"CreativeExtension"))),e.childNodes){var s=e.childNodes[a],l=void 0;switch(s.nodeName){case"Linear":l=L(s,r);break;case"NonLinearAds":l=x(s,r);break;case"CompanionAds":l=C(s,r)}l&&(i&&(l.universalAdIds=i),n&&(l.creativeExtensions=n),t.push(l))}})),t}function D(e){return e.getAttribute("AdID")||e.getAttribute("adID")||e.getAttribute("adId")||null}var U={Wrapper:{subElements:["VASTAdTagURI","Impression"]},BlockedAdCategories:{attributes:["authority"]},InLine:{subElements:["AdSystem","AdTitle","Impression","AdServingId","Creatives"]},Category:{attributes:["authority"]},Pricing:{attributes:["model","currency"]},Verification:{oneOfinLineResources:["JavaScriptResource","ExecutableResource"],attributes:["vendor"]},UniversalAdId:{attributes:["idRegistry"]},JavaScriptResource:{attributes:["apiFramework","browserOptional"]},ExecutableResource:{attributes:["apiFramework","type"]},Tracking:{attributes:["event"]},Creatives:{subElements:["Creative"]},Creative:{subElements:["UniversalAdId"]},Linear:{subElements:["MediaFiles","Duration"]},MediaFiles:{subElements:["MediaFile"]},MediaFile:{attributes:["delivery","type","width","height"]},Mezzanine:{attributes:["delivery","type","width","height"]},NonLinear:{oneOfinLineResources:["StaticResource","IFrameResource","HTMLResource"],attributes:["width","height"]},Companion:{oneOfinLineResources:["StaticResource","IFrameResource","HTMLResource"],attributes:["width","height"]},StaticResource:{attributes:["creativeType"]},Icons:{subElements:["Icon"]},Icon:{oneOfinLineResources:["StaticResource","IFrameResource","HTMLResource"]}};function V(e,t){if(U[e.nodeName]&&U[e.nodeName].attributes){var n=U[e.nodeName].attributes.filter((function(t){return!e.getAttribute(t)}));n.length>0&&M({name:e.nodeName,parentName:e.parentNode.nodeName,attributes:n},t)}}function _(e,t,n){var r=U[e.nodeName],i=!n&&"Wrapper"!==e.nodeName;if(r&&!i){if(r.subElements){var o=r.subElements.filter((function(t){return!O.childByName(e,t)}));o.length>0&&M({name:e.nodeName,parentName:e.parentNode.nodeName,subElements:o},t)}n&&r.oneOfinLineResources&&(r.oneOfinLineResources.some((function(t){return O.childByName(e,t)}))||M({name:e.nodeName,parentName:e.parentNode.nodeName,oneOfResources:r.oneOfinLineResources},t))}}function B(e){return e.children&&0!==e.children.length}function M(e,t){var n=e.name,r=e.parentName,i=e.attributes,o=e.subElements,a=e.oneOfResources,s="Element '".concat(n,"'");t("VAST-warning",{message:s+=i?" missing required attribute(s) '".concat(i.join(", "),"' "):o?" missing required sub element(s) '".concat(o.join(", "),"' "):a?" must provide one of the following '".concat(a.join(", "),"' "):" is empty",parentElement:r,specVersion:4.1})}var F={verifyRequiredValues:function e(t,n,r){if(t&&t.nodeName)if("InLine"===t.nodeName&&(r=!0),V(t,n),B(t)){_(t,n,r);for(var i=0;i<t.children.length;i++)e(t.children[i],n,r)}else 0===O.parseNodeText(t).length&&M({name:t.nodeName,parentName:t.parentNode.nodeName},n)},hasSubElements:B,emitMissingValueWarning:M,verifyRequiredAttributes:V,verifyRequiredSubElements:_};function W(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.allowMultipleAds,i=n.followAdditionalWrappers,o=e.childNodes;for(var a in o){var s=o[a];if(-1!==["Wrapper","InLine"].indexOf(s.nodeName)&&("Wrapper"!==s.nodeName||!1!==i)){if(O.copyNodeAttribute("id",e,s),O.copyNodeAttribute("sequence",e,s),O.copyNodeAttribute("adType",e,s),"Wrapper"===s.nodeName)return{ad:z(s,t),type:"WRAPPER"};if("InLine"===s.nodeName)return{ad:H(s,t,{allowMultipleAds:r}),type:"INLINE"}}}}function H(e,t){return!1===(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).allowMultipleAds&&e.getAttribute("sequence")?null:q(e,t)}function q(e,t){var n=[];t&&F.verifyRequiredValues(e,t);var r=e.childNodes,i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:e.id||null,sequence:e.sequence||null,adType:e.adType||null,adServingId:null,categories:[],expires:null,viewableImpression:[],system:null,title:null,description:null,advertiser:null,pricing:null,survey:null,errorURLTemplates:[],impressionURLTemplates:[],creatives:[],extensions:[],adVerifications:[],blockedAdCategories:[],followAdditionalWrappers:!0,allowMultipleAds:!1,fallbackOnNoAd:null}}(O.parseAttributes(e));for(var o in r){var a=r[o];switch(a.nodeName){case"Error":i.errorURLTemplates.push(O.parseNodeText(a));break;case"Impression":i.impressionURLTemplates.push({id:a.getAttribute("id")||null,url:O.parseNodeText(a)});break;case"Creatives":i.creatives=j(O.childrenByName(a,"Creative"));break;case"Extensions":var s=O.childrenByName(a,"Extension");i.extensions=I(s),i.adVerifications.length||(n=G(s));break;case"AdVerifications":i.adVerifications=Q(O.childrenByName(a,"Verification"));break;case"AdSystem":i.system={value:O.parseNodeText(a),version:a.getAttribute("version")||null};break;case"AdTitle":i.title=O.parseNodeText(a);break;case"AdServingId":i.adServingId=O.parseNodeText(a);break;case"Category":i.categories.push({authority:a.getAttribute("authority")||null,value:O.parseNodeText(a)});break;case"Expires":i.expires=parseInt(O.parseNodeText(a),10);break;case"ViewableImpression":i.viewableImpression.push(X(a));break;case"Description":i.description=O.parseNodeText(a);break;case"Advertiser":i.advertiser={id:a.getAttribute("id")||null,value:O.parseNodeText(a)};break;case"Pricing":i.pricing={value:O.parseNodeText(a),model:a.getAttribute("model")||null,currency:a.getAttribute("currency")||null};break;case"Survey":i.survey=O.parseNodeText(a);break;case"BlockedAdCategories":i.blockedAdCategories.push({authority:a.getAttribute("authority")||null,value:O.parseNodeText(a)})}}return n.length&&(i.adVerifications=i.adVerifications.concat(n)),i}function z(e,t){var n=q(e,t),r=e.getAttribute("followAdditionalWrappers"),i=e.getAttribute("allowMultipleAds"),o=e.getAttribute("fallbackOnNoAd");n.followAdditionalWrappers=!r||O.parseBoolean(r),n.allowMultipleAds=!!i&&O.parseBoolean(i),n.fallbackOnNoAd=o?O.parseBoolean(o):null;var a=O.childByName(e,"VASTAdTagURI");if(a?n.nextWrapperURL=O.parseNodeText(a):(a=O.childByName(e,"VASTAdTagURL"))&&(n.nextWrapperURL=O.parseNodeText(O.childByName(a,"URL"))),n.creatives.forEach((function(e){if(-1!==["linear","nonlinear"].indexOf(e.type)){if(e.trackingEvents){n.trackingEvents||(n.trackingEvents={}),n.trackingEvents[e.type]||(n.trackingEvents[e.type]={});var t=function(t){var r=e.trackingEvents[t];Array.isArray(n.trackingEvents[e.type][t])||(n.trackingEvents[e.type][t]=[]),r.forEach((function(r){n.trackingEvents[e.type][t].push(r)}))};for(var r in e.trackingEvents)t(r)}e.videoClickTrackingURLTemplates&&(Array.isArray(n.videoClickTrackingURLTemplates)||(n.videoClickTrackingURLTemplates=[]),e.videoClickTrackingURLTemplates.forEach((function(e){n.videoClickTrackingURLTemplates.push(e)}))),e.videoClickThroughURLTemplate&&(n.videoClickThroughURLTemplate=e.videoClickThroughURLTemplate),e.videoCustomClickURLTemplates&&(Array.isArray(n.videoCustomClickURLTemplates)||(n.videoCustomClickURLTemplates=[]),e.videoCustomClickURLTemplates.forEach((function(e){n.videoCustomClickURLTemplates.push(e)})))}})),n.nextWrapperURL)return n}function Q(e){var t=[];return e.forEach((function(e){var n={resource:null,vendor:null,browserOptional:!1,apiFramework:null,type:null,parameters:null,trackingEvents:{}},r=e.childNodes;for(var i in O.assignAttributes(e.attributes,n),r){var o=r[i];switch(o.nodeName){case"JavaScriptResource":case"ExecutableResource":n.resource=O.parseNodeText(o),O.assignAttributes(o.attributes,n);break;case"VerificationParameters":n.parameters=O.parseNodeText(o)}}var a=O.childByName(e,"TrackingEvents");a&&O.childrenByName(a,"Tracking").forEach((function(e){var t=e.getAttribute("event"),r=O.parseNodeText(e);t&&r&&(Array.isArray(n.trackingEvents[t])||(n.trackingEvents[t]=[]),n.trackingEvents[t].push(r))})),t.push(n)})),t}function G(e){var t=null,n=[];return e.some((function(e){return t=O.childByName(e,"AdVerifications")})),t&&(n=Q(O.childrenByName(t,"Verification"))),n}function X(e){var t={};t.id=e.getAttribute("id")||null;var n=e.childNodes;for(var r in n){var i=n[r],o=i.nodeName,a=O.parseNodeText(i);if(("Viewable"===o||"NotViewable"===o||"ViewUndetermined"===o)&&a){var s=o.toLowerCase();Array.isArray(t[s])||(t[s]=[]),t[s].push(a)}}return t}var Y=function(){function e(){i(this,e),this._handlers=[]}return a(e,[{key:"on",value:function(e,t){if("function"!=typeof t)throw new TypeError("The handler argument must be of type Function. Received type ".concat(r(t)));if(!e)throw new TypeError("The event argument must be of type String. Received type ".concat(r(e)));return this._handlers.push({event:e,handler:t}),this}},{key:"once",value:function(e,t){return this.on(e,function(e,t,n){var r={fired:!1,wrapFn:void 0};function i(){r.fired||(e.off(t,r.wrapFn),r.fired=!0,n.bind(e).apply(void 0,arguments))}return r.wrapFn=i,i}(this,e,t))}},{key:"off",value:function(e,t){return this._handlers=this._handlers.filter((function(n){return n.event!==e||n.handler!==t})),this}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=!1;return this._handlers.forEach((function(t){"*"===t.event&&(i=!0,t.handler.apply(t,[e].concat(n))),t.event===e&&(i=!0,t.handler.apply(t,n))})),i}},{key:"removeAllListeners",value:function(e){return e?(this._handlers=this._handlers.filter((function(t){return t.event!==e})),this):(this._handlers=[],this)}},{key:"listenerCount",value:function(e){return this._handlers.filter((function(t){return t.event===e})).length}},{key:"listeners",value:function(e){return this._handlers.reduce((function(t,n){return n.event===e&&t.push(n.handler),t}),[])}},{key:"eventNames",value:function(){return this._handlers.map((function(e){return e.event}))}}]),e}(),K={get:function(e,t,n){n(new Error("Please bundle the library for node to use the node urlHandler"))}},$=12e4;function Z(){try{var e=new window.XMLHttpRequest;return"withCredentials"in e?e:null}catch(e){return null}}function J(e,t,n){var r=n?408:e.status,i=n?"XHRURLHandler: Request timed out after ".concat(e.timeout," ms (").concat(r,")"):"XHRURLHandler: ".concat(e.statusText," (").concat(r,")");t(new Error(i),null,{statusCode:r})}var ee={get:function(e,t,n){if("https:"===window.location.protocol&&0===e.indexOf("http://"))return n(new Error("XHRURLHandler: Cannot go from HTTPS to HTTP."));try{var r=Z();r.open("GET",e),r.timeout=t.timeout||$,r.withCredentials=t.withCredentials||!1,r.overrideMimeType&&r.overrideMimeType("text/xml"),r.onload=function(){return function(e,t){200===e.status?t(null,e.responseXML,{byteLength:e.response.length,statusCode:e.status}):J(e,t,!1)}(r,n)},r.onerror=function(){return J(r,n,!1)},r.onabort=function(){return J(r,n,!1)},r.ontimeout=function(){return J(r,n,!0)},r.send()}catch(e){n(new Error("XHRURLHandler: Unexpected error"))}},supported:function(){return!!Z()}},te={get:function(e,t,n){return n||("function"==typeof t&&(n=t),t={}),"undefined"==typeof window||null===window?K.get(e,t,n):ee.supported()?ee.get(e,t,n):n(new Error("Current context is not supported by any of the default URLHandlers. Please provide a custom URLHandler"))}},ne=0,re=0,ie=function(e,t){!e||!t||e<=0||t<=0||(re=(re*ne+8*e/t)/++ne)},oe={ERRORCODE:900,extensions:[]},ae=function(e){l(n,e);var t=p(n);function n(){var e;return i(this,n),(e=t.call(this)).remainingAds=[],e.parentURLs=[],e.errorURLTemplates=[],e.rootErrorURLTemplates=[],e.maxWrapperDepth=null,e.URLTemplateFilters=[],e.fetchingOptions={},e.parsingOptions={},e}return a(n,[{key:"addURLTemplateFilter",value:function(e){"function"==typeof e&&this.URLTemplateFilters.push(e)}},{key:"removeURLTemplateFilter",value:function(){this.URLTemplateFilters.pop()}},{key:"countURLTemplateFilters",value:function(){return this.URLTemplateFilters.length}},{key:"clearURLTemplateFilters",value:function(){this.URLTemplateFilters=[]}},{key:"trackVastError",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];this.emit("VAST-error",Object.assign.apply(Object,[{},oe,t].concat(r))),R.track(e,t)}},{key:"getErrorURLTemplates",value:function(){return this.rootErrorURLTemplates.concat(this.errorURLTemplates)}},{key:"getEstimatedBitrate",value:function(){return re}},{key:"fetchVAST",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new Promise((function(o,a){t.URLTemplateFilters.forEach((function(t){e=t(e)})),t.parentURLs.push(e);var s=Date.now();t.emit("VAST-resolving",{url:e,previousUrl:r,wrapperDepth:n,maxWrapperDepth:t.maxWrapperDepth,timeout:t.fetchingOptions.timeout,wrapperAd:i}),t.urlHandler.get(e,t.fetchingOptions,(function(i,l){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=Math.round(Date.now()-s),d=Object.assign({url:e,previousUrl:r,wrapperDepth:n,error:i,duration:u},c);t.emit("VAST-resolved",d),ie(c.byteLength,u),i?a(i):o(l)}))}))}},{key:"initParsingStatus",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.errorURLTemplates=[],this.fetchingOptions={timeout:e.timeout||$,withCredentials:e.withCredentials},this.maxWrapperDepth=e.wrapperLimit||10,this.parentURLs=[],this.parsingOptions={allowMultipleAds:e.allowMultipleAds},this.remainingAds=[],this.rootErrorURLTemplates=[],this.rootURL="",this.urlHandler=e.urlHandler||e.urlhandler||te,this.vastVersion=null,ie(e.byteLength,e.requestDuration)}},{key:"getRemainingAds",value:function(e){var t=this;if(0===this.remainingAds.length)return Promise.reject(new Error("No more ads are available for the given VAST"));var n=e?R.flatten(this.remainingAds):this.remainingAds.shift();return this.errorURLTemplates=[],this.parentURLs=[],this.resolveAds(n,{wrapperDepth:0,url:this.rootURL}).then((function(e){return t.buildVASTResponse(e)}))}},{key:"getAndParseVAST",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.initParsingStatus(n),this.URLTemplateFilters.forEach((function(t){e=t(e)})),this.rootURL=e,this.fetchVAST(e).then((function(r){return n.previousUrl=e,n.isRootVAST=!0,n.url=e,t.parse(r,n).then((function(e){return t.buildVASTResponse(e)}))}))}},{key:"parseVAST",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.initParsingStatus(n),n.isRootVAST=!0,this.parse(e,n).then((function(e){return t.buildVASTResponse(e)}))}},{key:"buildVASTResponse",value:function(e){var t,n={ads:(t={ads:e,errorURLTemplates:this.getErrorURLTemplates(),version:this.vastVersion}).ads||[],errorURLTemplates:t.errorURLTemplates||[],version:t.version||null};return this.completeWrapperResolving(n),n}},{key:"parseVastXml",value:function(e,t){var n=t.isRootVAST,r=void 0!==n&&n,i=t.url,o=void 0===i?null:i,a=t.wrapperDepth,s=void 0===a?0:a,l=t.allowMultipleAds,c=t.followAdditionalWrappers;if(!e||!e.documentElement||"VAST"!==e.documentElement.nodeName)throw this.emit("VAST-ad-parsed",{type:"ERROR",url:o,wrapperDepth:s}),new Error("Invalid VAST XMLDocument");var u=[],d=e.documentElement.childNodes,p=e.documentElement.getAttribute("version");for(var f in r&&p&&(this.vastVersion=p),d){var h=d[f];if("Error"===h.nodeName){var v=O.parseNodeText(h);r?this.rootErrorURLTemplates.push(v):this.errorURLTemplates.push(v)}else if("Ad"===h.nodeName){if(this.vastVersion&&parseFloat(this.vastVersion)<3)l=!0;else if(!1===l&&u.length>1)break;var y=W(h,this.emit.bind(this),{allowMultipleAds:l,followAdditionalWrappers:c});y.ad?(u.push(y.ad),this.emit("VAST-ad-parsed",{type:y.type,url:o,wrapperDepth:s,adIndex:u.length-1,vastVersion:p})):this.trackVastError(this.getErrorURLTemplates(),{ERRORCODE:101})}}return u}},{key:"parse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.url,r=void 0===n?null:n,i=t.resolveAll,o=void 0===i||i,a=t.wrapperSequence,s=void 0===a?null:a,l=t.previousUrl,c=void 0===l?null:l,u=t.wrapperDepth,d=void 0===u?0:u,p=t.isRootVAST,f=void 0!==p&&p,h=t.followAdditionalWrappers,v=t.allowMultipleAds,y=[];this.vastVersion&&parseFloat(this.vastVersion)<3&&f&&(v=!0);try{y=this.parseVastXml(e,{isRootVAST:f,url:r,wrapperDepth:d,allowMultipleAds:v,followAdditionalWrappers:h})}catch(e){return Promise.reject(e)}return 1===y.length&&null!=s&&(y[0].sequence=s),!1===o&&(this.remainingAds=O.splitVAST(y),y=this.remainingAds.shift()),this.resolveAds(y,{wrapperDepth:d,previousUrl:c,url:r})}},{key:"resolveAds",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0,r=n.wrapperDepth,i=n.previousUrl,o=n.url,a=[];return i=o,t.forEach((function(t){var n=e.resolveWrappers(t,r,i);a.push(n)})),Promise.all(a).then((function(t){var n=R.flatten(t);if(!n&&e.remainingAds.length>0){var a=e.remainingAds.shift();return e.resolveAds(a,{wrapperDepth:r,previousUrl:i,url:o})}return n}))}},{key:"resolveWrappers",value:function(e,t,n){var r=this;return new Promise((function(i){var o;if(t++,!e.nextWrapperURL)return delete e.nextWrapperURL,i(e);if(t>=r.maxWrapperDepth||-1!==r.parentURLs.indexOf(e.nextWrapperURL))return e.errorCode=302,delete e.nextWrapperURL,i(e);e.nextWrapperURL=O.resolveVastAdTagURI(e.nextWrapperURL,n),r.URLTemplateFilters.forEach((function(t){e.nextWrapperURL=t(e.nextWrapperURL)}));var a=null!==(o=r.parsingOptions.allowMultipleAds)&&void 0!==o?o:e.allowMultipleAds,s=e.sequence;r.fetchVAST(e.nextWrapperURL,t,n,e).then((function(o){return r.parse(o,{url:e.nextWrapperURL,previousUrl:n,wrapperSequence:s,wrapperDepth:t,followAdditionalWrappers:e.followAdditionalWrappers,allowMultipleAds:a}).then((function(t){if(delete e.nextWrapperURL,0===t.length)return e.creatives=[],i(e);t.forEach((function(t){t&&O.mergeWrapperAdData(t,e)})),i(t)}))})).catch((function(t){e.errorCode=301,e.errorMessage=t.message,i(e)}))}))}},{key:"completeWrapperResolving",value:function(e){if(0===e.ads.length)this.trackVastError(e.errorURLTemplates,{ERRORCODE:303});else for(var t=e.ads.length-1;t>=0;t--){var n=e.ads[t];(n.errorCode||0===n.creatives.length)&&(this.trackVastError(n.errorURLTemplates.concat(e.errorURLTemplates),{ERRORCODE:n.errorCode||303},{ERRORMESSAGE:n.errorMessage||""},{extensions:n.extensions},{system:n.system}),e.ads.splice(t,1))}}}]),n}(Y),se=null,le={data:{},length:0,getItem:function(e){return this.data[e]},setItem:function(e,t){this.data[e]=t,this.length=Object.keys(this.data).length},removeItem:function(e){delete this.data[e],this.length=Object.keys(this.data).length},clear:function(){this.data={},this.length=0}},ce=function(){function e(){i(this,e),this.storage=this.initStorage()}return a(e,[{key:"initStorage",value:function(){if(se)return se;try{se="undefined"!=typeof window&&null!==window?window.localStorage||window.sessionStorage:null}catch(e){se=null}return se&&!this.isStorageDisabled(se)||(se=le).clear(),se}},{key:"isStorageDisabled",value:function(e){var t="__VASTStorage__";try{if(e.setItem(t,t),e.getItem(t)!==t)return e.removeItem(t),!0}catch(e){return!0}return e.removeItem(t),!1}},{key:"getItem",value:function(e){return this.storage.getItem(e)}},{key:"setItem",value:function(e,t){return this.storage.setItem(e,t)}},{key:"removeItem",value:function(e){return this.storage.removeItem(e)}},{key:"clear",value:function(){return this.storage.clear()}}]),e}(),ue=function(){function e(t,n,r){i(this,e),this.cappingFreeLunch=t||0,this.cappingMinimumTimeInterval=n||0,this.defaultOptions={withCredentials:!1,timeout:0},this.vastParser=new ae,this.storage=r||new ce,void 0===this.lastSuccessfulAd&&(this.lastSuccessfulAd=0),void 0===this.totalCalls&&(this.totalCalls=0),void 0===this.totalCallsTimeout&&(this.totalCallsTimeout=0)}return a(e,[{key:"getParser",value:function(){return this.vastParser}},{key:"lastSuccessfulAd",get:function(){return this.storage.getItem("vast-client-last-successful-ad")},set:function(e){this.storage.setItem("vast-client-last-successful-ad",e)}},{key:"totalCalls",get:function(){return this.storage.getItem("vast-client-total-calls")},set:function(e){this.storage.setItem("vast-client-total-calls",e)}},{key:"totalCallsTimeout",get:function(){return this.storage.getItem("vast-client-total-calls-timeout")},set:function(e){this.storage.setItem("vast-client-total-calls-timeout",e)}},{key:"hasRemainingAds",value:function(){return this.vastParser.remainingAds.length>0}},{key:"getNextAds",value:function(e){return this.vastParser.getRemainingAds(e)}},{key:"get",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Date.now();return(n=Object.assign({},this.defaultOptions,n)).hasOwnProperty("resolveAll")||(n.resolveAll=!1),this.totalCallsTimeout<r?(this.totalCalls=1,this.totalCallsTimeout=r+36e5):this.totalCalls++,new Promise((function(i,o){if(t.cappingFreeLunch>=t.totalCalls)return o(new Error("VAST call canceled – FreeLunch capping not reached yet ".concat(t.totalCalls,"/").concat(t.cappingFreeLunch)));var a=r-t.lastSuccessfulAd;if(a<0)t.lastSuccessfulAd=0;else if(a<t.cappingMinimumTimeInterval)return o(new Error("VAST call canceled – (".concat(t.cappingMinimumTimeInterval,")ms minimum interval reached")));t.vastParser.getAndParseVAST(e,n).then((function(e){return i(e)})).catch((function(e){return o(e)}))}))}}]),e}(),de=function(e){l(o,e);var t=p(o);function o(e,n,r){var a,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;for(var l in i(this,o),(a=t.call(this)).ad=n,a.creative=r,a.variation=s,a.muted=!1,a.impressed=!1,a.skippable=!1,a.trackingEvents={},a.lastPercentage=0,a._alreadyTriggeredQuartiles={},a.emitAlwaysEvents=["creativeView","start","firstQuartile","midpoint","thirdQuartile","complete","resume","pause","rewind","skip","closeLinear","close"],a.creative.trackingEvents){var c=a.creative.trackingEvents[l];a.trackingEvents[l]=c.slice(0)}return P(a.creative)?a._initLinearTracking():a._initVariationTracking(),e&&a.on("start",(function(){e.lastSuccessfulAd=Date.now()})),a}return a(o,[{key:"_initLinearTracking",value:function(){this.linear=!0,this.skipDelay=this.creative.skipDelay,this.setDuration(this.creative.duration),this.clickThroughURLTemplate=this.creative.videoClickThroughURLTemplate,this.clickTrackingURLTemplates=this.creative.videoClickTrackingURLTemplates}},{key:"_initVariationTracking",value:function(){if(this.linear=!1,this.skipDelay=-1,this.variation){for(var e in this.variation.trackingEvents){var t=this.variation.trackingEvents[e];this.trackingEvents[e]?this.trackingEvents[e]=this.trackingEvents[e].concat(t.slice(0)):this.trackingEvents[e]=t.slice(0)}"nonLinearAd"===this.variation.adType?(this.clickThroughURLTemplate=this.variation.nonlinearClickThroughURLTemplate,this.clickTrackingURLTemplates=this.variation.nonlinearClickTrackingURLTemplates,this.setDuration(this.variation.minSuggestedDuration)):function(e){return"companionAd"===e.adType}(this.variation)&&(this.clickThroughURLTemplate=this.variation.companionClickThroughURLTemplate,this.clickTrackingURLTemplates=this.variation.companionClickTrackingURLTemplates)}}},{key:"setDuration",value:function(e){R.isValidTimeValue(e)&&(this.assetDuration=e,this.quartiles={firstQuartile:Math.round(25*this.assetDuration)/100,midpoint:Math.round(50*this.assetDuration)/100,thirdQuartile:Math.round(75*this.assetDuration)/100})}},{key:"setProgress",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(R.isValidTimeValue(e)&&"object"===r(n)){var i=this.skipDelay||-1;if(-1===i||this.skippable||(i>e?this.emit("skip-countdown",i-e):(this.skippable=!0,this.emit("skip-countdown",0))),this.assetDuration>0){var o=Math.round(e/this.assetDuration*100),a=[];if(e>0){a.push("start");for(var s=this.lastPercentage;s<o;s++)a.push("progress-".concat(s+1,"%"));for(var l in a.push("progress-".concat(Math.round(e))),this.quartiles)this.isQuartileReached(l,this.quartiles[l],e)&&(a.push(l),this._alreadyTriggeredQuartiles[l]=!0);this.lastPercentage=o}a.forEach((function(e){t.track(e,{macros:n,once:!0})})),e<this.progress&&this.track("rewind",{macros:n})}this.progress=e}}},{key:"isQuartileReached",value:function(e,t,n){var r=!1;return t<=n&&!this._alreadyTriggeredQuartiles[e]&&(r=!0),r}},{key:"setMuted",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"boolean"==typeof e&&"object"===r(t)&&(this.muted!==e&&this.track(e?"mute":"unmute",{macros:t}),this.muted=e)}},{key:"setPaused",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"boolean"==typeof e&&"object"===r(t)&&(this.paused!==e&&this.track(e?"pause":"resume",{macros:t}),this.paused=e)}},{key:"setFullscreen",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"boolean"==typeof e&&"object"===r(t)&&(this.fullscreen!==e&&this.track(e?"fullscreen":"exitFullscreen",{macros:t}),this.fullscreen=e)}},{key:"setExpand",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"boolean"==typeof e&&"object"===r(t)&&(this.expanded!==e&&(this.track(e?"expand":"collapse",{macros:t}),this.track(e?"playerExpand":"playerCollapse",{macros:t})),this.expanded=e)}},{key:"setSkipDelay",value:function(e){R.isValidTimeValue(e)&&(this.skipDelay=e)}},{key:"trackImpression",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===r(e)&&(this.impressed||(this.impressed=!0,this.trackURLs(this.ad.impressionURLTemplates,e),this.track("creativeView",{macros:e})))}},{key:"error",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"object"===r(e)&&"boolean"==typeof t&&this.trackURLs(this.ad.errorURLTemplates,e,{isCustomCode:t})}},{key:"errorWithCode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"string"==typeof e&&"boolean"==typeof t&&(this.error({ERRORCODE:e},t),console.log("The method errorWithCode is deprecated, please use vast tracker error method instead"))}},{key:"complete",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===r(e)&&this.track("complete",{macros:e})}},{key:"notUsed",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===r(e)&&(this.track("notUsed",{macros:e}),this.trackingEvents=[])}},{key:"otherAdInteraction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===r(e)&&this.track("otherAdInteraction",{macros:e})}},{key:"acceptInvitation",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===r(e)&&this.track("acceptInvitation",{macros:e})}},{key:"adExpand",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===r(e)&&this.track("adExpand",{macros:e})}},{key:"adCollapse",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===r(e)&&this.track("adCollapse",{macros:e})}},{key:"minimize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===r(e)&&this.track("minimize",{macros:e})}},{key:"verificationNotExecuted",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"==typeof e&&"object"===r(t)){if(!this.ad||!this.ad.adVerifications||!this.ad.adVerifications.length)throw new Error("No adVerifications provided");if(!e)throw new Error("No vendor provided, unable to find associated verificationNotExecuted");var n=this.ad.adVerifications.find((function(t){return t.vendor===e}));if(!n)throw new Error("No associated verification element found for vendor: ".concat(e));var i=n.trackingEvents;if(i&&i.verificationNotExecuted){var o=i.verificationNotExecuted;this.trackURLs(o,t),this.emit("verificationNotExecuted",{trackingURLTemplates:o})}}}},{key:"overlayViewDuration",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"string"==typeof e&&"object"===r(t)&&(t.ADPLAYHEAD=e,this.track("overlayViewDuration",{macros:t}))}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===r(e)&&this.track(this.linear?"closeLinear":"close",{macros:e})}},{key:"skip",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===r(e)&&this.track("skip",{macros:e})}},{key:"load",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===r(e)&&this.track("loaded",{macros:e})}},{key:"click",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((null===e||"string"==typeof e)&&"object"===r(t)){this.clickTrackingURLTemplates&&this.clickTrackingURLTemplates.length&&this.trackURLs(this.clickTrackingURLTemplates,t);var i=this.clickThroughURLTemplate||e,o=n({},t);if(i){this.progress&&(o.ADPLAYHEAD=this.progressFormatted());var a=R.resolveURLTemplates([i],o)[0];this.emit("clickthrough",a)}}}},{key:"track",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.macros,i=void 0===n?{}:n,o=t.once,a=void 0!==o&&o;if("object"===r(i)){"closeLinear"===e&&!this.trackingEvents[e]&&this.trackingEvents.close&&(e="close");var s=this.trackingEvents[e],l=this.emitAlwaysEvents.indexOf(e)>-1;s?(this.emit(e,{trackingURLTemplates:s}),this.trackURLs(s,i)):l&&this.emit(e,null),a&&(delete this.trackingEvents[e],l&&this.emitAlwaysEvents.splice(this.emitAlwaysEvents.indexOf(e),1))}}},{key:"trackURLs",value:function(e){var t,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=n({},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});this.linear&&(this.creative&&this.creative.mediaFiles&&this.creative.mediaFiles[0]&&this.creative.mediaFiles[0].fileURL&&(o.ASSETURI=this.creative.mediaFiles[0].fileURL),this.progress&&(o.ADPLAYHEAD=this.progressFormatted())),null!==(t=this.creative)&&void 0!==t&&null!==(r=t.universalAdIds)&&void 0!==r&&r.length&&(o.UNIVERSALADID=this.creative.universalAdIds.map((function(e){return e.idRegistry.concat(" ",e.value)})).join(",")),this.ad&&(this.ad.sequence&&(o.PODSEQUENCE=this.ad.sequence),this.ad.adType&&(o.ADTYPE=this.ad.adType),this.ad.adServingId&&(o.ADSERVINGID=this.ad.adServingId),this.ad.categories&&this.ad.categories.length&&(o.ADCATEGORIES=this.ad.categories.map((function(e){return e.value})).join(",")),this.ad.blockedAdCategories&&this.ad.blockedAdCategories.length&&(o.BLOCKEDADCATEGORIES=this.ad.blockedAdCategories)),R.track(e,o,i)}},{key:"convertToTimecode",value:function(e){if(!R.isValidTimeValue(e))return"";var t=1e3*e,n=Math.floor(t/36e5),r=Math.floor(t/6e4%60),i=Math.floor(t/1e3%60),o=Math.floor(t%1e3);return"".concat(R.addLeadingZeros(n,2),":").concat(R.addLeadingZeros(r,2),":").concat(R.addLeadingZeros(i,2),".").concat(R.addLeadingZeros(o,3))}},{key:"progressFormatted",value:function(){return this.convertToTimecode(this.progress)}}]),o}(Y);e.VASTClient=ue,e.VASTParser=ae,e.VASTTracker=de,Object.defineProperty(e,"__esModule",{value:!0})}(t)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};(()=>{"use strict";n.r(r),n.d(r,{FORMAT:()=>R,VPAID_EVENTS:()=>P,init:()=>dn,version:()=>g});var e=n(495);function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function i(e,n,r){return(n=function(e){var n=function(e,n){if("object"!==t(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,n||"default");if("object"!==t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"===t(n)?n:String(n)}(n))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function o(e){var t=null,n=[];return window.location.search.substring(1).split("&").forEach((function(r){(n=r.split("="))[0].toLowerCase()===e.toLowerCase()&&(t=decodeURIComponent(n[1]))})),t}function a(e){var t=e.getBoundingClientRect(),n=getComputedStyle(e),r=parseInt(n.paddingTop,10)+parseInt(n.paddingBottom,10),i=parseInt(n.paddingLeft,10)+parseInt(n.paddingRight,10);return{width:Math.floor(t.width)-i,height:Math.floor(t.height)-r}}var s=-1;function l(e){var t=function t(){window.clearTimeout(s),s=window.setTimeout((function(){e(),window.removeEventListener("scroll",t)}),500)};s=window.setTimeout((function(){e(),window.removeEventListener("scroll",t)}),1e3),window.addEventListener("scroll",t)}function c(e){var t=null,n=window.innerHeight;return e.forEach((function(e){var r=Math.abs(e.getBoundingClientRect().bottom-window.innerHeight/2);r<n&&(n=r,t=e)})),t}function u(e,t,n){try{t(e),!n(e)&&e.parentElement&&u(e.parentElement,t,n)}catch(e){}}function d(e,t,n){try{t(e),e!==n&&e.parentElement&&1===e.parentElement.childElementCount&&d(e.parentElement,t,n)}catch(e){}}function p(e){var t=window;try{for(e(t);t.parent!==t&&t.parent.document.location.href.toString();)e(t=t.parent)}catch(e){}}function f(){var e=window;return p((function(t){e=t})),e}var h=function(){try{return window.self!==window.top}catch(e){return!0}};function v(e){var n,r;if(h())if(function(){try{return h()&&"string"!=typeof window.top.document.location.href.toString()}catch(e){return!0}}()){var o=(p((function(e){var t;r||(r=e.sfAPI||(null===(t=e.$sf)||void 0===t?void 0:t.ext))})),r);if(o){switch(e){case"cmp":o.cmp&&(n=function(e,t,n){o.register(300,250,(function(e,t){"cmpReturn"===e&&n(t,t.success)})),o.cmp(e)});break;case"uspapi":n=window.__uspapi;break;case"tcfapi":n=window.__tcfapi}if(n)return n}p((function(r){var o,a=r;try{o=(a=a.parent).frames["__".concat(e,"Locator")]}catch(e){}if(!n&&o){var s=a;n=function(n,r,o){var a="".concat(Math.random()),l=i({},"__".concat(e,"Call"),{command:n,parameter:r,callId:a});s.postMessage(l,"*"),window.addEventListener("message",(function(n){var r;try{r="string"==typeof n.data?JSON.parse(n.data):n.data}catch(e){}if("object"===t(r)){var i=r["__".concat(e,"Return")];i&&a===i.callId&&o(i.returnValue,i.success)}}))}}}))}else p((function(t){n=n||t["__".concat(e)]}));else n=window["__".concat(e)];return n}function y(e,t){var n=v("tcfapi"),r=v("cmp"),i=v("uspapi"),o={};if(n||r||i||t)if(n||r||i){var a=!1,s=!1,l=!1,c=!1,u=function(){!c&&(n&&a||!n)&&(r&&s||!r)&&(i&&l||!i)&&(c=!0,e(o))};setTimeout((function(){s=!0,l=!0,a=!0,u()}),500),n&&(o.gdpr=!0,o.gdpr_consent=!1,n("getTCData",2,(function(e){e&&(o.gdpr="boolean"==typeof e.gdprApplies?e.gdprApplies:null,o.gdpr_consent_string=e.tcString,delete o.gdpr_consent,a=!0,u())}))),r&&(o.gdpr=!0,o.gdpr_consent=!1,r("getConsentData",null,(function(e){var t=e;t&&(t=t.VendorConsentData||t,o.gdpr="boolean"==typeof t.gdprApplies?t.gdprApplies:null,o.gdpr_consent_string=t.consentData,delete o.gdpr_consent,s=!0,u())}))),i&&i("getUSPData",null,(function(e,t){var n=e;t&&n&&(n=n.VendorConsentData||n,o.usp_consent_string=n.uspString),l=!0,u()}))}else e(o);else setTimeout((function(){y(e,!0)}),500)}var m,g="v1.0B-1-g76f2ad1",b="prod";switch(b){case"preprod":m="https://preprod.retailspot.com/static/";break;case"prod":m="https://retailspot.com/static/";break;default:m="http://localhost:3000/dist/"}var A=m,w={WARN:"warn",ERROR:"error",DEFAULT:"log"};function k(){for(var e,t=w.DEFAULT,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];if([w.WARN,w.ERROR,w.DEFAULT].includes(r[0])&&(t=r.shift()),t!==w.DEFAULT||"true"===o("rsp_debug")){var a="padding:2px 6px;border-radius:8px;background-color:#1a2691;color:white";(e=console)[t].apply(e,["%cRetailSpot",a,r.shift()].concat(r))}}k("env : ".concat(b)),k("Script version: ".concat(g));var T="video",E="native",R={AUTO:"auto",AUTO_NO_SLIDER:"autoNoSlider",SLIDER:"slider",INTEXT:"intext",INGRID:"ingrid"},S={closeButton:!0,soundButton:!0,height:225,width:400},O={closeButton:!1,soundButton:!1,height:null,width:null},C={closeButton:!1,soundButton:!0,height:null,width:null},P={AdStarted:"AdStarted",AdStopped:"AdStopped",AdSkipped:"AdSkipped",AdLoaded:"AdLoaded",AdLinearChange:"AdLinearChange",AdSizeChange:"AdSizeChange",AdExpandedChange:"AdExpandedChange",AdSkippableStateChange:"AdSkippableStateChange",AdDurationChange:"AdDurationChange",AdRemainingTimeChange:"AdRemainingTimeChange",AdVolumeChange:"AdVolumeChange",AdImpression:"AdImpression",AdClickThru:"AdClickThru",AdInteraction:"AdInteraction",AdVideoStart:"AdVideoStart",AdVideoFirstQuartile:"AdVideoFirstQuartile",AdVideoMidpoint:"AdVideoMidpoint",AdVideoThirdQuartile:"AdVideoThirdQuartile",AdVideoComplete:"AdVideoComplete",AdUserAcceptInvitation:"AdUserAcceptInvitation",AdUserMinimize:"AdUserMinimize",AdUserClose:"AdUserClose",AdPaused:"AdPaused",AdPlaying:"AdPlaying",AdError:"AdError",AdLog:"AdLog",AdProgress:"AdProgress"};function L(e){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},L(e)}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,o=void 0,o=function(e,t){if("object"!==L(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==L(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===L(o)?o:String(o)),r)}var i,o}var I=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.video=t,this.adContainer=n,this.elapsed=0,this.duration=-1,this.hasCompletedOnce=!1,this.listeners={},this.sentEvents=[]}var t,n,r;return t=e,n=[{key:"handshakeVersion",value:function(){return"2.0"}},{key:"initAd",value:function(){throw new Error("initAd not implemented")}},{key:"startAd",value:function(){this.video.style.display="",this.adContainer.style.display=""}},{key:"stopAd",value:function(){throw new Error("stopAd not implemented")}},{key:"skipAd",value:function(){throw new Error("skipAd not implemented")}},{key:"pauseAd",value:function(){throw new Error("pauseAd not implemented")}},{key:"resumeAd",value:function(){throw new Error("resumeAd not implemented")}},{key:"getRemainingTime",value:function(){return this.duration-this.elapsed}},{key:"mute",value:function(e){throw new Error("mute not implemented")}},{key:"expandAd",value:function(){throw new Error("expandAd not implemented")}},{key:"collapseAd",value:function(){throw new Error("collapseAd not implemented")}},{key:"getAdVolume",value:function(){throw new Error("getAdVolume not implemented")}},{key:"getAdDuration",value:function(){throw new Error("getAdDuration not implemented")}},{key:"getAdRemainingTime",value:function(){throw new Error("getAdRemainingTime not implemented")}},{key:"getAdElapsedTime",value:function(){return this.getAdDuration()-this.getAdRemainingTime()}},{key:"getAdProgress",value:function(){return Math.round(100*(this.getAdElapsedTime()/this.getAdDuration()+Number.EPSILON))}},{key:"resizeAd",value:function(){}},{key:"subscribe",value:function(e,t){if(this.listeners[t]||(this.listeners[t]=[]),"function"!=typeof e)throw new Error("Callback is not a function for event: ".concat(t));this.listeners[t].push(e)}},{key:"unsubscribe",value:function(e,t){if(this.listeners[t]){var n=this.listeners[t].indexOf(e);-1!==n&&this.listeners[t].splice(n,1)}}},{key:"triggerEvent",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n.shift();null===(e=this.listeners[i])||void 0===e||e.forEach((function(e){e.apply(void 0,n)})),this.sentEvents.push(i)}},{key:"triggerOnce",value:function(){var e=arguments.length<=0?void 0:arguments[0];this.sentEvents.includes(e)||this.triggerEvent.apply(this,arguments)}}],n&&x(t.prototype,n),r&&x(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function N(e){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N(e)}function j(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,o=void 0,o=function(e,t){if("object"!==N(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==N(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===N(o)?o:String(o)),r)}var i,o}function U(e,t){return U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},U(e,t)}function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=B(e);if(t){var i=B(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _(this,n)}}function _(e,t){if(t&&("object"===N(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function B(e){return B=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},B(e)}var M=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&U(e,t)}(o,e);var t,n,r,i=V(o);function o(){var e;j(this,o);for(var t=null,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return r[0]&&o.checkVPAIDInterface(r[0])&&(t=r.shift()),(e=i.call.apply(i,[this].concat(r))).id="VPAIDWrapper",t&&e.setVPAIDCreative(t),e}return t=o,n=[{key:"setVPAIDCreative",value:function(e){this.creative=e,o.checkVPAIDInterface(e)?this.setCallbacksForCreative():k(w.ERROR,"VPAIDCreative doesn't conform to the VPAID spec")}},{key:"setCallbacksForCreative",value:function(){var e=this,t={AdStarted:this.onAdStarted,AdStopped:this.onAdStopped,AdSkipped:this.onAdSkipped,AdLoaded:this.onAdLoaded,AdLinearChange:this.onAdLinearChange,AdSizeChange:this.onAdSizeChange,AdExpandedChange:this.onAdExpandedChange,AdSkippableStateChange:this.onAdSkippableStateChange,AdDurationChange:this.onAdDurationChange,AdRemainingTimeChange:this.onAdRemainingTimeChange,AdVolumeChange:this.onAdVolumeChange,AdImpression:this.onAdImpression,AdClickThru:this.onAdClickThru,AdInteraction:this.onAdInteraction,AdVideoStart:this.onAdVideoStart,AdVideoFirstQuartile:this.onAdVideoFirstQuartile,AdVideoMidpoint:this.onAdVideoMidpoint,AdVideoThirdQuartile:this.onAdVideoThirdQuartile,AdVideoComplete:this.onAdVideoComplete,AdUserAcceptInvitation:this.onAdUserAcceptInvitation,AdUserMinimize:this.onAdUserMinimize,AdUserClose:this.onAdUserClose,AdPaused:this.onAdPaused,AdPlaying:this.onAdPlaying,AdError:this.onAdError,AdLog:this.onAdLog,AdProgress:this.onAdProgress};Object.keys(t).forEach((function(n){e.creative.subscribe(t[n].bind(e),n,e)}))}},{key:"initAd",value:function(e,t,n,r,i,o){this.creative.initAd(e,t,n,r,i,o)}},{key:"getInnerCreative",value:function(){var e;return"function"==typeof(null===(e=this.creative)||void 0===e?void 0:e.getInnerCreative)?this.creative.getInnerCreative():this}},{key:"onAdPaused",value:function(){this.log("onAdPaused"),this.triggerEvent(P.AdPaused)}},{key:"onAdPlaying",value:function(){this.log("onAdPlaying"),this.triggerEvent(P.AdPlaying)}},{key:"onAdError",value:function(e){k("onAdError: ".concat(e)),this.triggerEvent(P.AdError,e)}},{key:"onAdLog",value:function(e){this.log("onAdLog: ".concat(e)),this.triggerEvent(P.AdLog,e)}},{key:"onAdProgress",value:function(e){this.log("onAdProgress: ".concat(e)),this.triggerEvent(P.AdProgress,e)}},{key:"onAdUserAcceptInvitation",value:function(){this.log("onAdUserAcceptInvitation"),this.triggerEvent(P.AdUserAcceptInvitation)}},{key:"onAdUserMinimize",value:function(){this.log("onAdUserMinimize"),this.triggerEvent(P.AdUserMinimize)}},{key:"onAdUserClose",value:function(){this.log("onAdUserClose"),this.triggerEvent(P.AdUserClose)}},{key:"onAdSkippableStateChange",value:function(){this.log("Ad Skippable State Changed to: ".concat(this.creative.getAdSkippableState())),this.triggerEvent(P.AdSkippableStateChange)}},{key:"onAdExpandedChange",value:function(){this.log("Ad Expanded Changed to: ".concat(this.creative.getAdExpanded())),this.triggerEvent(P.AdExpandedChange)}},{key:"getAdExpanded",value:function(){return this.log("getAdExpanded"),this.creative.getAdExpanded()}},{key:"getAdSkippableState",value:function(){return this.log("getAdSkippableState"),this.creative.getAdSkippableState()}},{key:"onAdSizeChange",value:function(){this.log("Ad size changed to: w=".concat(this.creative.getAdWidth()," h =").concat(this.creative.getAdHeight()));for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.triggerEvent.apply(this,[P.AdSizeChange].concat(t))}},{key:"onAdDurationChange",value:function(){this.log("Ad Duration Changed to: ".concat(this.creative.getAdDuration())),this.duration=this.getAdDuration();for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.triggerEvent.apply(this,[P.AdDurationChange].concat(t))}},{key:"onAdRemainingTimeChange",value:function(){k("Ad Remaining Time Changed to: ".concat(this.creative.getAdRemainingTime()));for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.triggerEvent.apply(this,[P.AdRemainingTimeChange].concat(t))}},{key:"getAdRemainingTime",value:function(){return this.creative.getAdRemainingTime()}},{key:"getAdDuration",value:function(){return this.creative.getAdDuration()}},{key:"onAdImpression",value:function(){this.log("Ad Impression"),this.triggerEvent(P.AdImpression)}},{key:"onAdClickThru",value:function(e,t,n){this.log("Clickthrough portion of the ad was clicked"),this.triggerEvent(P.AdClickThru)}},{key:"onAdInteraction",value:function(e){this.log("A non-clickthrough event has occured"),this.triggerEvent(P.AdInteraction)}},{key:"onAdVideoStart",value:function(){this.log("Video 0% completed"),this.triggerEvent(P.AdVideoStart)}},{key:"onAdVideoFirstQuartile",value:function(){this.log("Video 25% completed"),this.triggerEvent(P.AdVideoFirstQuartile)}},{key:"onAdVideoMidpoint",value:function(){this.log("Video 50% completed"),this.triggerEvent(P.AdVideoMidpoint)}},{key:"onAdVideoThirdQuartile",value:function(){this.log("Video 75% completed"),this.triggerEvent(P.AdVideoThirdQuartile)}},{key:"onAdVideoComplete",value:function(){this.log("Video 100% completed"),this.triggerEvent(P.AdVideoComplete)}},{key:"onAdLinearChange",value:function(){this.log("Ad linear has changed: ".concat(this.creative.getAdLinear()));for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.triggerEvent.apply(this,[P.AdLinearChange].concat(t))}},{key:"getAdLinear",value:function(){return this.log("getAdLinear"),this.creative.getAdLinear()}},{key:"startAd",value:function(){this.log("startAd"),this.creative.startAd()}},{key:"onAdLoaded",value:function(){this.log("Ad has been loaded"),this.triggerEvent(P.AdLoaded)}},{key:"onAdStarted",value:function(){this.log("Ad has started"),this.triggerEvent(P.AdStarted)}},{key:"stopAd",value:function(){this.creative.stopAd()}},{key:"onAdStopped",value:function(){this.log("Ad has stopped"),this.triggerEvent(P.AdStopped)}},{key:"onAdSkipped",value:function(){this.log("Ad was skipped"),this.triggerEvent(P.AdSkipped)}},{key:"setAdVolume",value:function(e){this.creative.setAdVolume(e)}},{key:"getAdVolume",value:function(){return this.creative.getAdVolume()}},{key:"onAdVolumeChange",value:function(){this.log("Ad Volume has changed to - ".concat(this.creative.getAdVolume()));for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.triggerEvent.apply(this,[P.AdVolumeChange].concat(t))}},{key:"resizeAd",value:function(e,t,n){this.creative.resizeAd(e,t,n)}},{key:"pauseAd",value:function(){this.creative.pauseAd()}},{key:"resumeAd",value:function(){this.creative.resumeAd()}},{key:"expandAd",value:function(){this.creative.expandAd()}},{key:"collapseAd",value:function(){this.creative.collapseAd()}},{key:"log",value:function(e){k("[".concat(this.id.substring(0,11),"] \t- ").concat(e))}}],r=[{key:"checkVPAIDInterface",value:function(e){return!!(e.handshakeVersion&&"function"==typeof e.handshakeVersion&&e.initAd&&"function"==typeof e.initAd&&e.startAd&&"function"==typeof e.startAd&&e.stopAd&&"function"==typeof e.stopAd&&e.skipAd&&"function"==typeof e.skipAd&&e.resizeAd&&"function"==typeof e.resizeAd&&e.pauseAd&&"function"==typeof e.pauseAd&&e.resumeAd&&"function"==typeof e.resumeAd&&e.expandAd&&"function"==typeof e.expandAd&&e.collapseAd&&"function"==typeof e.collapseAd&&e.subscribe&&"function"==typeof e.subscribe&&e.unsubscribe&&"function"==typeof e.unsubscribe)}}],n&&D(t.prototype,n),r&&D(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(I);function F(e){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F(e)}function W(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,o=void 0,o=function(e,t){if("object"!==F(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==F(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===F(o)?o:String(o)),r)}var i,o}function H(){return H="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=q(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},H.apply(this,arguments)}function q(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=X(e)););return e}function z(e,t){return z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},z(e,t)}function Q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=X(e);if(t){var i=X(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return G(this,n)}}function G(e,t){if(t&&("object"===F(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function X(e){return X=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},X(e)}var Y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&z(e,t)}(o,e);var t,n,r,i=Q(o);function o(e,t,n,r){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(a=i.call(this,e,t)).id="VPAIDPlayer",a.adParameters=r,a.mediaFile=n,a.iframe=null,a.adLoaded=!1,a.adPlaying=!1,a.startOnReady=!1,a.hasCompletedOnce=!1,a.eventCallbacks={},a}return t=o,(n=[{key:"initAd",value:function(){var e=this;this.iframe=document.createElement("iframe"),this.iframe.src="about:blank",this.iframe.style.width="100%",this.iframe.style.height="100%",this.iframe.style.display="block",this.iframe.style.opacity="0",this.iframe.style.border="none";var t=document.createElement("script");t.src=this.mediaFile.fileURL,this.iframe.addEventListener("load",(function(){var n=e.iframe.contentWindow.document.body;n.style.margin="0px",n.appendChild(t)})),t.addEventListener("load",(function(){var t=e.iframe.contentWindow.document.body,n=e.adContainer.parentElement.getBoundingClientRect();e.setVPAIDCreative(e.iframe.contentWindow.getVPAIDAd()),H(X(o.prototype),"initAd",e).call(e,n.width,n.height,"normal",e.mediaFile.bitrate,{AdParameters:e.adParameters},{slot:t,videoSlot:e.video,videoSlotCanAutoPlay:!0}),e.mute(!0)})),this.adContainer.append(this.iframe)}},{key:"startAd",value:function(){this.adLoaded?(H(X(o.prototype),"startAd",this).call(this),this.iframe.style.opacity="1",this.creative.startAd()):(this.startOnReady=!0,this.hasCompletedOnce&&this.initAd())}},{key:"stopAd",value:function(){H(X(o.prototype),"stopAd",this).call(this),this.startOnReady=!1,this.adLoaded=!1,this.iframe.style.opacity="0",this.iframe.remove()}},{key:"resumeAd",value:function(){this.creative&&!this.adPlaying&&this.creative.resumeAd()}},{key:"pauseAd",value:function(){this.creative&&this.adPlaying&&this.creative.pauseAd()}},{key:"onAdLoaded",value:function(){H(X(o.prototype),"onAdLoaded",this).call(this),this.adLoaded=!0,this.startOnReady&&this.startAd()}},{key:"onAdPlaying",value:function(){H(X(o.prototype),"onAdPlaying",this).call(this),this.adPlaying=!0}},{key:"onAdPaused",value:function(){H(X(o.prototype),"onAdPaused",this).call(this),this.adPlaying=!1}},{key:"onAdStopped",value:function(){H(X(o.prototype),"onAdStopped",this).call(this),this.adPlaying=!1,this.hasCompletedOnce||(this.hasCompletedOnce=!0)}},{key:"onAdError",value:function(){H(X(o.prototype),"onAdError",this).call(this),this.adPlaying=!1}},{key:"getRemainingTime",value:function(){return this.creative.getAdRemainingTime()}},{key:"getAdDuration",value:function(){return this.creative.getAdDuration()}},{key:"mute",value:function(e){return this.creative.setAdVolume(e?0:100),0===this.creative.getAdVolume()}},{key:"resize",value:function(){var e=this.adContainer.parentElement.getBoundingClientRect();this.creative.resizeAd(e.width,e.height,"normal")}}])&&W(t.prototype,n),r&&W(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(M);function K(e){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},K(e)}function $(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,o=void 0,o=function(e,t){if("object"!==K(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==K(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===K(o)?o:String(o)),r)}var i,o}function Z(e,t){return Z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Z(e,t)}function J(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=te(e);if(t){var i=te(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ee(this,n)}}function ee(e,t){if(t&&("object"===K(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function te(e){return te=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},te(e)}var ne=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Z(e,t)}(o,e);var t,n,r,i=J(o);function o(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(r=i.call(this,e,t)).id="VideoPlayer",r.mediaFiles=n,r.timers=[],r.lastProgress=0,r.started=!1,r}return t=o,(n=[{key:"initAd",value:function(){var e=this;this.mediaFiles.forEach((function(t){var n=document.createElement("source");n.src=t.fileURL,n.type=t.mimeType,e.video.appendChild(n)})),this.mute(!0),this.addListeners()}},{key:"startAd",value:function(){this.video.isConnected&&this.triggerOnce(P.AdImpression),this.video.play()}},{key:"stopAd",value:function(){this.started=!1,this.video.pause(),this.triggerEvent(P.AdStopped)}},{key:"resumeAd",value:function(){this.video.play()}},{key:"pauseAd",value:function(){this.video.pause()}},{key:"addListeners",value:function(){var e=this;this.video.addEventListener("loadeddata",(function(){})),this.video.addEventListener("durationchange",(function(t){e.duration=t.target.duration,e.triggerEvent(P.AdDurationChange)})),this.video.addEventListener("canplay",(function(){e.triggerEvent(P.AdLoaded),e.video.isConnected&&e.triggerOnce(P.AdImpression)})),this.video.addEventListener("play",(function(){e.started||(e.started=!0,e.triggerEvent(P.AdStarted)),e.triggerEvent(P.AdPlaying)})),this.video.addEventListener("pause",(function(){e.started&&e.triggerEvent(P.AdPaused)})),this.video.addEventListener("ended",(function(){e.triggerEvent(P.AdVideoComplete),e.triggerEvent(P.AdStopped)})),this.video.addEventListener("timeupdate",(function(t){var n=Math.round(e.getAdElapsedTime());n>e.lastProgress&&(e.lastProgress=n,e.triggerEvent(P.AdProgress,n))})),this.video.addEventListener("volumechange",(function(t){e.triggerEvent(P.AdVolumeChange,t.target.volume)})),this.video.addEventListener("error",(function(){e.triggerEvent(P.AdError,"405")}))}},{key:"getAdRemainingTime",value:function(){return this.video.duration-this.video.currentTime}},{key:"getAdDuration",value:function(){return this.video.duration}},{key:"getAdVolume",value:function(){return this.video.volume}},{key:"setAdVolume",value:function(e){this.video.volume=e}},{key:"mute",value:function(e){return this.video.volume=e?0:1,0===this.video.volume}}])&&$(t.prototype,n),r&&$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(I);function re(e){return re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},re(e)}function ie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,o=void 0,o=function(e,t){if("object"!==re(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==re(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===re(o)?o:String(o)),r)}var i,o}function ae(e,t,n){return t&&oe(e.prototype,t),n&&oe(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var se="viewable",le="not_viewable",ce="mrc_video_viewable",ue=function(){function e(t){ie(this,e),this.callback=t,this.mrc_sent=!1,this.mrc_timeout=-1}return ae(e,[{key:"onViewabilityChange",value:function(e,t){var n=this;this.callback(e?se:le),this.mrc_sent||(e?-1===this.mrc_timeout&&(this.mrc_timeout=window.setTimeout((function(){n.callback(ce,t),n.mrc_sent=!0}),2e3)):this.mrc_timeout>-1&&(window.clearTimeout(this.mrc_timeout),this.mrc_timeout=-1))}}]),e}(),de=new(function(){function e(t){var n=this;ie(this,e),this.registeredElement={},this.observer=new IntersectionObserver((function(e,t){e.forEach((function(e){var t;null===(t=n.registeredElement[e.target.id])||void 0===t||t.onViewabilityChange(e.isIntersecting)}))}),{threshold:.5})}return ae(e,[{key:"addListener",value:function(e,t){e.id?(this.registeredElement[e.id]=new ue(t),this.observer.observe(e)):k(w.WARN,"Cannot register viewability without element id.")}}]),e}());function pe(e,t){var n=document.createElement("img");n.setAttribute("style","position:absolute; width:1px; opacity: 0; height:1px; display:block;");var r=n;r.onload=function(){r.parentNode&&"img"===r.tagName&&r.parentNode.removeChild(r),t&&t()},n.src=e}function fe(e){return fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fe(e)}function he(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,o=void 0,o=function(e,t){if("object"!==fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==fe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===fe(o)?o:String(o)),r)}var i,o}var ye=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;he(this,e),Object.assign(this,t),this.start=0,n&&this.update(n)}var t,n,r;return t=e,(n=[{key:"update",value:function(e){this.clearTimeouts(),this.endRemaining=e,this.firstRemaining=e/4,this.midRemaining=e/2,this.thirdRemaining=e/4*3}},{key:"clearTimeouts",value:function(){window.clearTimeout(this.endTimerId),window.clearTimeout(this.firstTimerId),window.clearTimeout(this.midTimerId),window.clearTimeout(this.thirdTimerId),this.endTimerId=0,this.firstTimerId=0,this.midTimerId=0,this.thirdTimerId=0}},{key:"pause",value:function(){this.clearTimeouts();var e=Date.now()-this.start;this.firstRemaining-=e,this.midRemaining-=e,this.thirdRemaining-=e,this.endRemaining-=e}},{key:"resume",value:function(){this.endTimerId||(this.start=Date.now(),this.firstRemaining>0&&(this.firstTimerId=window.setTimeout(this.onFirstQuartile,this.firstRemaining)),this.midRemaining>0&&(this.midTimerId=window.setTimeout(this.onMidPoint,this.midRemaining)),this.thirdRemaining>0&&(this.thirdTimerId=window.setTimeout(this.onThirdQuartile,this.thirdRemaining)),this.endRemaining>0&&(this.endTimerId=window.setTimeout(this.onTimerEnd,this.endRemaining)))}}])&&ve(t.prototype,n),r&&ve(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function me(e){return me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},me(e)}function ge(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,o=void 0,o=function(e,t){if("object"!==me(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==me(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===me(o)?o:String(o)),r)}var i,o}function be(e,t){return be=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},be(e,t)}function Ae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Re(e);if(t){var i=Re(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return we(this,n)}}function we(e,t){if(t&&("object"===me(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ke(e)}function ke(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Te(){return Te="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Ee(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},Te.apply(this,arguments)}function Ee(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Re(e)););return e}function Re(e){return Re=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Re(e)}var Se=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&be(e,t)}(o,e);var t,n,r,i=Ae(o);function o(e,t,n,r){var a,s,l,c,u;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(u=i.call(this,e,t,n)).id="TrackerWrapper",u.tracker=r,u.tracker.on("clickthrough",u.applyClick),n.addEventListener("click",u.onAdClickThru.bind(ke(u))),n.addEventListener("touch",u.onAdClickThru.bind(ke(u))),n.style.cursor="pointer",u.adLoaded=!1,u.adPlaying=!1,u.startOnReady=!1,u.hasCompletedOnce=!1,u.mrc_viewable_sent=!1,u.quartileTimer=new ye({onFirstQuartile:function(){Te((a=ke(u),Re(o.prototype)),"triggerOnce",a).call(a,P.AdVideoFirstQuartile)},onMidPoint:function(){Te((s=ke(u),Re(o.prototype)),"triggerOnce",s).call(s,P.AdVideoMidpoint)},onThirdQuartile:function(){Te((l=ke(u),Re(o.prototype)),"triggerOnce",l).call(l,P.AdVideoThirdQuartile)},onTimerEnd:function(){Te((c=ke(u),Re(o.prototype)),"triggerOnce",c).call(c,P.AdVideoComplete)}}),u}return t=o,n=[{key:"onAdLoaded",value:function(){this.tracker.emit(P.AdLoaded),Te(Re(o.prototype),"onAdLoaded",this).call(this)}},{key:"onAdDurationChange",value:function(){Te(Re(o.prototype),"onAdDurationChange",this).call(this),this.tracker.setDuration(this.duration),this.duration>0&&this.quartileTimer.update(1e3*this.duration)}},{key:"onAdRemainingTimeChange",value:function(){this.handleTimeEvent(P.AdRemainingTimeChange),Te(Re(o.prototype),"onAdRemainingTimeChange",this).call(this)}},{key:"onAdStarted",value:function(){var e=this;this.handleTimeEvent(P.AdVideoStart),de.addListener(this.adContainer,(function(t){var n;e.mrc_viewable_sent||t===ce&&(null===(n=e.tracker.ad.viewableImpression)||void 0===n||n.forEach((function(e){pe(e.viewable)})),e.mrc_viewable_sent=!0),t===le?e.pauseAd():t===se&&e.resumeAd()})),this.adPlaying=!0,Te(Re(o.prototype),"onAdStarted",this).call(this)}},{key:"onAdVideoFirstQuartile",value:function(){this.handleTimeEvent(P.AdVideoFirstQuartile),Te(Re(o.prototype),"onAdVideoFirstQuartile",this).call(this)}},{key:"onAdVideoMidpoint",value:function(){this.handleTimeEvent(P.AdVideoMidpoint),Te(Re(o.prototype),"onAdVideoMidpoint",this).call(this)}},{key:"onAdVideoThirdQuartile",value:function(){this.handleTimeEvent(P.AdVideoThirdQuartile),Te(Re(o.prototype),"onAdVideoThirdQuartile",this).call(this)}},{key:"onAdProgress",value:function(e){this.tracker.setProgress(e),Te(Re(o.prototype),"onAdProgress",this).call(this,e)}},{key:"handleTimeEvent",value:function(e){this.tracker.setProgress(this.getAdElapsedTime()),this.tracker.emit(e)}},{key:"onAdImpression",value:function(){this.tracker.trackImpression(),Te(Re(o.prototype),"onAdImpression",this).call(this)}},{key:"onAdPlaying",value:function(){this.adPlaying=!0,this.hasCompletedOnce||this.tracker.setPaused(!1),this.tracker.emit(P.AdPlaying),Te(Re(o.prototype),"onAdPlaying",this).call(this),this.quartileTimer.resume()}},{key:"onAdPaused",value:function(){this.adPlaying=!1,this.hasCompletedOnce?this.tracker.emit(P.AdPaused):this.tracker.setPaused(!0),Te(Re(o.prototype),"onAdPaused",this).call(this),this.quartileTimer.pause()}},{key:"onAdStopped",value:function(){var e;this.adPlaying=!1,this.mrc_viewable_sent||null===(e=this.tracker.ad.viewableImpression)||void 0===e||e.forEach((function(e){pe(e.notviewable)})),Te(Re(o.prototype),"onAdStopped",this).call(this),this.quartileTimer.pause()}},{key:"onAdVideoComplete",value:function(){this.adPlaying=!1,this.hasCompletedOnce?this.tracker.emit(P.AdVideoComplete):(this.tracker.complete(),this.hasCompletedOnce=!0),Te(Re(o.prototype),"onAdVideoComplete",this).call(this)}},{key:"onAdVolumeChange",value:function(){this.tracker.setMuted(0===this.creative.getAdVolume()),Te(Re(o.prototype),"onAdVolumeChange",this).call(this)}},{key:"onAdClickThru",value:function(){this.tracker.click(),Te(Re(o.prototype),"onAdClickThru",this).call(this)}},{key:"applyClick",value:function(e){var t=this;this.hasTriggerred||(this.hasTriggerred=!0,window.open(e,"_blank"),setTimeout((function(){t.hasTriggerred=!1}),50))}},{key:"onAdError",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"900";this.adPlaying=!1,this.tracker.error({ERRORCODE:e}),Te(Re(o.prototype),"onAdError",this).call(this),this.quartileTimer.pause()}}],n&&ge(t.prototype,n),r&&ge(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(M);function Oe(e){return function(e){if(Array.isArray(e))return Ce(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Ce(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ce(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Pe(){function e(e,t){var n=[],r=-1;return e.forEach((function(e){var i,o,a,s,l=e.getBoundingClientRect();if(l&&!["A"].includes(e.nodeName)){var c=l.width,u=l.x,d=l.x+l.width;c>t&&(-1===r&&(r=c),c===r&&u>-20&&d<=window.innerWidth+20&&(i=e,o=i.getBoundingClientRect(),a=window.pageXOffset||document.documentElement.scrollLeft,s=window.pageYOffset||document.documentElement.scrollTop,{top:o.top+s,left:o.left+a,right:o.left+a+o.width,bottom:o.top+s+o.height}).bottom>window.innerHeight/2&&n.push(e))}})),n}function t(n,r){var i,o=r,a=parseInt(window.innerWidth,10)/2,s=Array.from(n.children),l=e(s,a);l.length>0&&((i=o).push.apply(i,Oe(l)),s.forEach((function(e){o=t(e,o)})));return o}return new Promise((function(e,n){var r=t(window.document.body,[]);0===r.length&&n(new Error("AutoPositioning: Target Not found.")),l((function(){e(c(r))}))}))}function Le(e){return Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Le(e)}function xe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,o=void 0,o=function(e,t){if("object"!==Le(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Le(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===Le(o)?o:String(o)),r)}var i,o}function Ie(){return Ie="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Ne(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},Ie.apply(this,arguments)}function Ne(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ve(e)););return e}function je(e,t){return je=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},je(e,t)}function De(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ve(e);if(t){var i=Ve(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ue(this,n)}}function Ue(e,t){if(t&&("object"===Le(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ve(e){return Ve=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ve(e)}var _e=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&je(e,t)}(o,e);var t,n,r,i=De(o);function o(e,t,n,r){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(a=i.call(this,e,t,n)).id="AdFormat",a.config=r,a.video=t,a.adContainer=n,a.playerDiv=document.createElement("div"),a.playerDiv.setAttribute("id","rsplayer"),a.playerDiv.style.position="relative",a.video.volume=0,a.video.style.width="100%",a.video.style.height="100%",a.video.style.position="absolute",a.video.style.top="0px",a.video.style.left="0px",a.video.style.backgroundColor="black",a.adContainer.style.width="100%",a.adContainer.style.height="100%",a.adContainer.style.position="absolute",a.adContainer.style.top="0px",a.adContainer.style.left="0px",a.playerDiv.appendChild(a.video),a.playerDiv.appendChild(a.adContainer),window.setTimeout((function(){a.insertPlayer(r.CSSSelector)}),0),a}return t=o,(n=[{key:"insertPlayer",value:function(e){var t=window.document.querySelector(e);t&&t.appendChild(this.playerDiv)}},{key:"initAd",value:function(e,t,n,r,i,a){this.playerDiv.style.width="".concat(e,"px"),this.playerDiv.style.height="".concat(t,"px"),Ie(Ve(o.prototype),"initAd",this).call(this)}},{key:"resizeAd",value:function(e,t,n){this.playerDiv.style.width="".concat(e,"px"),this.playerDiv.style.height="".concat(t,"px")}},{key:"onAdLoaded",value:function(){Ie(Ve(o.prototype),"onAdLoaded",this).call(this),this.startAd()}}])&&xe(t.prototype,n),r&&xe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(M);function Be(e){return Be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Be(e)}function Me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,o=void 0,o=function(e,t){if("object"!==Be(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Be(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===Be(o)?o:String(o)),r)}var i,o}function Fe(){return Fe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=We(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},Fe.apply(this,arguments)}function We(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Qe(e)););return e}function He(e,t){return He=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},He(e,t)}function qe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Qe(e);if(t){var i=Qe(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ze(this,n)}}function ze(e,t){if(t&&("object"===Be(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Qe(e){return Qe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Qe(e)}var Ge=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&He(e,t)}(o,e);var t,n,r,i=qe(o);function o(e,t,n,r){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(a=i.call(this,e,t,n,r)).id="IntextFormat",a.speed=.7,a.animatedDiv=document.createElement("div"),a.animatedDiv.style.overflow="hidden",a.animatedDiv.style.height="0px",a.animatedDiv.style.width="100%",a.animatedDiv.style.transition="height ease ".concat(a.speed,"s"),a.waitToStart=!1,a.adLoaded=!1,a}return t=o,(n=[{key:"insertPlayer",value:function(e){var t=this,n=function(e){t.playerDiv.style.margin="auto",t.animatedDiv.appendChild(t.playerDiv),e.appendChild(t.animatedDiv),t.startAd()},r=window.document.querySelector(e);r?n(r):Pe().then((function(e){k(w.DEBUG,"Autopositioning : ",e),n(e)})).catch((function(e){k(w.DEBUG,e.message)}))}},{key:"initAd",value:function(e,t,n,r,i,a){Fe(Qe(o.prototype),"initAd",this).call(this,e,t,n,r,i,a)}},{key:"onAdLoaded",value:function(){this.adLoaded=!0,Fe(Qe(o.prototype),"onAdLoaded",this).call(this)}},{key:"startAd",value:function(){this.animatedDiv.parentElement&&this.adLoaded?Fe(Qe(o.prototype),"startAd",this).call(this):this.waitToStart=!0}},{key:"onAdStarted",value:function(){Fe(Qe(o.prototype),"onAdStarted",this).call(this),this.open()}},{key:"open",value:function(){this.animatedDiv.style.height=this.playerDiv.style.height}},{key:"close",value:function(){var e=this;this.animatedDiv.style.height="0px",window.setTimeout((function(){e.animatedDiv.parentElement&&e.animatedDiv.parentElement.removeChild(e.animatedDiv)}),1e3*this.speed)}},{key:"onAdStopped",value:function(){Fe(Qe(o.prototype),"onAdStopped",this).call(this),this.close()}},{key:"onAdVideoComplete",value:function(){Fe(Qe(o.prototype),"onAdVideoComplete",this).call(this),this.close()}}])&&Me(t.prototype,n),r&&Me(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(_e);function Xe(e){return Xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xe(e)}function Ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ye(Object(n),!0).forEach((function(t){$e(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $e(e,t,n){return(t=Je(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ze(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Je(r.key),r)}}function Je(e){var t=function(e,t){if("object"!==Xe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Xe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Xe(t)?t:String(t)}function et(){return et="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=tt(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},et.apply(this,arguments)}function tt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ot(e)););return e}function nt(e,t){return nt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},nt(e,t)}function rt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ot(e);if(t){var i=ot(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return it(this,n)}}function it(e,t){if(t&&("object"===Xe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ot(e){return ot=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ot(e)}var at=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nt(e,t)}(o,e);var t,n,r,i=rt(o);function o(e,t,n,r){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(a=i.call(this,e,t,n,r)).id="SliderFormat",a.vmargin="number"==typeof r.vmargin?r.vmargin:30,a.hmargin="number"==typeof r.hmargin?r.hmargin:30,a.speed=.7,a.playerDiv.style.position="fixed",a.playerDiv.style.zIndex=1e6,a.playerDiv.style.transition="top ease ".concat(a.speed,"s, left ease ").concat(a.speed,"s, right ease ").concat(a.speed,"s, bottom ease ").concat(a.speed,"s"),a.setPositions(r),a.applyPosition(a.startPosition),a}return t=o,(n=[{key:"insertPlayer",value:function(e){window.document.body.appendChild(this.playerDiv)}},{key:"setPositions",value:function(e){var t,n,r="right";this.vmargin<this.hmargin&&(r="bottom");var i=window.innerHeight-e.height-this.vmargin;(null===(t=e.align)||void 0===t?void 0:t.indexOf("top"))>=0&&(i=this.vmargin,this.vmargin<this.hmargin&&(r="top"));var o,a=window.innerWidth-e.width-this.hmargin;switch((null===(n=e.align)||void 0===n?void 0:n.indexOf("left"))>=0&&(a=this.hmargin,this.vmargin>=this.hmargin&&(r="left")),this.targetPosition={top:"".concat(i,"px"),left:"".concat(a,"px")},e.anim||r){case"top":o={top:"".concat(-e.height,"px")};break;case"left":o={left:"".concat(-e.width,"px")};break;case"bottom":o={top:"".concat(parseInt(e.height,10)+parseInt(window.innerHeight,10),"px")};break;case"right":o={left:"".concat(parseInt(e.width,10)+parseInt(window.innerWidth,10),"px")}}this.startPosition=Ke(Ke({},this.targetPosition),o)}},{key:"applyPosition",value:function(e){var t=this;Object.keys(e).forEach((function(n){t.playerDiv.style[n]=e[n]}))}},{key:"initAd",value:function(e,t,n,r,i,a){et(ot(o.prototype),"initAd",this).call(this,e,t,n,r,i,a)}},{key:"onAdLoaded",value:function(){et(ot(o.prototype),"onAdLoaded",this).call(this),this.applyPosition(this.targetPosition)}},{key:"close",value:function(){var e=this;this.applyPosition(this.startPosition),window.setTimeout((function(){window.document.body.removeChild(e.playerDiv)}),1e3*this.speed)}},{key:"onAdStopped",value:function(){et(ot(o.prototype),"onAdStopped",this).call(this),this.close()}},{key:"onAdVideoComplete",value:function(){et(ot(o.prototype),"onAdVideoComplete",this).call(this),this.close()}}])&&Ze(t.prototype,n),r&&Ze(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(_e);function st(e){return function(e){if(Array.isArray(e))return lt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return lt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return lt(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ct=new RegExp(["€","$","£","%"].map((function(e){return"\\".concat(e)})).join("|")),ut=null;function dt(e){return ct.test(e)}function pt(e,t,n){if(!e||"DIV"!==e.nodeName&&"LI"!==e.nodeName)return!1;var r=0,i=0,o=0;try{var a=getComputedStyle(e);if(r=Math.floor(parseInt(a.width,10)),i=Math.floor(parseInt(a.height,10)),o=Math.floor(e.offsetTop),t&&Math.abs(r-t)>10&&n&&Math.abs(i-n)>10)return!1}catch(e){return!1}return{valid:dt(e.innerText),width:r,height:i,top:o}}function ft(e){if(!ut||e){var t=e?[e]:[].concat(st(document.getElementsByTagName("DIV")),st(document.getElementsByTagName("UL")),st(document.getElementsByTagName("SECTION"))),n=null,r=null;t.length>0&&(r=t.find((function(e){if(e.childElementCount<=4||"absolute"===e.style.position||"fixed"===e.style.position||"none"===e.style.display||null===e.offsetParent)return!1;for(var t=0,r=[[]],i=r[0],o=0,a=0,s=e.firstElementChild,l=s.offsetTop;s&&t<4&&t>=0&&s;){var c=pt(s,o,a);null!=c&&c.valid?(o=c.width,a=c.height,l!==c.top&&(i=[],r.push(i),l=c.top),i.push(c),s=s.nextElementSibling,t+=1):t=-1}return n=r,4===t})));var i=r;k(w.DEBUG,"Retail tools, Found item grid: ",i),k(w.DEBUG,"Grid: ",n),ut={itemList:i,gridProfile:n}}return ut}function ht(e){return ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ht(e)}function vt(e){return function(e){if(Array.isArray(e))return yt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return yt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return yt(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function mt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,o=void 0,o=function(e,t){if("object"!==ht(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==ht(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===ht(o)?o:String(o)),r)}var i,o}var gt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container=t,this.title=null,this.desc=null,this.ctatext=null,this.sponsoredBy=null,this.price=null,this.img=null,this.brandImg=null,this.sponsoredLabel=null,this.buttonsEls=[],this.textEls=[],this.imgEls=[],this.pricesEls=[],this.garbageEls=[]}var t,n,r;return t=e,n=[{key:"isImg",value:function(e){return 1===e.children.length&&"svg"===e.children[0].nodeName||"IMG"===e.nodeName||e.style.background.includes("url(")}},{key:"isText",value:function(e){var t=!1,n=0;return Array.from(e.childNodes).forEach((function(e){var t;3===e.nodeType&&(n+=(null===(t=e.textContent)||void 0===t?void 0:t.trim().length)||0)})),n>1?(Array.from(e.children).forEach((function(t){var n;["SUP","EM","SPAN","A"].includes(t.nodeName)&&(e.innerHTML=e.firstChild.textContent+((null===(n=t.firstChild)||void 0===n?void 0:n.textContent)||""))})),t=null===e.firstElementChild):1===n&&this.garbageEls.push(e),t}},{key:"isButton",value:function(e){for(var t=!1,n=e;!t&&n.children.length<=1;){var r=window.getComputedStyle(n);t=!r.background.includes("rgba(0, 0, 0, 0)")&&!r.background.includes("url("),n=n.parentElement}return t}},{key:"isPrice",value:function(e){var t=e.innerText;return!Number.isNaN(parseInt(t,10))&&dt(t)}},{key:"fetchElements",value:function(){var e=this,t=this.container.querySelectorAll("*");Array.from(t).forEach((function(t){if(t.offsetParent)if(e.isText(t)){var n,r=window.getComputedStyle(t);t.fontSize=parseInt(r.fontSize,10),t.fontWeight=r.fontWeight,t.rotate=null===(n=r.transform)||void 0===n?void 0:n.includes("matrix"),t.isSquare=parseInt(r.width,10)===parseInt(r.height,10),t.rotate||t.isSquare?e.garbageEls.push(t):e.isPrice(t)?e.pricesEls.push(t):e.isButton(t)?e.buttonsEls.push(t):e.textEls.push(t)}else if(e.isImg(t)){var i=window.getComputedStyle(t);t.compWidth=i.width,t.compHeight=i.height,t.compBackground=i.background,t.area=parseInt(i.width,10)*parseInt(i.height,10),e.imgEls.push(t)}})),this.imgEls.sort((function(e,t){return t.area-e.area})),this.img=this.imgEls.shift(),this.brandImg=this.imgEls.shift();var n=function(e,t){if(!e.rotate&&t.rotate)return-1;if(e.rotate&&!t.rotate)return 1;var n=0;return 0==(n=t.fontSize-e.fontSize)&&(n=t.fontWeight-e.fontWeight),0===n&&(n=e.offsetTop-t.offsetTop),n};this.textEls.sort(n),this.title=this.textEls.shift(),this.textEls.sort((function(e,t){return t.innerText.trim().length-e.innerText.trim().length})),this.desc=this.textEls.shift(),this.textEls.sort(n),this.buttonsEls.sort(n),this.ctatext=this.buttonsEls.shift(),this.ctatext||(this.ctatext=this.textEls.shift()),this.sponsoredBy=this.buttonsEls.shift(),this.sponsoredBy||(this.sponsoredBy=this.textEls.shift()),this.pricesEls.sort((function(e,t){return e.innerText.includes("%")&&!t.innerText.includes("%")?1:!e.innerText.includes("%")&&t.innerText.includes("%")?-1:n(e,t)})),this.price=this.pricesEls.shift(),this.sponsoredLabel=this.textEls.shift(),this.hideUnused([].concat(vt(this.imgEls),vt(this.textEls),vt(this.pricesEls),vt(this.buttonsEls),vt(this.garbageEls))),k(w.DEBUG,"title : ",this.title),k(w.DEBUG,"description : ",this.desc),k(w.DEBUG,"ctaText : ",this.ctatext),k(w.DEBUG,"brand : ",this.sponsoredBy),k(w.DEBUG,"price : ",this.price),k(w.DEBUG,"img : ",this.img),k(w.DEBUG,"brandImg : ",this.brandImg)}},{key:"hideUnused",value:function(e){e.forEach((function(e){u(e,(function(e){e.style.display="none"}),(function(e){return e.parentElement.children.length>1}))}))}},{key:"scaleWidth",value:function(e){var t=this;e>1&&this.img&&u(this.img,(function(t){var n=a(t);t.style.minWidth="".concat(Math.floor(n.width*e),"px"),t.style.maxHeight="".concat(n.height,"px")}),(function(e){return e===t.container}))}},{key:"fillText",value:function(e,t){e&&(t?e.innerText=t:d(e,(function(e){e.style.visibility="hidden"}),this.container))}},{key:"fillImg",value:function(e,t){var n=!1;e&&(t&&(e.style.width=e.compWidth,e.style.height=e.compHeight,"IMG"===e.nodeName?(e.style.objectFit="cover",e.src=t,n=!0):e.compBackground.includes("url(")&&(e.style.background=e.compBackground.replace(/(.*url\()([^)"']*)(\).*)/,"$1".concat(t,"$3")),n=!0)),n||(e.style.visibility="hidden"))}},{key:"applyValues",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.fillText(this.title,n.title),this.fillText(this.desc,n.desc),this.fillText(this.ctatext,n.ctatext),this.fillText(this.sponsoredBy,n.sponsoredBy||n.domain),this.fillText(this.price,n.price),this.fillText(this.sponsoredLabel,"Sponsorisé"),this.fillImg(this.img,null===(e=n.image)||void 0===e?void 0:e.url),this.fillImg(this.brandImg,null===(t=n.brandLogo)||void 0===t?void 0:t.url)}},{key:"replaceImg",value:function(e){var t;if(null!==(t=this.img)&&void 0!==t&&t.parentElement){var n=this.img.getBoundingClientRect();this.img.parentElement.replaceChild(e,this.img),e.style.width="".concat(n.width,"px"),e.style.height="".concat(n.height,"px"),e.style.position=this.img.style.position,e.style.left=this.img.style.left,e.style.top=this.img.style.top,e.style.right=this.img.style.right,e.style.bottom=this.img.style.bottom}}},{key:"setAdOverlay",value:function(e){var t=this;this.overlay=document.createElement("div"),this.container.style.position||(this.container.style.position="relative");var n=this.overlay.style;if(n.position="absolute",n.zIndex=99,n.top="0px",n.left="0px",n.width="100%",n.height="100%",n.cursor="pointer",this.overlay.addEventListener("click",(function(n){e.url&&window.open(e.url,"_blank"),"function"==typeof t.onclick&&t.onclick(n)})),!this.sponsoredLabel){var r=document.createElement("div");r.style.position="absolute",r.style.top="-18px",r.style.width="100%",r.style.textAlign="center",r.innerText="Sponsorisé",this.overlay.appendChild(r)}if(e.privacyIcon){var i=document.createElement("img");i.style.position="absolute",i.style.top="0px",i.style.right="0px",i.style.width="20px",i.style.height="20px",i.src=e.privacyIcon,e.privacyUrl&&i.addEventListener("click",(function(){window.open(e.privacyUrl,"_blank")})),this.overlay.appendChild(i)}this.container.appendChild(this.overlay)}},{key:"insertNativeAd",value:function(e){this.applyValues(e),this.setAdOverlay(e)}},{key:"addOverlayElement",value:function(e,t){null!==e.parentElement&&e.parentElement.removeChild(e),this.overlay.appendChild(e),e.style.position="absolute",e.style.width="".concat(t.width,"px"),e.style.height="".concat(t.height,"px"),e.style.left="".concat(t.left,"px"),e.style.top="".concat(t.top,"px")}}],n&&mt(t.prototype,n),r&&mt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function bt(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,i=new gt(e.cloneNode(!0));if(i.container.widthRatio=r,t.insertBefore(i.container,e),i.fetchElements(),r>1&&i.scaleWidth(r),n[0].length>1){var o=n[0].length,a=0;Array.from(t.children).forEach((function(e){e.style.clear=a%o==0?"left":"none",a+=e.widthRatio||1}))}return i}function At(e){return At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},At(e)}function wt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,o=void 0,o=function(e,t){if("object"!==At(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==At(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===At(o)?o:String(o)),r)}var i,o}function kt(){return kt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Tt(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},kt.apply(this,arguments)}function Tt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ot(e)););return e}function Et(e,t){return Et=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Et(e,t)}function Rt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ot(e);if(t){var i=Ot(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return St(this,n)}}function St(e,t){if(t&&("object"===At(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ot(e){return Ot=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ot(e)}var Ct=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Et(e,t)}(o,e);var t,n,r,i=Rt(o);function o(e,t,n,r){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(a=i.call(this,e,t,n,r)).id="IngridFormat",a.speed=.7,a.animatedDiv=document.createElement("div"),a.animatedDiv.style.overflow="hidden",a.animatedDiv.style.height="100%",a.animatedDiv.style.width="0px",a.animatedDiv.style.transition="width ease ".concat(a.speed,"s"),a.waitToStart=!1,a.adLoaded=!1,a}return t=o,(n=[{key:"callStart",value:function(e,t,n){this.placeholder=bt(e,t,n,this.config.ingridSize);var r=a(this.placeholder.container);this.resizeAd(r.width,r.height,"normal"),this.placeholder.container.style.minHeight="".concat(r.height,"px"),this.placeholder.container.replaceChildren(this.animatedDiv),this.placeholder.applyValues(),this.playerDiv.style.margin="auto",this.animatedDiv.appendChild(this.playerDiv),this.startAd()}},{key:"insertPlayer",value:function(e){var t=this,n=ft(window.document.querySelector(e)),r=n.itemList,i=n.gridProfile;l((function(){var e=r,n=i[0].length,o=0;"right"===t.config.align?o=n-2:"center"===t.config.align&&(o=Math.floor((n-1)/2)),n>1&&(e=Array.from(r.children).filter((function(e,t){return t%n===o})));var a=c(e);t.itemList=r,t.gridProfile=i,t.callStart(a,r,i)}))}},{key:"initAd",value:function(e,t,n,r,i,a){kt(Ot(o.prototype),"initAd",this).call(this,e,t,n,r,i,a)}},{key:"onAdLoaded",value:function(){this.adLoaded=!0,kt(Ot(o.prototype),"onAdLoaded",this).call(this)}},{key:"startAd",value:function(){this.adLoaded?kt(Ot(o.prototype),"startAd",this).call(this):this.waitToStart=!0}},{key:"onAdStarted",value:function(){kt(Ot(o.prototype),"onAdStarted",this).call(this),this.open()}},{key:"open",value:function(){this.animatedDiv.style.width=this.playerDiv.style.width}},{key:"close",value:function(){var e=this;this.animatedDiv.style.width="0px",window.setTimeout((function(){var t;null!==(t=e.placeholder.container)&&void 0!==t&&t.parentElement&&function(e,t,n){if(e.parentElement.removeChild(e),n[0].length>1){var r=n[0].length;Array.from(t.children).forEach((function(e,t){e.style.clear=t%r==0?"left":"none"}))}}(e.placeholder.container,e.itemList,e.gridProfile)}),1e3*this.speed)}},{key:"onAdStopped",value:function(){kt(Ot(o.prototype),"onAdStopped",this).call(this),this.close()}},{key:"onAdVideoComplete",value:function(){kt(Ot(o.prototype),"onAdVideoComplete",this).call(this),this.close()}}])&&wt(t.prototype,n),r&&wt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(_e);function Pt(e){return Pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pt(e)}function Lt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,o=void 0,o=function(e,t){if("object"!==Pt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Pt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===Pt(o)?o:String(o)),r)}var i,o}function xt(e,t){return xt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},xt(e,t)}function It(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=jt(e);if(t){var i=jt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Nt(this,n)}}function Nt(e,t){if(t&&("object"===Pt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function jt(e){return jt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},jt(e)}var Dt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xt(e,t)}(o,e);var t,n,r,i=It(o);function o(e,t,n,r){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(a=i.call(this,e,t,n,r)).id="IngridNativeFormat",a}return t=o,(n=[{key:"callStart",value:function(e,t,n){var r=this;this.placeholder=bt(e,t,n,this.config.ingridSize);var i=a(this.placeholder.container);this.resizeAd(i.width,i.height,"normal"),this.placeholder.container.style.minHeight="".concat(i.height,"px"),this.placeholder.insertNativeAd({title:"Montre ronde MUST de CARTIER",price:"1750 €",desc:"29mm, mouvement quartz, acier, bracelet en matière non-animale",ctatext:"En savoir plus",domain:"cartier.com",image:{url:"http://localhost:3000/docs/sample/zoe.jpeg"},brandLogo:{url:null}}),this.placeholder.onclick=function(e){r.getInnerCreative().onAdClickThru()},this.placeholder.replaceImg(this.playerDiv);var o,s,l,c,u=(o=this.playerDiv,s=this.placeholder.container,l=s.getBoundingClientRect(),{width:(c=o.getBoundingClientRect()).width,height:c.height,top:c.top-l.top,right:c.right-l.right,bottom:c.bottom-l.bottom,left:c.left-l.left});this.placeholder.addOverlayElement(this.adContainer,u),this.playerDiv.style.margin="auto",this.startAd()}}])&&Lt(t.prototype,n),r&&Lt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(Ct);function Ut(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R.AUTO,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:T;switch(e){case R.SLIDER:return at;case R.INTEXT:return Ge;case R.INGRID:return t===E?Dt:Ct;default:return _e}}function Vt(e){return Vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vt(e)}function _t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,o=void 0,o=function(e,t){if("object"!==Vt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Vt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===Vt(o)?o:String(o)),r)}var i,o}var Bt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.OM_SERVICE_URL="".concat(A,"omweb-v1.js"),this.OM_SESSION_URL="".concat(A,"omid-session-client-v1.js")}var t,n,r;return t=e,(n=[{key:"insertOMScript",value:function(e){var t=this,n=f();if(n.document.getElementsByClassName("rs-om-service").length>0)this.OmidSessionClient=n.OmidSessionClient&&n.OmidSessionClient.default,e();else{var r=document.createElement("script");r.className="ayl-om_service",r.type="text/javascript",r.setAttribute("src",this.OM_SERVICE_URL),r.addEventListener("load",(function(){var r=document.createElement("script");r.className="ayl-om_service",r.type="text/javascript",r.setAttribute("src",t.OM_SESSION_URL),r.addEventListener("load",(function(){t.OmidSessionClient=n.OmidSessionClient&&n.OmidSessionClient.default,e()})),n.document.body.appendChild(r)})),n.document.head.appendChild(r)}}},{key:"createOMSession",value:function(e,t,n){var r=this;this.vpaid=t,this.video=n;var i=f(),o=i.document.URL,a=g,s=new this.OmidSessionClient.Partner("RetailSpot",a),l=e.adVerifications.map((function(e){var t=e.resource;return new r.OmidSessionClient.VerificationScriptResource(t,e.vendor,e.verificationParameters,"full")})),c=new this.OmidSessionClient.Context(s,l,o);c.setServiceWindow(i),c.setVideoElement(n),this.adSession=new this.OmidSessionClient.AdSession(c),this.adSession.isSupported()&&(this.adSession.setCreativeType("video"),this.adEvents=new this.OmidSessionClient.AdEvents(this.adSession),this.mediaEvents=new this.OmidSessionClient.MediaEvents(this.adSession),this.adSession.start(),this.addListeners())}},{key:"addListeners",value:function(){var e=this;this.vpaid.subscribe((function(){var t=new e.OmidSessionClient.VastProperties(!1,0,!0,"standalone");e.adEvents.loaded(t)}),P.AdLoaded),this.vpaid.subscribe((function(){e.adEvents.impressionOccurred(),e.mediaEvents.start(e.video.duration,e.video.volume)}),P.AdStarted),this.vpaid.subscribe((function(){e.mediaEvents.firstQuartile()}),P.AdVideoFirstQuartile),this.vpaid.subscribe((function(){e.mediaEvents.midpoint()}),P.AdVideoMidpoint),this.vpaid.subscribe((function(){e.mediaEvents.thirdQuartile()}),P.AdVideoThirdQuartile),this.vpaid.subscribe((function(){e.mediaEvents.complete(),setTimeout((function(){var t;null===(t=e.adSession)||void 0===t||t.finish()}),3e3)}),P.AdVideoComplete)}}])&&_t(t.prototype,n),r&&_t(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Mt='<svg xmlns="http://www.w3.org/2000/svg" height="{{HEIGHT}}px" viewBox="0 0 24 24" width="{{WIDTH}}px" fill="#FFFFFF"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>',Ft='<svg xmlns="http://www.w3.org/2000/svg" height="{{HEIGHT}}px" viewBox="0 0 24 24" width="{{WIDTH}}px" fill="#FFFFFF"><path d="M0 0h24v24H0z" fill="none"/><path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"/></svg>',Wt='<svg xmlns="http://www.w3.org/2000/svg" height="{{HEIGHT}}px" viewBox="0 0 24 24" width="{{WIDTH}}px" fill="#FFFFFF"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/></svg>';function Ht(e,t,n){var r=document.createElement("div");return r.innerHTML=e.replace("{{HEIGHT}}",n||48).replace("{{WIDTH}}",t||48),r}function qt(e){return qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qt(e)}function zt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,o=void 0,o=function(e,t){if("object"!==qt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==qt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===qt(o)?o:String(o)),r)}var i,o}function Qt(){return Qt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Gt(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},Qt.apply(this,arguments)}function Gt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$t(e)););return e}function Xt(e,t){return Xt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Xt(e,t)}function Yt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=$t(e);if(t){var i=$t(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Kt(this,n)}}function Kt(e,t){if(t&&("object"===qt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function $t(e){return $t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},$t(e)}var Zt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xt(e,t)}(o,e);var t,n,r,i=Yt(o);function o(e,t,n,r){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(a=i.call(this,e,t,n,r)).id="DisplayWrapper",a.config=r,a.currentVolume=0,a}return t=o,(n=[{key:"onAdLoaded",value:function(){Qt($t(o.prototype),"onAdLoaded",this).call(this);var e=24*Math.min(2,window.devicePixelRatio);if(this.config.closeButton){var t=Ht(Mt,e,e);t.onclick=this.handleClose.bind(this),t.style.position="absolute",t.style.right="8px",t.style.top="8px",t.style.cursor="pointer",this.adContainer.appendChild(t)}this.config.soundButton&&(this.soundon=Ht(Wt,e,e),this.soundon.onclick=this.handleToggleAdVolume.bind(this),this.soundon.style.position="absolute",this.soundon.style.right="8px",this.soundon.style.bottom="8px",this.soundon.style.cursor="pointer",this.soundon.style.display="none",this.adContainer.appendChild(this.soundon),this.soundoff=Ht(Ft,e,e),this.soundoff.onclick=this.handleToggleAdVolume.bind(this),this.soundoff.style.position="absolute",this.soundoff.style.right="8px",this.soundoff.style.bottom="8px",this.soundoff.style.cursor="pointer",this.soundoff.style.display="visible",this.adContainer.appendChild(this.soundoff))}},{key:"onAdStarted",value:function(){Qt($t(o.prototype),"onAdStarted",this).call(this),Qt($t(o.prototype),"setAdVolume",this).call(this,0)}},{key:"stopAd",value:function(){Qt($t(o.prototype),"stopAd",this).call(this)}},{key:"handleClose",value:function(e){e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation(),this.stopAd()}},{key:"handleToggleAdVolume",value:function(e){e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation();var t=this.getAdVolume();0===t?(this.soundon.style.display="",this.soundoff.style.display="none",t=1):(this.soundon.style.display="none",this.soundoff.style.display="",t=0),Qt($t(o.prototype),"setAdVolume",this).call(this,t)}}])&&zt(t.prototype,n),r&&zt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(M);function Jt(t){var n=(new DOMParser).parseFromString(t,"text/xml");return(new e.VASTParser).parseVAST(n).catch((function(e){throw k(w.WARN,"VAST Parse error.",e),e}))}function en(e,t){return new Promise((function(n,r){try{var i=new XMLHttpRequest;i.open("POST",e,!0),i.setRequestHeader("Content-Type","application/json"),i.onreadystatechange=function(){4===i.readyState&&(200===i.status?n(i.responseText):r(new Error("POST request status code: ".concat(i.status))))},i.send(JSON.stringify(t))}catch(e){r(e)}}))}function tn(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"vast4",r=e.placement.split("-");if("eq"!==r[0])throw new Error("Wrong placement id format: ".concat(e.placementId));var i=r[1],o=r[2],a=r[3],s=r[4],l={timestamp:(new Date).getTime(),networkId:i,siteId:o,pageId:a,master:"m",screen:{height:window.screen.height,width:window.screen.width},ads:[{formatId:s}],output:n,gdpr_consent:t.gdpr_consent_string};return new Promise((function(e,t){en("https://prg.smartadserver.com/genericpost",l).then((function(n){Jt(n).then((function(t){e(t)})).catch((function(e){t(e)}))})).catch((function(e){t(e)}))}))}function nn(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return k(w.WARN,"call with not : ".concat(n)),new Promise((function(r,i){tn(e,t).then((function(e){var t;if((null===(t=e.ads)||void 0===t||!t.length)&&n>0)throw new Error("Vast Empty");r(e)})).catch((function(o){k(w.WARN,"Equative - no ad. retry : ".concat(n)),0===n?i(o):setTimeout((function(){nn(e,t,--n).then((function(e){r(e)}))}),500)}))}))}function rn(e,t,n){return new Promise((function(r,i){e.forceResponse?Jt(e.forceResponse).then((function(e){r(e)})):e.vastUrl?n.get(e.vastUrl).then((function(e){r(e)})).catch((function(e){i(e)})):e.placement?nn(e,t,e.retryrequest).then((function(e){r(e)})).catch((function(e){i(e)})):i(new Error("Missing Config.placement."))}))}function on(e){return on="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},on(e)}function an(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function sn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?an(Object(n),!0).forEach((function(t){ln(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):an(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ln(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==on(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==on(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===on(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cn(e,t,n){tn(e,n,"json").then((function(e){e.ad||(k("No ad."),t&&t(null)),e={title:"ZOE E-TECH Electrique",price:"33 700 €",desc:"Essayez la nouvelle Zoe 100% électrique",ctatext:"En savoir plus",url:"https://www.renault.fr/vehicules-electriques/zoe/prix-versions.html",domain:"renault.fr",image:{url:"http://localhost:3000/docs/sample/zoe.jpeg"},brandLogo:{url:"http://no.link.no"},privacyIcon:"https://static.criteo.net/flash/icon/privacy_small.svg",privacyUrl:"https://www.amazon.fr/adprefs/ref=cs_aap_584215806745266336"};var n=function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,t=ft(),n=t.itemList,r=t.gridProfile,i=[],o=n.children[e-1],a=new gt(o.cloneNode(!0));if(i.push(a),n.insertBefore(i[0].container,o.nextSibling),a.fetchElements(),r[0].length>1){var s=r[0].length;Array.from(n.children).forEach((function(e,t){e.style.clear=t%s==0?"left":"none"}))}return i}(1,1)[0];n.container.id="RS-ad-".concat(Math.round(1e4*Math.random())),n.insertNativeAd(e)})).catch((function(e){k(w.WARN,"Error loading native ad. ".concat(e.stack))}))}function un(t,n,r){var i=sn(sn({},function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R.AUTO,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:T;return e===R.INGRID?t===E?O:C:S}(t.format)),t);"native"===i.mediatype&&i.hasNative?cn(i,n,r):function(t,n,r){var i=new e.VASTClient;rn(t,r,i).then((function(r){var o;if(null===(o=r.ads)||void 0===o||!o.length)return k("No ad."),void(n&&n(null));var a,s,l,c,u=document.createElement("video"),d=document.createElement("div");d.id="RS-ad-".concat(Math.round(1e4*Math.random()));try{s=(a=r.ads[0]).creatives.find((function(e){var t;return(null===(t=e.mediaFiles)||void 0===t?void 0:t.length)>0})),l=new e.VASTTracker(i,a,s)}catch(e){k(w.WARN,"Error retreiving creative. ",e),n&&n(null)}var p=[],f=[];s.mediaFiles.forEach((function(e){"VPAID"===e.apiFramework&&"application/x-shockwave-flash"!==e.mimeType?p.push(e):f.push(e)})),p.length>0?c=new Y(u,d,p[0],s.adParameters):f.length>0?c=new ne(u,d,f):k(w.WARN,"No mediafile to play for vast"),c=new Se(c,u,d,l);var h=Ut(t.format,t.mediatype);if(c=new h(c,u,d,t),c=new Zt(c,u,d,t),l.ad.adVerifications.length>0){var v=new Bt;try{v.insertOMScript((function(){try{v.createOMSession(l.ad,c,u)}catch(e){k(w.INFO,"Couldn't create OM session")}c.initAd(t.width,t.height,"normal",null,{},t)}))}catch(e){k(w.INFO,"Couldn't insert OM script")}}else c.initAd(t.width,t.height,"normal",null,{},t);"function"==typeof n&&n(c)})).catch((function(e){k(w.WARN,"Error loading vast file. ".concat(e.stack))}))}(i,n,r)}function dn(e,t){y((function(n){k("Show ad with config:",e),n&&k("Consent:",n),Array.isArray(e)?e.forEach((function(e){return un(e)})):un(e,t,n)}))}window.RetailSpotConfig&&dn(window.RetailSpotConfig)})(),RetailSpot=r})();