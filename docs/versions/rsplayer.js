var RetailSpot;(()=>{var e={495:function(e,t){!function(e){"use strict";function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function n(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?t(Object(i),!0).forEach((function(t){s(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):t(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function d(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=c(e);if(t){var r=c(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return d(this,n)}}function h(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:e.id||null,adId:e.adId||null,sequence:e.sequence||null,apiFramework:e.apiFramework||null,universalAdIds:[],creativeExtensions:[]}}var y=["ADCATEGORIES","ADCOUNT","ADPLAYHEAD","ADSERVINGID","ADTYPE","APIFRAMEWORKS","APPBUNDLE","ASSETURI","BLOCKEDADCATEGORIES","BREAKMAXADLENGTH","BREAKMAXADS","BREAKMAXDURATION","BREAKMINADLENGTH","BREAKMINDURATION","BREAKPOSITION","CLICKPOS","CLICKTYPE","CLIENTUA","CONTENTID","CONTENTPLAYHEAD","CONTENTURI","DEVICEIP","DEVICEUA","DOMAIN","EXTENSIONS","GDPRCONSENT","IFA","IFATYPE","INVENTORYSTATE","LATLONG","LIMITADTRACKING","MEDIAMIME","MEDIAPLAYHEAD","OMIDPARTNER","PAGEURL","PLACEMENTTYPE","PLAYERCAPABILITIES","PLAYERSIZE","PLAYERSTATE","PODSEQUENCE","REGULATIONS","SERVERSIDE","SERVERUA","TRANSACTIONID","UNIVERSALADID","VASTVERSIONS","VERIFICATIONVENDORS"];function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=[],r=A(e);for(var o in!t.ERRORCODE||n.isCustomCode||/^[0-9]{3}$/.test(t.ERRORCODE)||(t.ERRORCODE=900),t.CACHEBUSTING=E(Math.round(1e8*Math.random())),t.TIMESTAMP=(new Date).toISOString(),t.RANDOM=t.random=t.CACHEBUSTING,t)t[o]=T(t[o]);for(var a in r){var s=r[a];"string"==typeof s&&i.push(g(s,t))}return i}function g(e,t){var n=(e=b(e,t)).match(/[^[\]]+(?=])/g);if(!n)return e;var i=n.filter((function(e){return y.indexOf(e)>-1}));return 0===i.length?e:b(e,i=i.reduce((function(e,t){return e[t]=-1,e}),{}))}function b(e,t){var n=e;for(var i in t){var r=t[i];n=n.replace(new RegExp("(?:\\[|%%)(".concat(i,")(?:\\]|%%)"),"g"),r)}return n}function A(e){return Array.isArray(e)?e.map((function(e){return e&&e.hasOwnProperty("url")?e.url:e})):e}function w(e,t){for(var n=0;n<t.length;n++)if(k(t[n],e))return!0;return!1}function k(e,t){if(e&&t){var n=Object.getOwnPropertyNames(e),i=Object.getOwnPropertyNames(t);return n.length===i.length&&e.id===t.id&&e.url===t.url}return!1}function T(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%".concat(e.charCodeAt(0).toString(16))}))}function E(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;return e.toString().padStart(t,"0")}var R={track:function(e,t,n){m(e,t,n).forEach((function(e){"undefined"!=typeof window&&null!==window&&((new Image).src=e)}))},resolveURLTemplates:m,extractURLsFromTemplates:A,containsTemplateObject:w,isTemplateObjectEqual:k,encodeURIComponentRFC3986:T,replaceUrlMacros:g,isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},flatten:function e(t){return t.reduce((function(t,n){return t.concat(Array.isArray(n)?e(n):n)}),[])},joinArrayOfUniqueTemplateObjs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=Array.isArray(e)?e:[],i=Array.isArray(t)?t:[];return n.concat(i).reduce((function(e,t){return w(t,e)||e.push(t),e}),[])},isValidTimeValue:function(e){return Number.isFinite(e)&&e>=-2},addLeadingZeros:E};function S(e){return-1!==["true","TRUE","True","1"].indexOf(e)}var O={childByName:function(e,t){var n=e.childNodes;for(var i in n){var r=n[i];if(r.nodeName===t)return r}},childrenByName:function(e,t){var n=[],i=e.childNodes;for(var r in i){var o=i[r];o.nodeName===t&&n.push(o)}return n},resolveVastAdTagURI:function(e,t){if(!t)return e;if(0===e.indexOf("//")){var n=location.protocol;return"".concat(n).concat(e)}if(-1===e.indexOf("://")){var i=t.slice(0,t.lastIndexOf("/"));return"".concat(i,"/").concat(e)}return e},parseBoolean:S,parseNodeText:function(e){return e&&(e.textContent||e.text||"").trim()},copyNodeAttribute:function(e,t,n){var i=t.getAttribute(e);i&&n.setAttribute(e,i)},parseAttributes:function(e){for(var t=e.attributes,n={},i=0;i<t.length;i++)n[t[i].nodeName]=t[i].nodeValue;return n},parseDuration:function(e){if(null==e)return-1;if(R.isNumeric(e))return parseInt(e);var t=e.split(":");if(3!==t.length)return-1;var n=t[2].split("."),i=parseInt(n[0]);2===n.length&&(i+=parseFloat("0.".concat(n[1])));var r=parseInt(60*t[1]),o=parseInt(60*t[0]*60);return isNaN(o)||isNaN(r)||isNaN(i)||r>3600||i>60?-1:o+r+i},splitVAST:function(e){var t=[],n=null;return e.forEach((function(i,r){if(i.sequence&&(i.sequence=parseInt(i.sequence,10)),i.sequence>1){var o=e[r-1];if(o&&o.sequence===i.sequence-1)return void(n&&n.push(i));delete i.sequence}n=[i],t.push(n)})),t},assignAttributes:function(e,t){if(e)for(var n in e){var i=e[n];if(i.nodeName&&i.nodeValue&&t.hasOwnProperty(i.nodeName)){var r=i.nodeValue;"boolean"==typeof t[i.nodeName]&&(r=S(r)),t[i.nodeName]=r}}},mergeWrapperAdData:function(e,t){e.errorURLTemplates=t.errorURLTemplates.concat(e.errorURLTemplates),e.impressionURLTemplates=t.impressionURLTemplates.concat(e.impressionURLTemplates),e.extensions=t.extensions.concat(e.extensions),t.viewableImpression.length>0&&(e.viewableImpression=[].concat(h(e.viewableImpression),h(t.viewableImpression))),e.followAdditionalWrappers=t.followAdditionalWrappers,e.allowMultipleAds=t.allowMultipleAds,e.fallbackOnNoAd=t.fallbackOnNoAd;var n=(t.creatives||[]).filter((function(e){return e&&"companion"===e.type})),i=n.reduce((function(e,t){return(t.variations||[]).forEach((function(t){(t.companionClickTrackingURLTemplates||[]).forEach((function(t){R.containsTemplateObject(t,e)||e.push(t)}))})),e}),[]);e.creatives=n.concat(e.creatives);var r=t.videoClickTrackingURLTemplates&&t.videoClickTrackingURLTemplates.length,o=t.videoCustomClickURLTemplates&&t.videoCustomClickURLTemplates.length;e.creatives.forEach((function(e){if(t.trackingEvents&&t.trackingEvents[e.type])for(var n in t.trackingEvents[e.type]){var a=t.trackingEvents[e.type][n];Array.isArray(e.trackingEvents[n])||(e.trackingEvents[n]=[]),e.trackingEvents[n]=e.trackingEvents[n].concat(a)}"linear"===e.type&&(r&&(e.videoClickTrackingURLTemplates=e.videoClickTrackingURLTemplates.concat(t.videoClickTrackingURLTemplates)),o&&(e.videoCustomClickURLTemplates=e.videoCustomClickURLTemplates.concat(t.videoCustomClickURLTemplates)),!t.videoClickThroughURLTemplate||null!==e.videoClickThroughURLTemplate&&void 0!==e.videoClickThroughURLTemplate||(e.videoClickThroughURLTemplate=t.videoClickThroughURLTemplate)),"companion"===e.type&&i.length&&(e.variations||[]).forEach((function(e){e.companionClickTrackingURLTemplates=R.joinArrayOfUniqueTemplateObjs(e.companionClickTrackingURLTemplates,i)}))})),t.adVerifications&&(e.adVerifications=e.adVerifications.concat(t.adVerifications)),t.blockedAdCategories&&(e.blockedAdCategories=e.blockedAdCategories.concat(t.blockedAdCategories))}};function C(e,t){var n=function(){var e=v(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return{id:e.id,adId:e.adId,sequence:e.sequence,apiFramework:e.apiFramework,type:"companion",required:null,variations:[]}}(t);return n.required=e.getAttribute("required")||null,n.variations=O.childrenByName(e,"Companion").map((function(e){var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:e.id||null,adType:"companionAd",width:e.width||0,height:e.height||0,assetWidth:e.assetWidth||null,assetHeight:e.assetHeight||null,expandedWidth:e.expandedWidth||null,expandedHeight:e.expandedHeight||null,apiFramework:e.apiFramework||null,adSlotID:e.adSlotID||null,pxratio:e.pxratio||"1",renderingMode:e.renderingMode||"default",staticResources:[],htmlResources:[],iframeResources:[],adParameters:null,xmlEncoded:null,altText:null,companionClickThroughURLTemplate:null,companionClickTrackingURLTemplates:[],trackingEvents:{}}}(O.parseAttributes(e));t.htmlResources=O.childrenByName(e,"HTMLResource").reduce((function(e,t){var n=O.parseNodeText(t);return n?e.concat(n):e}),[]),t.iframeResources=O.childrenByName(e,"IFrameResource").reduce((function(e,t){var n=O.parseNodeText(t);return n?e.concat(n):e}),[]),t.staticResources=O.childrenByName(e,"StaticResource").reduce((function(e,t){var n=O.parseNodeText(t);return n?e.concat({url:n,creativeType:t.getAttribute("creativeType")||null}):e}),[]),t.altText=O.parseNodeText(O.childByName(e,"AltText"))||null;var n=O.childByName(e,"TrackingEvents");n&&O.childrenByName(n,"Tracking").forEach((function(e){var n=e.getAttribute("event"),i=O.parseNodeText(e);n&&i&&(Array.isArray(t.trackingEvents[n])||(t.trackingEvents[n]=[]),t.trackingEvents[n].push(i))})),t.companionClickTrackingURLTemplates=O.childrenByName(e,"CompanionClickTracking").map((function(e){return{id:e.getAttribute("id")||null,url:O.parseNodeText(e)}})),t.companionClickThroughURLTemplate=O.parseNodeText(O.childByName(e,"CompanionClickThrough"))||null;var i=O.childByName(e,"AdParameters");return i&&(t.adParameters=O.parseNodeText(i),t.xmlEncoded=i.getAttribute("xmlEncoded")||null),t})),n}function P(e){return"linear"===e.type}function x(e,t){var n,i=function(){var e=v(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return{id:e.id,adId:e.adId,sequence:e.sequence,apiFramework:e.apiFramework,type:"linear",duration:0,skipDelay:null,mediaFiles:[],mezzanine:null,interactiveCreativeFile:null,closedCaptionFiles:[],videoClickThroughURLTemplate:null,videoClickTrackingURLTemplates:[],videoCustomClickURLTemplates:[],adParameters:null,icons:[],trackingEvents:{}}}(t);i.duration=O.parseDuration(O.parseNodeText(O.childByName(e,"Duration")));var r=e.getAttribute("skipoffset");if(null==r)i.skipDelay=null;else if("%"===r.charAt(r.length-1)&&-1!==i.duration){var o=parseInt(r,10);i.skipDelay=i.duration*(o/100)}else i.skipDelay=O.parseDuration(r);var a=O.childByName(e,"VideoClicks");if(a){var s=O.childByName(a,"ClickThrough");i.videoClickThroughURLTemplate=s?{id:s.getAttribute("id")||null,url:O.parseNodeText(s)}:null,O.childrenByName(a,"ClickTracking").forEach((function(e){i.videoClickTrackingURLTemplates.push({id:e.getAttribute("id")||null,url:O.parseNodeText(e)})})),O.childrenByName(a,"CustomClick").forEach((function(e){i.videoCustomClickURLTemplates.push({id:e.getAttribute("id")||null,url:O.parseNodeText(e)})}))}var l=O.childByName(e,"AdParameters");l&&(i.adParameters=O.parseNodeText(l)),O.childrenByName(e,"TrackingEvents").forEach((function(e){O.childrenByName(e,"Tracking").forEach((function(e){var t=e.getAttribute("event"),r=O.parseNodeText(e);if(t&&r){if("progress"===t){if(!(n=e.getAttribute("offset")))return;t="%"===n.charAt(n.length-1)?"progress-".concat(n):"progress-".concat(Math.round(O.parseDuration(n)))}Array.isArray(i.trackingEvents[t])||(i.trackingEvents[t]=[]),i.trackingEvents[t].push(r)}}))})),O.childrenByName(e,"MediaFiles").forEach((function(e){O.childrenByName(e,"MediaFile").forEach((function(e){i.mediaFiles.push(function(e){var t={id:null,fileURL:null,fileSize:0,deliveryType:"progressive",mimeType:null,mediaType:null,codec:null,bitrate:0,minBitrate:0,maxBitrate:0,width:0,height:0,apiFramework:null,scalable:null,maintainAspectRatio:null};t.id=e.getAttribute("id"),t.fileURL=O.parseNodeText(e),t.deliveryType=e.getAttribute("delivery"),t.codec=e.getAttribute("codec"),t.mimeType=e.getAttribute("type"),t.mediaType=e.getAttribute("mediaType")||"2D",t.apiFramework=e.getAttribute("apiFramework"),t.fileSize=parseInt(e.getAttribute("fileSize")||0),t.bitrate=parseInt(e.getAttribute("bitrate")||0),t.minBitrate=parseInt(e.getAttribute("minBitrate")||0),t.maxBitrate=parseInt(e.getAttribute("maxBitrate")||0),t.width=parseInt(e.getAttribute("width")||0),t.height=parseInt(e.getAttribute("height")||0);var n=e.getAttribute("scalable");n&&"string"==typeof n&&(t.scalable=O.parseBoolean(n));var i=e.getAttribute("maintainAspectRatio");return i&&"string"==typeof i&&(t.maintainAspectRatio=O.parseBoolean(i)),t}(e))}));var t=O.childByName(e,"InteractiveCreativeFile");t&&(i.interactiveCreativeFile=function(e){var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:e.type||null,apiFramework:e.apiFramework||null,variableDuration:O.parseBoolean(e.variableDuration),fileURL:null}}(O.parseAttributes(e));return t.fileURL=O.parseNodeText(e),t}(t));var n=O.childByName(e,"ClosedCaptionFiles");n&&O.childrenByName(n,"ClosedCaptionFile").forEach((function(e){var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:e.type||null,language:e.language||null,fileURL:null}}(O.parseAttributes(e));t.fileURL=O.parseNodeText(e),i.closedCaptionFiles.push(t)}));var r,o,a,s=O.childByName(e,"Mezzanine"),l=(r=s,o={},a=!1,["delivery","type","width","height"].forEach((function(e){r&&r.getAttribute(e)?o[e]=r.getAttribute(e):a=!0})),a?null:o);if(l){var c={id:null,fileURL:null,delivery:null,codec:null,type:null,width:0,height:0,fileSize:0,mediaType:"2D"};c.id=s.getAttribute("id"),c.fileURL=O.parseNodeText(s),c.delivery=l.delivery,c.codec=s.getAttribute("codec"),c.type=l.type,c.width=parseInt(l.width,10),c.height=parseInt(l.height,10),c.fileSize=parseInt(s.getAttribute("fileSize"),10),c.mediaType=s.getAttribute("mediaType")||"2D",i.mezzanine=c}}));var c=O.childByName(e,"Icons");return c&&O.childrenByName(c,"Icon").forEach((function(e){i.icons.push(function(e){var t={program:null,height:0,width:0,xPosition:0,yPosition:0,apiFramework:null,offset:null,duration:0,type:null,staticResource:null,htmlResource:null,iframeResource:null,pxratio:"1",iconClickThroughURLTemplate:null,iconClickTrackingURLTemplates:[],iconViewTrackingURLTemplate:null};t.program=e.getAttribute("program"),t.height=parseInt(e.getAttribute("height")||0),t.width=parseInt(e.getAttribute("width")||0),t.xPosition=function(e){return-1!==["left","right"].indexOf(e)?e:parseInt(e||0)}(e.getAttribute("xPosition")),t.yPosition=function(e){return-1!==["top","bottom"].indexOf(e)?e:parseInt(e||0)}(e.getAttribute("yPosition")),t.apiFramework=e.getAttribute("apiFramework"),t.pxratio=e.getAttribute("pxratio")||"1",t.offset=O.parseDuration(e.getAttribute("offset")),t.duration=O.parseDuration(e.getAttribute("duration")),O.childrenByName(e,"HTMLResource").forEach((function(e){t.type=e.getAttribute("creativeType")||"text/html",t.htmlResource=O.parseNodeText(e)})),O.childrenByName(e,"IFrameResource").forEach((function(e){t.type=e.getAttribute("creativeType")||0,t.iframeResource=O.parseNodeText(e)})),O.childrenByName(e,"StaticResource").forEach((function(e){t.type=e.getAttribute("creativeType")||0,t.staticResource=O.parseNodeText(e)}));var n=O.childByName(e,"IconClicks");return n&&(t.iconClickThroughURLTemplate=O.parseNodeText(O.childByName(n,"IconClickThrough")),O.childrenByName(n,"IconClickTracking").forEach((function(e){t.iconClickTrackingURLTemplates.push({id:e.getAttribute("id")||null,url:O.parseNodeText(e)})}))),t.iconViewTrackingURLTemplate=O.parseNodeText(O.childByName(e,"IconViewTracking")),t}(e))})),i}function L(e,t){var n=function(){var e=v(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return{id:e.id,adId:e.adId,sequence:e.sequence,apiFramework:e.apiFramework,type:"nonlinear",variations:[],trackingEvents:{}}}(t);return O.childrenByName(e,"TrackingEvents").forEach((function(e){var t,i;O.childrenByName(e,"Tracking").forEach((function(e){t=e.getAttribute("event"),i=O.parseNodeText(e),t&&i&&(Array.isArray(n.trackingEvents[t])||(n.trackingEvents[t]=[]),n.trackingEvents[t].push(i))}))})),O.childrenByName(e,"NonLinear").forEach((function(e){var t={id:null,width:0,height:0,expandedWidth:0,expandedHeight:0,scalable:!0,maintainAspectRatio:!0,minSuggestedDuration:0,apiFramework:"static",adType:"nonLinearAd",type:null,staticResource:null,htmlResource:null,iframeResource:null,nonlinearClickThroughURLTemplate:null,nonlinearClickTrackingURLTemplates:[],adParameters:null};t.id=e.getAttribute("id")||null,t.width=e.getAttribute("width"),t.height=e.getAttribute("height"),t.expandedWidth=e.getAttribute("expandedWidth"),t.expandedHeight=e.getAttribute("expandedHeight"),t.scalable=O.parseBoolean(e.getAttribute("scalable")),t.maintainAspectRatio=O.parseBoolean(e.getAttribute("maintainAspectRatio")),t.minSuggestedDuration=O.parseDuration(e.getAttribute("minSuggestedDuration")),t.apiFramework=e.getAttribute("apiFramework"),O.childrenByName(e,"HTMLResource").forEach((function(e){t.type=e.getAttribute("creativeType")||"text/html",t.htmlResource=O.parseNodeText(e)})),O.childrenByName(e,"IFrameResource").forEach((function(e){t.type=e.getAttribute("creativeType")||0,t.iframeResource=O.parseNodeText(e)})),O.childrenByName(e,"StaticResource").forEach((function(e){t.type=e.getAttribute("creativeType")||0,t.staticResource=O.parseNodeText(e)}));var i=O.childByName(e,"AdParameters");i&&(t.adParameters=O.parseNodeText(i)),t.nonlinearClickThroughURLTemplate=O.parseNodeText(O.childByName(e,"NonLinearClickThrough")),O.childrenByName(e,"NonLinearClickTracking").forEach((function(e){t.nonlinearClickTrackingURLTemplates.push({id:e.getAttribute("id")||null,url:O.parseNodeText(e)})})),n.variations.push(t)})),n}function I(e){var t=[];return e.forEach((function(e){var n=N(e);n&&t.push(n)})),t}function N(e){if("#comment"===e.nodeName)return null;var t,n={name:null,value:null,attributes:{},children:[]},i=e.attributes,r=e.childNodes;if(n.name=e.nodeName,e.attributes)for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];a.nodeName&&a.nodeValue&&(n.attributes[a.nodeName]=a.nodeValue)}for(var s in r)if(r.hasOwnProperty(s)){var l=N(r[s]);l&&n.children.push(l)}if(0===n.children.length||1===n.children.length&&["#cdata-section","#text"].indexOf(n.children[0].name)>=0){var c=O.parseNodeText(e);""!==c&&(n.value=c),n.children=[]}return null===(t=n).value&&0===Object.keys(t.attributes).length&&0===t.children.length?null:n}function j(e){var t=[];return e.forEach((function(e){var n,i={id:e.getAttribute("id")||null,adId:D(e),sequence:e.getAttribute("sequence")||null,apiFramework:e.getAttribute("apiFramework")||null},r=[];O.childrenByName(e,"UniversalAdId").forEach((function(e){var t={idRegistry:e.getAttribute("idRegistry")||"unknown",value:O.parseNodeText(e)};r.push(t)}));var o=O.childByName(e,"CreativeExtensions");for(var a in o&&(n=I(O.childrenByName(o,"CreativeExtension"))),e.childNodes){var s=e.childNodes[a],l=void 0;switch(s.nodeName){case"Linear":l=x(s,i);break;case"NonLinearAds":l=L(s,i);break;case"CompanionAds":l=C(s,i)}l&&(r&&(l.universalAdIds=r),n&&(l.creativeExtensions=n),t.push(l))}})),t}function D(e){return e.getAttribute("AdID")||e.getAttribute("adID")||e.getAttribute("adId")||null}var U={Wrapper:{subElements:["VASTAdTagURI","Impression"]},BlockedAdCategories:{attributes:["authority"]},InLine:{subElements:["AdSystem","AdTitle","Impression","AdServingId","Creatives"]},Category:{attributes:["authority"]},Pricing:{attributes:["model","currency"]},Verification:{oneOfinLineResources:["JavaScriptResource","ExecutableResource"],attributes:["vendor"]},UniversalAdId:{attributes:["idRegistry"]},JavaScriptResource:{attributes:["apiFramework","browserOptional"]},ExecutableResource:{attributes:["apiFramework","type"]},Tracking:{attributes:["event"]},Creatives:{subElements:["Creative"]},Creative:{subElements:["UniversalAdId"]},Linear:{subElements:["MediaFiles","Duration"]},MediaFiles:{subElements:["MediaFile"]},MediaFile:{attributes:["delivery","type","width","height"]},Mezzanine:{attributes:["delivery","type","width","height"]},NonLinear:{oneOfinLineResources:["StaticResource","IFrameResource","HTMLResource"],attributes:["width","height"]},Companion:{oneOfinLineResources:["StaticResource","IFrameResource","HTMLResource"],attributes:["width","height"]},StaticResource:{attributes:["creativeType"]},Icons:{subElements:["Icon"]},Icon:{oneOfinLineResources:["StaticResource","IFrameResource","HTMLResource"]}};function V(e,t){if(U[e.nodeName]&&U[e.nodeName].attributes){var n=U[e.nodeName].attributes.filter((function(t){return!e.getAttribute(t)}));n.length>0&&M({name:e.nodeName,parentName:e.parentNode.nodeName,attributes:n},t)}}function _(e,t,n){var i=U[e.nodeName],r=!n&&"Wrapper"!==e.nodeName;if(i&&!r){if(i.subElements){var o=i.subElements.filter((function(t){return!O.childByName(e,t)}));o.length>0&&M({name:e.nodeName,parentName:e.parentNode.nodeName,subElements:o},t)}n&&i.oneOfinLineResources&&(i.oneOfinLineResources.some((function(t){return O.childByName(e,t)}))||M({name:e.nodeName,parentName:e.parentNode.nodeName,oneOfResources:i.oneOfinLineResources},t))}}function B(e){return e.children&&0!==e.children.length}function M(e,t){var n=e.name,i=e.parentName,r=e.attributes,o=e.subElements,a=e.oneOfResources,s="Element '".concat(n,"'");t("VAST-warning",{message:s+=r?" missing required attribute(s) '".concat(r.join(", "),"' "):o?" missing required sub element(s) '".concat(o.join(", "),"' "):a?" must provide one of the following '".concat(a.join(", "),"' "):" is empty",parentElement:i,specVersion:4.1})}var F={verifyRequiredValues:function e(t,n,i){if(t&&t.nodeName)if("InLine"===t.nodeName&&(i=!0),V(t,n),B(t)){_(t,n,i);for(var r=0;r<t.children.length;r++)e(t.children[r],n,i)}else 0===O.parseNodeText(t).length&&M({name:t.nodeName,parentName:t.parentNode.nodeName},n)},hasSubElements:B,emitMissingValueWarning:M,verifyRequiredAttributes:V,verifyRequiredSubElements:_};function W(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.allowMultipleAds,r=n.followAdditionalWrappers,o=e.childNodes;for(var a in o){var s=o[a];if(-1!==["Wrapper","InLine"].indexOf(s.nodeName)&&("Wrapper"!==s.nodeName||!1!==r)){if(O.copyNodeAttribute("id",e,s),O.copyNodeAttribute("sequence",e,s),O.copyNodeAttribute("adType",e,s),"Wrapper"===s.nodeName)return{ad:q(s,t),type:"WRAPPER"};if("InLine"===s.nodeName)return{ad:H(s,t,{allowMultipleAds:i}),type:"INLINE"}}}}function H(e,t){return!1===(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).allowMultipleAds&&e.getAttribute("sequence")?null:z(e,t)}function z(e,t){var n=[];t&&F.verifyRequiredValues(e,t);var i=e.childNodes,r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:e.id||null,sequence:e.sequence||null,adType:e.adType||null,adServingId:null,categories:[],expires:null,viewableImpression:[],system:null,title:null,description:null,advertiser:null,pricing:null,survey:null,errorURLTemplates:[],impressionURLTemplates:[],creatives:[],extensions:[],adVerifications:[],blockedAdCategories:[],followAdditionalWrappers:!0,allowMultipleAds:!1,fallbackOnNoAd:null}}(O.parseAttributes(e));for(var o in i){var a=i[o];switch(a.nodeName){case"Error":r.errorURLTemplates.push(O.parseNodeText(a));break;case"Impression":r.impressionURLTemplates.push({id:a.getAttribute("id")||null,url:O.parseNodeText(a)});break;case"Creatives":r.creatives=j(O.childrenByName(a,"Creative"));break;case"Extensions":var s=O.childrenByName(a,"Extension");r.extensions=I(s),r.adVerifications.length||(n=Q(s));break;case"AdVerifications":r.adVerifications=G(O.childrenByName(a,"Verification"));break;case"AdSystem":r.system={value:O.parseNodeText(a),version:a.getAttribute("version")||null};break;case"AdTitle":r.title=O.parseNodeText(a);break;case"AdServingId":r.adServingId=O.parseNodeText(a);break;case"Category":r.categories.push({authority:a.getAttribute("authority")||null,value:O.parseNodeText(a)});break;case"Expires":r.expires=parseInt(O.parseNodeText(a),10);break;case"ViewableImpression":r.viewableImpression.push(X(a));break;case"Description":r.description=O.parseNodeText(a);break;case"Advertiser":r.advertiser={id:a.getAttribute("id")||null,value:O.parseNodeText(a)};break;case"Pricing":r.pricing={value:O.parseNodeText(a),model:a.getAttribute("model")||null,currency:a.getAttribute("currency")||null};break;case"Survey":r.survey=O.parseNodeText(a);break;case"BlockedAdCategories":r.blockedAdCategories.push({authority:a.getAttribute("authority")||null,value:O.parseNodeText(a)})}}return n.length&&(r.adVerifications=r.adVerifications.concat(n)),r}function q(e,t){var n=z(e,t),i=e.getAttribute("followAdditionalWrappers"),r=e.getAttribute("allowMultipleAds"),o=e.getAttribute("fallbackOnNoAd");n.followAdditionalWrappers=!i||O.parseBoolean(i),n.allowMultipleAds=!!r&&O.parseBoolean(r),n.fallbackOnNoAd=o?O.parseBoolean(o):null;var a=O.childByName(e,"VASTAdTagURI");if(a?n.nextWrapperURL=O.parseNodeText(a):(a=O.childByName(e,"VASTAdTagURL"))&&(n.nextWrapperURL=O.parseNodeText(O.childByName(a,"URL"))),n.creatives.forEach((function(e){if(-1!==["linear","nonlinear"].indexOf(e.type)){if(e.trackingEvents){n.trackingEvents||(n.trackingEvents={}),n.trackingEvents[e.type]||(n.trackingEvents[e.type]={});var t=function(t){var i=e.trackingEvents[t];Array.isArray(n.trackingEvents[e.type][t])||(n.trackingEvents[e.type][t]=[]),i.forEach((function(i){n.trackingEvents[e.type][t].push(i)}))};for(var i in e.trackingEvents)t(i)}e.videoClickTrackingURLTemplates&&(Array.isArray(n.videoClickTrackingURLTemplates)||(n.videoClickTrackingURLTemplates=[]),e.videoClickTrackingURLTemplates.forEach((function(e){n.videoClickTrackingURLTemplates.push(e)}))),e.videoClickThroughURLTemplate&&(n.videoClickThroughURLTemplate=e.videoClickThroughURLTemplate),e.videoCustomClickURLTemplates&&(Array.isArray(n.videoCustomClickURLTemplates)||(n.videoCustomClickURLTemplates=[]),e.videoCustomClickURLTemplates.forEach((function(e){n.videoCustomClickURLTemplates.push(e)})))}})),n.nextWrapperURL)return n}function G(e){var t=[];return e.forEach((function(e){var n={resource:null,vendor:null,browserOptional:!1,apiFramework:null,type:null,parameters:null,trackingEvents:{}},i=e.childNodes;for(var r in O.assignAttributes(e.attributes,n),i){var o=i[r];switch(o.nodeName){case"JavaScriptResource":case"ExecutableResource":n.resource=O.parseNodeText(o),O.assignAttributes(o.attributes,n);break;case"VerificationParameters":n.parameters=O.parseNodeText(o)}}var a=O.childByName(e,"TrackingEvents");a&&O.childrenByName(a,"Tracking").forEach((function(e){var t=e.getAttribute("event"),i=O.parseNodeText(e);t&&i&&(Array.isArray(n.trackingEvents[t])||(n.trackingEvents[t]=[]),n.trackingEvents[t].push(i))})),t.push(n)})),t}function Q(e){var t=null,n=[];return e.some((function(e){return t=O.childByName(e,"AdVerifications")})),t&&(n=G(O.childrenByName(t,"Verification"))),n}function X(e){var t={};t.id=e.getAttribute("id")||null;var n=e.childNodes;for(var i in n){var r=n[i],o=r.nodeName,a=O.parseNodeText(r);if(("Viewable"===o||"NotViewable"===o||"ViewUndetermined"===o)&&a){var s=o.toLowerCase();Array.isArray(t[s])||(t[s]=[]),t[s].push(a)}}return t}var Y=function(){function e(){r(this,e),this._handlers=[]}return a(e,[{key:"on",value:function(e,t){if("function"!=typeof t)throw new TypeError("The handler argument must be of type Function. Received type ".concat(i(t)));if(!e)throw new TypeError("The event argument must be of type String. Received type ".concat(i(e)));return this._handlers.push({event:e,handler:t}),this}},{key:"once",value:function(e,t){return this.on(e,function(e,t,n){var i={fired:!1,wrapFn:void 0};function r(){i.fired||(e.off(t,i.wrapFn),i.fired=!0,n.bind(e).apply(void 0,arguments))}return i.wrapFn=r,r}(this,e,t))}},{key:"off",value:function(e,t){return this._handlers=this._handlers.filter((function(n){return n.event!==e||n.handler!==t})),this}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r=!1;return this._handlers.forEach((function(t){"*"===t.event&&(r=!0,t.handler.apply(t,[e].concat(n))),t.event===e&&(r=!0,t.handler.apply(t,n))})),r}},{key:"removeAllListeners",value:function(e){return e?(this._handlers=this._handlers.filter((function(t){return t.event!==e})),this):(this._handlers=[],this)}},{key:"listenerCount",value:function(e){return this._handlers.filter((function(t){return t.event===e})).length}},{key:"listeners",value:function(e){return this._handlers.reduce((function(t,n){return n.event===e&&t.push(n.handler),t}),[])}},{key:"eventNames",value:function(){return this._handlers.map((function(e){return e.event}))}}]),e}(),K={get:function(e,t,n){n(new Error("Please bundle the library for node to use the node urlHandler"))}},Z=12e4;function $(){try{var e=new window.XMLHttpRequest;return"withCredentials"in e?e:null}catch(e){return null}}function J(e,t,n){var i=n?408:e.status,r=n?"XHRURLHandler: Request timed out after ".concat(e.timeout," ms (").concat(i,")"):"XHRURLHandler: ".concat(e.statusText," (").concat(i,")");t(new Error(r),null,{statusCode:i})}var ee={get:function(e,t,n){if("https:"===window.location.protocol&&0===e.indexOf("http://"))return n(new Error("XHRURLHandler: Cannot go from HTTPS to HTTP."));try{var i=$();i.open("GET",e),i.timeout=t.timeout||Z,i.withCredentials=t.withCredentials||!1,i.overrideMimeType&&i.overrideMimeType("text/xml"),i.onload=function(){return function(e,t){200===e.status?t(null,e.responseXML,{byteLength:e.response.length,statusCode:e.status}):J(e,t,!1)}(i,n)},i.onerror=function(){return J(i,n,!1)},i.onabort=function(){return J(i,n,!1)},i.ontimeout=function(){return J(i,n,!0)},i.send()}catch(e){n(new Error("XHRURLHandler: Unexpected error"))}},supported:function(){return!!$()}},te={get:function(e,t,n){return n||("function"==typeof t&&(n=t),t={}),"undefined"==typeof window||null===window?K.get(e,t,n):ee.supported()?ee.get(e,t,n):n(new Error("Current context is not supported by any of the default URLHandlers. Please provide a custom URLHandler"))}},ne=0,ie=0,re=function(e,t){!e||!t||e<=0||t<=0||(ie=(ie*ne+8*e/t)/++ne)},oe={ERRORCODE:900,extensions:[]},ae=function(e){l(n,e);var t=p(n);function n(){var e;return r(this,n),(e=t.call(this)).remainingAds=[],e.parentURLs=[],e.errorURLTemplates=[],e.rootErrorURLTemplates=[],e.maxWrapperDepth=null,e.URLTemplateFilters=[],e.fetchingOptions={},e.parsingOptions={},e}return a(n,[{key:"addURLTemplateFilter",value:function(e){"function"==typeof e&&this.URLTemplateFilters.push(e)}},{key:"removeURLTemplateFilter",value:function(){this.URLTemplateFilters.pop()}},{key:"countURLTemplateFilters",value:function(){return this.URLTemplateFilters.length}},{key:"clearURLTemplateFilters",value:function(){this.URLTemplateFilters=[]}},{key:"trackVastError",value:function(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];this.emit("VAST-error",Object.assign.apply(Object,[{},oe,t].concat(i))),R.track(e,t)}},{key:"getErrorURLTemplates",value:function(){return this.rootErrorURLTemplates.concat(this.errorURLTemplates)}},{key:"getEstimatedBitrate",value:function(){return ie}},{key:"fetchVAST",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new Promise((function(o,a){t.URLTemplateFilters.forEach((function(t){e=t(e)})),t.parentURLs.push(e);var s=Date.now();t.emit("VAST-resolving",{url:e,previousUrl:i,wrapperDepth:n,maxWrapperDepth:t.maxWrapperDepth,timeout:t.fetchingOptions.timeout,wrapperAd:r}),t.urlHandler.get(e,t.fetchingOptions,(function(r,l){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=Math.round(Date.now()-s),d=Object.assign({url:e,previousUrl:i,wrapperDepth:n,error:r,duration:u},c);t.emit("VAST-resolved",d),re(c.byteLength,u),r?a(r):o(l)}))}))}},{key:"initParsingStatus",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.errorURLTemplates=[],this.fetchingOptions={timeout:e.timeout||Z,withCredentials:e.withCredentials},this.maxWrapperDepth=e.wrapperLimit||10,this.parentURLs=[],this.parsingOptions={allowMultipleAds:e.allowMultipleAds},this.remainingAds=[],this.rootErrorURLTemplates=[],this.rootURL="",this.urlHandler=e.urlHandler||e.urlhandler||te,this.vastVersion=null,re(e.byteLength,e.requestDuration)}},{key:"getRemainingAds",value:function(e){var t=this;if(0===this.remainingAds.length)return Promise.reject(new Error("No more ads are available for the given VAST"));var n=e?R.flatten(this.remainingAds):this.remainingAds.shift();return this.errorURLTemplates=[],this.parentURLs=[],this.resolveAds(n,{wrapperDepth:0,url:this.rootURL}).then((function(e){return t.buildVASTResponse(e)}))}},{key:"getAndParseVAST",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.initParsingStatus(n),this.URLTemplateFilters.forEach((function(t){e=t(e)})),this.rootURL=e,this.fetchVAST(e).then((function(i){return n.previousUrl=e,n.isRootVAST=!0,n.url=e,t.parse(i,n).then((function(e){return t.buildVASTResponse(e)}))}))}},{key:"parseVAST",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.initParsingStatus(n),n.isRootVAST=!0,this.parse(e,n).then((function(e){return t.buildVASTResponse(e)}))}},{key:"buildVASTResponse",value:function(e){var t,n={ads:(t={ads:e,errorURLTemplates:this.getErrorURLTemplates(),version:this.vastVersion}).ads||[],errorURLTemplates:t.errorURLTemplates||[],version:t.version||null};return this.completeWrapperResolving(n),n}},{key:"parseVastXml",value:function(e,t){var n=t.isRootVAST,i=void 0!==n&&n,r=t.url,o=void 0===r?null:r,a=t.wrapperDepth,s=void 0===a?0:a,l=t.allowMultipleAds,c=t.followAdditionalWrappers;if(!e||!e.documentElement||"VAST"!==e.documentElement.nodeName)throw this.emit("VAST-ad-parsed",{type:"ERROR",url:o,wrapperDepth:s}),new Error("Invalid VAST XMLDocument");var u=[],d=e.documentElement.childNodes,p=e.documentElement.getAttribute("version");for(var h in i&&p&&(this.vastVersion=p),d){var f=d[h];if("Error"===f.nodeName){var v=O.parseNodeText(f);i?this.rootErrorURLTemplates.push(v):this.errorURLTemplates.push(v)}else if("Ad"===f.nodeName){if(this.vastVersion&&parseFloat(this.vastVersion)<3)l=!0;else if(!1===l&&u.length>1)break;var y=W(f,this.emit.bind(this),{allowMultipleAds:l,followAdditionalWrappers:c});y.ad?(u.push(y.ad),this.emit("VAST-ad-parsed",{type:y.type,url:o,wrapperDepth:s,adIndex:u.length-1,vastVersion:p})):this.trackVastError(this.getErrorURLTemplates(),{ERRORCODE:101})}}return u}},{key:"parse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.url,i=void 0===n?null:n,r=t.resolveAll,o=void 0===r||r,a=t.wrapperSequence,s=void 0===a?null:a,l=t.previousUrl,c=void 0===l?null:l,u=t.wrapperDepth,d=void 0===u?0:u,p=t.isRootVAST,h=void 0!==p&&p,f=t.followAdditionalWrappers,v=t.allowMultipleAds,y=[];this.vastVersion&&parseFloat(this.vastVersion)<3&&h&&(v=!0);try{y=this.parseVastXml(e,{isRootVAST:h,url:i,wrapperDepth:d,allowMultipleAds:v,followAdditionalWrappers:f})}catch(e){return Promise.reject(e)}return 1===y.length&&null!=s&&(y[0].sequence=s),!1===o&&(this.remainingAds=O.splitVAST(y),y=this.remainingAds.shift()),this.resolveAds(y,{wrapperDepth:d,previousUrl:c,url:i})}},{key:"resolveAds",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0,i=n.wrapperDepth,r=n.previousUrl,o=n.url,a=[];return r=o,t.forEach((function(t){var n=e.resolveWrappers(t,i,r);a.push(n)})),Promise.all(a).then((function(t){var n=R.flatten(t);if(!n&&e.remainingAds.length>0){var a=e.remainingAds.shift();return e.resolveAds(a,{wrapperDepth:i,previousUrl:r,url:o})}return n}))}},{key:"resolveWrappers",value:function(e,t,n){var i=this;return new Promise((function(r){var o;if(t++,!e.nextWrapperURL)return delete e.nextWrapperURL,r(e);if(t>=i.maxWrapperDepth||-1!==i.parentURLs.indexOf(e.nextWrapperURL))return e.errorCode=302,delete e.nextWrapperURL,r(e);e.nextWrapperURL=O.resolveVastAdTagURI(e.nextWrapperURL,n),i.URLTemplateFilters.forEach((function(t){e.nextWrapperURL=t(e.nextWrapperURL)}));var a=null!==(o=i.parsingOptions.allowMultipleAds)&&void 0!==o?o:e.allowMultipleAds,s=e.sequence;i.fetchVAST(e.nextWrapperURL,t,n,e).then((function(o){return i.parse(o,{url:e.nextWrapperURL,previousUrl:n,wrapperSequence:s,wrapperDepth:t,followAdditionalWrappers:e.followAdditionalWrappers,allowMultipleAds:a}).then((function(t){if(delete e.nextWrapperURL,0===t.length)return e.creatives=[],r(e);t.forEach((function(t){t&&O.mergeWrapperAdData(t,e)})),r(t)}))})).catch((function(t){e.errorCode=301,e.errorMessage=t.message,r(e)}))}))}},{key:"completeWrapperResolving",value:function(e){if(0===e.ads.length)this.trackVastError(e.errorURLTemplates,{ERRORCODE:303});else for(var t=e.ads.length-1;t>=0;t--){var n=e.ads[t];(n.errorCode||0===n.creatives.length)&&(this.trackVastError(n.errorURLTemplates.concat(e.errorURLTemplates),{ERRORCODE:n.errorCode||303},{ERRORMESSAGE:n.errorMessage||""},{extensions:n.extensions},{system:n.system}),e.ads.splice(t,1))}}}]),n}(Y),se=null,le={data:{},length:0,getItem:function(e){return this.data[e]},setItem:function(e,t){this.data[e]=t,this.length=Object.keys(this.data).length},removeItem:function(e){delete this.data[e],this.length=Object.keys(this.data).length},clear:function(){this.data={},this.length=0}},ce=function(){function e(){r(this,e),this.storage=this.initStorage()}return a(e,[{key:"initStorage",value:function(){if(se)return se;try{se="undefined"!=typeof window&&null!==window?window.localStorage||window.sessionStorage:null}catch(e){se=null}return se&&!this.isStorageDisabled(se)||(se=le).clear(),se}},{key:"isStorageDisabled",value:function(e){var t="__VASTStorage__";try{if(e.setItem(t,t),e.getItem(t)!==t)return e.removeItem(t),!0}catch(e){return!0}return e.removeItem(t),!1}},{key:"getItem",value:function(e){return this.storage.getItem(e)}},{key:"setItem",value:function(e,t){return this.storage.setItem(e,t)}},{key:"removeItem",value:function(e){return this.storage.removeItem(e)}},{key:"clear",value:function(){return this.storage.clear()}}]),e}(),ue=function(){function e(t,n,i){r(this,e),this.cappingFreeLunch=t||0,this.cappingMinimumTimeInterval=n||0,this.defaultOptions={withCredentials:!1,timeout:0},this.vastParser=new ae,this.storage=i||new ce,void 0===this.lastSuccessfulAd&&(this.lastSuccessfulAd=0),void 0===this.totalCalls&&(this.totalCalls=0),void 0===this.totalCallsTimeout&&(this.totalCallsTimeout=0)}return a(e,[{key:"getParser",value:function(){return this.vastParser}},{key:"lastSuccessfulAd",get:function(){return this.storage.getItem("vast-client-last-successful-ad")},set:function(e){this.storage.setItem("vast-client-last-successful-ad",e)}},{key:"totalCalls",get:function(){return this.storage.getItem("vast-client-total-calls")},set:function(e){this.storage.setItem("vast-client-total-calls",e)}},{key:"totalCallsTimeout",get:function(){return this.storage.getItem("vast-client-total-calls-timeout")},set:function(e){this.storage.setItem("vast-client-total-calls-timeout",e)}},{key:"hasRemainingAds",value:function(){return this.vastParser.remainingAds.length>0}},{key:"getNextAds",value:function(e){return this.vastParser.getRemainingAds(e)}},{key:"get",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=Date.now();return(n=Object.assign({},this.defaultOptions,n)).hasOwnProperty("resolveAll")||(n.resolveAll=!1),this.totalCallsTimeout<i?(this.totalCalls=1,this.totalCallsTimeout=i+36e5):this.totalCalls++,new Promise((function(r,o){if(t.cappingFreeLunch>=t.totalCalls)return o(new Error("VAST call canceled – FreeLunch capping not reached yet ".concat(t.totalCalls,"/").concat(t.cappingFreeLunch)));var a=i-t.lastSuccessfulAd;if(a<0)t.lastSuccessfulAd=0;else if(a<t.cappingMinimumTimeInterval)return o(new Error("VAST call canceled – (".concat(t.cappingMinimumTimeInterval,")ms minimum interval reached")));t.vastParser.getAndParseVAST(e,n).then((function(e){return r(e)})).catch((function(e){return o(e)}))}))}}]),e}(),de=function(e){l(o,e);var t=p(o);function o(e,n,i){var a,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;for(var l in r(this,o),(a=t.call(this)).ad=n,a.creative=i,a.variation=s,a.muted=!1,a.impressed=!1,a.skippable=!1,a.trackingEvents={},a.lastPercentage=0,a._alreadyTriggeredQuartiles={},a.emitAlwaysEvents=["creativeView","start","firstQuartile","midpoint","thirdQuartile","complete","resume","pause","rewind","skip","closeLinear","close"],a.creative.trackingEvents){var c=a.creative.trackingEvents[l];a.trackingEvents[l]=c.slice(0)}return P(a.creative)?a._initLinearTracking():a._initVariationTracking(),e&&a.on("start",(function(){e.lastSuccessfulAd=Date.now()})),a}return a(o,[{key:"_initLinearTracking",value:function(){this.linear=!0,this.skipDelay=this.creative.skipDelay,this.setDuration(this.creative.duration),this.clickThroughURLTemplate=this.creative.videoClickThroughURLTemplate,this.clickTrackingURLTemplates=this.creative.videoClickTrackingURLTemplates}},{key:"_initVariationTracking",value:function(){if(this.linear=!1,this.skipDelay=-1,this.variation){for(var e in this.variation.trackingEvents){var t=this.variation.trackingEvents[e];this.trackingEvents[e]?this.trackingEvents[e]=this.trackingEvents[e].concat(t.slice(0)):this.trackingEvents[e]=t.slice(0)}"nonLinearAd"===this.variation.adType?(this.clickThroughURLTemplate=this.variation.nonlinearClickThroughURLTemplate,this.clickTrackingURLTemplates=this.variation.nonlinearClickTrackingURLTemplates,this.setDuration(this.variation.minSuggestedDuration)):function(e){return"companionAd"===e.adType}(this.variation)&&(this.clickThroughURLTemplate=this.variation.companionClickThroughURLTemplate,this.clickTrackingURLTemplates=this.variation.companionClickTrackingURLTemplates)}}},{key:"setDuration",value:function(e){R.isValidTimeValue(e)&&(this.assetDuration=e,this.quartiles={firstQuartile:Math.round(25*this.assetDuration)/100,midpoint:Math.round(50*this.assetDuration)/100,thirdQuartile:Math.round(75*this.assetDuration)/100})}},{key:"setProgress",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(R.isValidTimeValue(e)&&"object"===i(n)){var r=this.skipDelay||-1;if(-1===r||this.skippable||(r>e?this.emit("skip-countdown",r-e):(this.skippable=!0,this.emit("skip-countdown",0))),this.assetDuration>0){var o=Math.round(e/this.assetDuration*100),a=[];if(e>0){a.push("start");for(var s=this.lastPercentage;s<o;s++)a.push("progress-".concat(s+1,"%"));for(var l in a.push("progress-".concat(Math.round(e))),this.quartiles)this.isQuartileReached(l,this.quartiles[l],e)&&(a.push(l),this._alreadyTriggeredQuartiles[l]=!0);this.lastPercentage=o}a.forEach((function(e){t.track(e,{macros:n,once:!0})})),e<this.progress&&this.track("rewind",{macros:n})}this.progress=e}}},{key:"isQuartileReached",value:function(e,t,n){var i=!1;return t<=n&&!this._alreadyTriggeredQuartiles[e]&&(i=!0),i}},{key:"setMuted",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"boolean"==typeof e&&"object"===i(t)&&(this.muted!==e&&this.track(e?"mute":"unmute",{macros:t}),this.muted=e)}},{key:"setPaused",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"boolean"==typeof e&&"object"===i(t)&&(this.paused!==e&&this.track(e?"pause":"resume",{macros:t}),this.paused=e)}},{key:"setFullscreen",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"boolean"==typeof e&&"object"===i(t)&&(this.fullscreen!==e&&this.track(e?"fullscreen":"exitFullscreen",{macros:t}),this.fullscreen=e)}},{key:"setExpand",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"boolean"==typeof e&&"object"===i(t)&&(this.expanded!==e&&(this.track(e?"expand":"collapse",{macros:t}),this.track(e?"playerExpand":"playerCollapse",{macros:t})),this.expanded=e)}},{key:"setSkipDelay",value:function(e){R.isValidTimeValue(e)&&(this.skipDelay=e)}},{key:"trackImpression",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===i(e)&&(this.impressed||(this.impressed=!0,this.trackURLs(this.ad.impressionURLTemplates,e),this.track("creativeView",{macros:e})))}},{key:"error",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"object"===i(e)&&"boolean"==typeof t&&this.trackURLs(this.ad.errorURLTemplates,e,{isCustomCode:t})}},{key:"errorWithCode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"string"==typeof e&&"boolean"==typeof t&&(this.error({ERRORCODE:e},t),console.log("The method errorWithCode is deprecated, please use vast tracker error method instead"))}},{key:"complete",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===i(e)&&this.track("complete",{macros:e})}},{key:"notUsed",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===i(e)&&(this.track("notUsed",{macros:e}),this.trackingEvents=[])}},{key:"otherAdInteraction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===i(e)&&this.track("otherAdInteraction",{macros:e})}},{key:"acceptInvitation",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===i(e)&&this.track("acceptInvitation",{macros:e})}},{key:"adExpand",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===i(e)&&this.track("adExpand",{macros:e})}},{key:"adCollapse",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===i(e)&&this.track("adCollapse",{macros:e})}},{key:"minimize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===i(e)&&this.track("minimize",{macros:e})}},{key:"verificationNotExecuted",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"==typeof e&&"object"===i(t)){if(!this.ad||!this.ad.adVerifications||!this.ad.adVerifications.length)throw new Error("No adVerifications provided");if(!e)throw new Error("No vendor provided, unable to find associated verificationNotExecuted");var n=this.ad.adVerifications.find((function(t){return t.vendor===e}));if(!n)throw new Error("No associated verification element found for vendor: ".concat(e));var r=n.trackingEvents;if(r&&r.verificationNotExecuted){var o=r.verificationNotExecuted;this.trackURLs(o,t),this.emit("verificationNotExecuted",{trackingURLTemplates:o})}}}},{key:"overlayViewDuration",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"string"==typeof e&&"object"===i(t)&&(t.ADPLAYHEAD=e,this.track("overlayViewDuration",{macros:t}))}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===i(e)&&this.track(this.linear?"closeLinear":"close",{macros:e})}},{key:"skip",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===i(e)&&this.track("skip",{macros:e})}},{key:"load",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===i(e)&&this.track("loaded",{macros:e})}},{key:"click",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((null===e||"string"==typeof e)&&"object"===i(t)){this.clickTrackingURLTemplates&&this.clickTrackingURLTemplates.length&&this.trackURLs(this.clickTrackingURLTemplates,t);var r=this.clickThroughURLTemplate||e,o=n({},t);if(r){this.progress&&(o.ADPLAYHEAD=this.progressFormatted());var a=R.resolveURLTemplates([r],o)[0];this.emit("clickthrough",a)}}}},{key:"track",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.macros,r=void 0===n?{}:n,o=t.once,a=void 0!==o&&o;if("object"===i(r)){"closeLinear"===e&&!this.trackingEvents[e]&&this.trackingEvents.close&&(e="close");var s=this.trackingEvents[e],l=this.emitAlwaysEvents.indexOf(e)>-1;s?(this.emit(e,{trackingURLTemplates:s}),this.trackURLs(s,r)):l&&this.emit(e,null),a&&(delete this.trackingEvents[e],l&&this.emitAlwaysEvents.splice(this.emitAlwaysEvents.indexOf(e),1))}}},{key:"trackURLs",value:function(e){var t,i,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=n({},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});this.linear&&(this.creative&&this.creative.mediaFiles&&this.creative.mediaFiles[0]&&this.creative.mediaFiles[0].fileURL&&(o.ASSETURI=this.creative.mediaFiles[0].fileURL),this.progress&&(o.ADPLAYHEAD=this.progressFormatted())),null!==(t=this.creative)&&void 0!==t&&null!==(i=t.universalAdIds)&&void 0!==i&&i.length&&(o.UNIVERSALADID=this.creative.universalAdIds.map((function(e){return e.idRegistry.concat(" ",e.value)})).join(",")),this.ad&&(this.ad.sequence&&(o.PODSEQUENCE=this.ad.sequence),this.ad.adType&&(o.ADTYPE=this.ad.adType),this.ad.adServingId&&(o.ADSERVINGID=this.ad.adServingId),this.ad.categories&&this.ad.categories.length&&(o.ADCATEGORIES=this.ad.categories.map((function(e){return e.value})).join(",")),this.ad.blockedAdCategories&&this.ad.blockedAdCategories.length&&(o.BLOCKEDADCATEGORIES=this.ad.blockedAdCategories)),R.track(e,o,r)}},{key:"convertToTimecode",value:function(e){if(!R.isValidTimeValue(e))return"";var t=1e3*e,n=Math.floor(t/36e5),i=Math.floor(t/6e4%60),r=Math.floor(t/1e3%60),o=Math.floor(t%1e3);return"".concat(R.addLeadingZeros(n,2),":").concat(R.addLeadingZeros(i,2),":").concat(R.addLeadingZeros(r,2),".").concat(R.addLeadingZeros(o,3))}},{key:"progressFormatted",value:function(){return this.convertToTimecode(this.progress)}}]),o}(Y);e.VASTClient=ue,e.VASTParser=ae,e.VASTTracker=de,Object.defineProperty(e,"__esModule",{value:!0})}(t)}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,n),o.exports}n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};(()=>{"use strict";n.r(i),n.d(i,{FORMAT:()=>R,VPAID_EVENTS:()=>L,init:()=>Tn,version:()=>g});var e=n(495);function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function r(e,n,i){return(n=function(e){var n=function(e,n){if("object"!==t(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,n||"default");if("object"!==t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"===t(n)?n:String(n)}(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function o(e){var t=null,n=[];return window.location.search.substring(1).split("&").forEach((function(i){(n=i.split("="))[0].toLowerCase()===e.toLowerCase()&&(t=decodeURIComponent(n[1]))})),t}function a(e,t){var n=t.getBoundingClientRect(),i=e.getBoundingClientRect();return{width:i.width,height:i.height,top:i.top-n.top,right:i.right-n.right,bottom:i.bottom-n.bottom,left:i.left-n.left}}var s=-1;function l(e){var t=function t(){window.clearTimeout(s),s=window.setTimeout((function(){e(),window.removeEventListener("scroll",t)}),500)};s=window.setTimeout((function(){e(),window.removeEventListener("scroll",t)}),1e3),window.addEventListener("scroll",t)}function c(e){var t=null,n=window.innerHeight;return null==e||e.forEach((function(e){var i=e.getBoundingClientRect(),r=i.top,o=i.height,a=Math.abs(r+o/2-window.innerHeight/2);a<n&&(n=a,t=e)})),t}function u(e,t,n){try{t(e),!n(e)&&e.parentElement&&u(e.parentElement,t,n)}catch(e){}}function d(e,t,n){try{t(e),e!==n&&e.parentElement&&1===e.parentElement.childElementCount&&d(e.parentElement,t,n)}catch(e){}}function p(e){var t=window;try{for(e(t);t.parent!==t&&t.parent.document.location.href.toString();)e(t=t.parent)}catch(e){}}function h(){var e=window;return p((function(t){e=t})),e}var f=function(){try{return window.self!==window.top}catch(e){return!0}};function v(e){var n,i;if(f())if(function(){try{return f()&&"string"!=typeof window.top.document.location.href.toString()}catch(e){return!0}}()){var o=(p((function(e){var t;i||(i=e.sfAPI||(null===(t=e.$sf)||void 0===t?void 0:t.ext))})),i);if(o){switch(e){case"cmp":o.cmp&&(n=function(e,t,n){o.register(300,250,(function(e,t){"cmpReturn"===e&&n(t,t.success)})),o.cmp(e)});break;case"uspapi":n=window.__uspapi;break;case"tcfapi":n=window.__tcfapi}if(n)return n}p((function(i){var o,a=i;try{o=(a=a.parent).frames["__".concat(e,"Locator")]}catch(e){}if(!n&&o){var s=a;n=function(n,i,o){var a="".concat(Math.random()),l=r({},"__".concat(e,"Call"),{command:n,parameter:i,callId:a});s.postMessage(l,"*"),window.addEventListener("message",(function(n){var i;try{i="string"==typeof n.data?JSON.parse(n.data):n.data}catch(e){}if("object"===t(i)){var r=i["__".concat(e,"Return")];r&&a===r.callId&&o(r.returnValue,r.success)}}))}}}))}else p((function(t){n=n||t["__".concat(e)]}));else n=window["__".concat(e)];return n}function y(e,t){var n=v("tcfapi"),i=v("cmp"),r=v("uspapi"),o={};if(n||i||r||t)if(n||i||r){var a=!1,s=!1,l=!1,c=!1,u=function(){!c&&(n&&a||!n)&&(i&&s||!i)&&(r&&l||!r)&&(c=!0,e(o))};setTimeout((function(){s=!0,l=!0,a=!0,u()}),500),n&&(o.gdpr=!0,o.gdpr_consent=!1,n("getTCData",2,(function(e){e&&(o.gdpr="boolean"==typeof e.gdprApplies?e.gdprApplies:null,o.gdpr_consent_string=e.tcString,delete o.gdpr_consent,a=!0,u())}))),i&&(o.gdpr=!0,o.gdpr_consent=!1,i("getConsentData",null,(function(e){var t=e;t&&(t=t.VendorConsentData||t,o.gdpr="boolean"==typeof t.gdprApplies?t.gdprApplies:null,o.gdpr_consent_string=t.consentData,delete o.gdpr_consent,s=!0,u())}))),r&&r("getUSPData",null,(function(e,t){var n=e;t&&n&&(n=n.VendorConsentData||n,o.usp_consent_string=n.uspString),l=!0,u()}))}else e(o);else setTimeout((function(){y(e,!0)}),500)}var m,g="1.0.0",b="prod";switch(b){case"preprod":m="https://static-preprod.retail-spot.io/";break;case"prod":m="https://static.retail-spot.io/";break;default:m="http://localhost:3000/dist/"}var A=m,w={WARN:"warn",ERROR:"error",DEFAULT:"log"};function k(){for(var e,t=w.DEFAULT,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];if([w.WARN,w.ERROR,w.DEFAULT].includes(i[0])&&(t=i.shift()),t!==w.DEFAULT||"true"===o("rsp_debug")){var a="padding:2px 6px;border-radius:8px;background-color:#1a2691;color:white";(e=console)[t].apply(e,["%cRetailSpot",a,i.shift()].concat(i))}}k("env : ".concat(b)),k("Script version: ".concat(g));var T="video",E="native",R={AUTO:"auto",AUTO_NO_SLIDER:"autoNoSlider",SLIDER:"slider",INTEXT:"intext",INGRID:"ingrid"},S={closeButton:!0,soundButton:!0,height:225,width:400},O="aside-left",C="aside-right",P={height:null,width:null,closeButton:!1,enlargeVideo:!1,ingridSize:1,hideNext:!1,sponsoredAlign:"bottom",sponsoredLabel:"Annonce",soundButton:!0,videoBackground:"transparent",videoFit:"",videoPosition:O},x={width:null,height:null,closeButton:!1,enlargeVideo:!1,ingridSize:1,hideNext:!1,soundButton:!0,videoBackground:"transparent",videoFit:""},L={AdStarted:"AdStarted",AdStopped:"AdStopped",AdSkipped:"AdSkipped",AdLoaded:"AdLoaded",AdLinearChange:"AdLinearChange",AdSizeChange:"AdSizeChange",AdExpandedChange:"AdExpandedChange",AdSkippableStateChange:"AdSkippableStateChange",AdDurationChange:"AdDurationChange",AdRemainingTimeChange:"AdRemainingTimeChange",AdVolumeChange:"AdVolumeChange",AdImpression:"AdImpression",AdClickThru:"AdClickThru",AdInteraction:"AdInteraction",AdVideoStart:"AdVideoStart",AdVideoFirstQuartile:"AdVideoFirstQuartile",AdVideoMidpoint:"AdVideoMidpoint",AdVideoThirdQuartile:"AdVideoThirdQuartile",AdVideoComplete:"AdVideoComplete",AdUserAcceptInvitation:"AdUserAcceptInvitation",AdUserMinimize:"AdUserMinimize",AdUserClose:"AdUserClose",AdPaused:"AdPaused",AdPlaying:"AdPlaying",AdError:"AdError",AdLog:"AdLog",AdProgress:"AdProgress"};function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function N(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(r=i.key,o=void 0,o=function(e,t){if("object"!==I(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==I(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===I(o)?o:String(o)),i)}var r,o}var j=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.video=t,this.adContainer=n,this.elapsed=0,this.duration=-1,this.hasCompletedOnce=!1,this.listeners={},this.sentEvents=[]}var t,n,i;return t=e,n=[{key:"handshakeVersion",value:function(){return"2.0"}},{key:"initAd",value:function(){throw new Error("initAd not implemented")}},{key:"startAd",value:function(){this.video.style.display="",this.adContainer.style.display=""}},{key:"stopAd",value:function(){throw new Error("stopAd not implemented")}},{key:"skipAd",value:function(){throw new Error("skipAd not implemented")}},{key:"pauseAd",value:function(){throw new Error("pauseAd not implemented")}},{key:"resumeAd",value:function(){throw new Error("resumeAd not implemented")}},{key:"getRemainingTime",value:function(){return this.duration-this.elapsed}},{key:"mute",value:function(e){throw new Error("mute not implemented")}},{key:"expandAd",value:function(){throw new Error("expandAd not implemented")}},{key:"collapseAd",value:function(){throw new Error("collapseAd not implemented")}},{key:"getAdVolume",value:function(){throw new Error("getAdVolume not implemented")}},{key:"getAdDuration",value:function(){throw new Error("getAdDuration not implemented")}},{key:"getAdRemainingTime",value:function(){throw new Error("getAdRemainingTime not implemented")}},{key:"getAdElapsedTime",value:function(){return this.getAdDuration()-this.getAdRemainingTime()}},{key:"getAdProgress",value:function(){return Math.round(100*(this.getAdElapsedTime()/this.getAdDuration()+Number.EPSILON))}},{key:"resizeAd",value:function(){}},{key:"subscribe",value:function(e,t){if(this.listeners[t]||(this.listeners[t]=[]),"function"!=typeof e)throw new Error("Callback is not a function for event: ".concat(t));this.listeners[t].push(e)}},{key:"unsubscribe",value:function(e,t){if(this.listeners[t]){var n=this.listeners[t].indexOf(e);-1!==n&&this.listeners[t].splice(n,1)}}},{key:"triggerEvent",value:function(){for(var e,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=n.shift();null===(e=this.listeners[r])||void 0===e||e.forEach((function(e){e.apply(void 0,n)})),this.sentEvents.push(r)}},{key:"triggerOnce",value:function(){var e=arguments.length<=0?void 0:arguments[0];this.sentEvents.includes(e)||this.triggerEvent.apply(this,arguments)}}],n&&N(t.prototype,n),i&&N(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}function U(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function V(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(r=i.key,o=void 0,o=function(e,t){if("object"!==D(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==D(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===D(o)?o:String(o)),i)}var r,o}function _(e,t){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_(e,t)}function B(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=F(e);if(t){var r=F(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return M(this,n)}}function M(e,t){if(t&&("object"===D(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function F(e){return F=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},F(e)}var W=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_(e,t)}(o,e);var t,n,i,r=B(o);function o(){var e;U(this,o);for(var t=null,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return i[0]&&o.checkVPAIDInterface(i[0])&&(t=i.shift()),(e=r.call.apply(r,[this].concat(i))).id="VPAIDWrapper",t&&e.setVPAIDCreative(t),e}return t=o,n=[{key:"setVPAIDCreative",value:function(e){this.creative=e,o.checkVPAIDInterface(e)?this.setCallbacksForCreative():k(w.ERROR,"VPAIDCreative doesn't conform to the VPAID spec")}},{key:"setCallbacksForCreative",value:function(){var e=this,t={AdStarted:this.onAdStarted,AdStopped:this.onAdStopped,AdSkipped:this.onAdSkipped,AdLoaded:this.onAdLoaded,AdLinearChange:this.onAdLinearChange,AdSizeChange:this.onAdSizeChange,AdExpandedChange:this.onAdExpandedChange,AdSkippableStateChange:this.onAdSkippableStateChange,AdDurationChange:this.onAdDurationChange,AdRemainingTimeChange:this.onAdRemainingTimeChange,AdVolumeChange:this.onAdVolumeChange,AdImpression:this.onAdImpression,AdClickThru:this.onAdClickThru,AdInteraction:this.onAdInteraction,AdVideoStart:this.onAdVideoStart,AdVideoFirstQuartile:this.onAdVideoFirstQuartile,AdVideoMidpoint:this.onAdVideoMidpoint,AdVideoThirdQuartile:this.onAdVideoThirdQuartile,AdVideoComplete:this.onAdVideoComplete,AdUserAcceptInvitation:this.onAdUserAcceptInvitation,AdUserMinimize:this.onAdUserMinimize,AdUserClose:this.onAdUserClose,AdPaused:this.onAdPaused,AdPlaying:this.onAdPlaying,AdError:this.onAdError,AdLog:this.onAdLog,AdProgress:this.onAdProgress};Object.keys(t).forEach((function(n){e.creative.subscribe(t[n].bind(e),n,e)}))}},{key:"initAd",value:function(e,t,n,i,r,o){this.playerWidth=e,this.playerHeight=t,this.creative.initAd(e,t,n,i,r,o)}},{key:"getInnerCreative",value:function(){var e;return"function"==typeof(null===(e=this.creative)||void 0===e?void 0:e.getInnerCreative)?this.creative.getInnerCreative():this}},{key:"onAdPaused",value:function(){this.log("onAdPaused"),this.triggerEvent(L.AdPaused)}},{key:"onAdPlaying",value:function(){this.log("onAdPlaying"),this.triggerEvent(L.AdPlaying)}},{key:"onAdError",value:function(e){k("onAdError: ".concat(e)),this.triggerEvent(L.AdError,e)}},{key:"onAdLog",value:function(e){this.log("onAdLog: ".concat(e)),this.triggerEvent(L.AdLog,e)}},{key:"onAdProgress",value:function(e){this.log("onAdProgress: ".concat(e)),this.triggerEvent(L.AdProgress,e)}},{key:"onAdUserAcceptInvitation",value:function(){this.log("onAdUserAcceptInvitation"),this.triggerEvent(L.AdUserAcceptInvitation)}},{key:"onAdUserMinimize",value:function(){this.log("onAdUserMinimize"),this.triggerEvent(L.AdUserMinimize)}},{key:"onAdUserClose",value:function(){this.log("onAdUserClose"),this.triggerEvent(L.AdUserClose)}},{key:"onAdSkippableStateChange",value:function(){this.log("Ad Skippable State Changed to: ".concat(this.creative.getAdSkippableState())),this.triggerEvent(L.AdSkippableStateChange)}},{key:"onAdExpandedChange",value:function(){this.log("Ad Expanded Changed to: ".concat(this.creative.getAdExpanded())),this.triggerEvent(L.AdExpandedChange)}},{key:"getAdExpanded",value:function(){return this.log("getAdExpanded"),this.creative.getAdExpanded()}},{key:"getAdSkippableState",value:function(){return this.log("getAdSkippableState"),this.creative.getAdSkippableState()}},{key:"onAdSizeChange",value:function(){this.log("Ad size changed to: w=".concat(this.creative.getAdWidth()," h =").concat(this.creative.getAdHeight()));for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.triggerEvent.apply(this,[L.AdSizeChange].concat(t))}},{key:"onAdDurationChange",value:function(){this.log("Ad Duration Changed to: ".concat(this.creative.getAdDuration())),this.duration=this.getAdDuration();for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.triggerEvent.apply(this,[L.AdDurationChange].concat(t))}},{key:"onAdRemainingTimeChange",value:function(){k("Ad Remaining Time Changed to: ".concat(this.creative.getAdRemainingTime()));for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.triggerEvent.apply(this,[L.AdRemainingTimeChange].concat(t))}},{key:"getAdRemainingTime",value:function(){return this.creative.getAdRemainingTime()}},{key:"getAdDuration",value:function(){return this.creative.getAdDuration()}},{key:"onAdImpression",value:function(){this.log("Ad Impression"),this.triggerEvent(L.AdImpression)}},{key:"onAdClickThru",value:function(e,t,n){this.log("Clickthrough portion of the ad was clicked"),this.triggerEvent(L.AdClickThru)}},{key:"onAdInteraction",value:function(e){this.log("A non-clickthrough event has occured"),this.triggerEvent(L.AdInteraction)}},{key:"onAdVideoStart",value:function(){this.log("Video 0% completed"),this.triggerEvent(L.AdVideoStart)}},{key:"onAdVideoFirstQuartile",value:function(){this.log("Video 25% completed"),this.triggerEvent(L.AdVideoFirstQuartile)}},{key:"onAdVideoMidpoint",value:function(){this.log("Video 50% completed"),this.triggerEvent(L.AdVideoMidpoint)}},{key:"onAdVideoThirdQuartile",value:function(){this.log("Video 75% completed"),this.triggerEvent(L.AdVideoThirdQuartile)}},{key:"onAdVideoComplete",value:function(){this.log("Video 100% completed"),this.triggerEvent(L.AdVideoComplete)}},{key:"onAdLinearChange",value:function(){this.log("Ad linear has changed: ".concat(this.creative.getAdLinear()));for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.triggerEvent.apply(this,[L.AdLinearChange].concat(t))}},{key:"getAdLinear",value:function(){return this.log("getAdLinear"),this.creative.getAdLinear()}},{key:"startAd",value:function(){this.log("startAd"),this.creative.startAd()}},{key:"onAdLoaded",value:function(){this.log("Ad has been loaded"),this.triggerEvent(L.AdLoaded)}},{key:"onAdStarted",value:function(){this.log("Ad has started"),this.triggerEvent(L.AdStarted)}},{key:"stopAd",value:function(){this.creative.stopAd()}},{key:"onAdStopped",value:function(){this.log("Ad has stopped"),this.triggerEvent(L.AdStopped)}},{key:"onAdSkipped",value:function(){this.log("Ad was skipped"),this.triggerEvent(L.AdSkipped)}},{key:"setAdVolume",value:function(e){this.creative.setAdVolume(e)}},{key:"getAdVolume",value:function(){return this.creative.getAdVolume()}},{key:"onAdVolumeChange",value:function(){this.log("Ad Volume has changed to - ".concat(this.creative.getAdVolume()));for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.triggerEvent.apply(this,[L.AdVolumeChange].concat(t))}},{key:"resizeAd",value:function(e,t,n){this.creative.resizeAd(e,t,n)}},{key:"pauseAd",value:function(){this.creative.pauseAd()}},{key:"resumeAd",value:function(){this.creative.resumeAd()}},{key:"expandAd",value:function(){this.creative.expandAd()}},{key:"collapseAd",value:function(){this.creative.collapseAd()}},{key:"log",value:function(e){k("[".concat(this.id.substring(0,11),"] \t- ").concat(e))}}],i=[{key:"checkVPAIDInterface",value:function(e){return!!(e.handshakeVersion&&"function"==typeof e.handshakeVersion&&e.initAd&&"function"==typeof e.initAd&&e.startAd&&"function"==typeof e.startAd&&e.stopAd&&"function"==typeof e.stopAd&&e.skipAd&&"function"==typeof e.skipAd&&e.resizeAd&&"function"==typeof e.resizeAd&&e.pauseAd&&"function"==typeof e.pauseAd&&e.resumeAd&&"function"==typeof e.resumeAd&&e.expandAd&&"function"==typeof e.expandAd&&e.collapseAd&&"function"==typeof e.collapseAd&&e.subscribe&&"function"==typeof e.subscribe&&e.unsubscribe&&"function"==typeof e.unsubscribe)}}],n&&V(t.prototype,n),i&&V(t,i),Object.defineProperty(t,"prototype",{writable:!1}),o}(j);function H(e){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},H(e)}function z(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(r=i.key,o=void 0,o=function(e,t){if("object"!==H(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==H(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===H(o)?o:String(o)),i)}var r,o}function q(){return q="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var i=G(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},q.apply(this,arguments)}function G(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=K(e)););return e}function Q(e,t){return Q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Q(e,t)}function X(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=K(e);if(t){var r=K(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Y(this,n)}}function Y(e,t){if(t&&("object"===H(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function K(e){return K=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},K(e)}var Z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Q(e,t)}(o,e);var t,n,i,r=X(o);function o(e,t,n,i){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(a=r.call(this,e,t)).id="VPAIDPlayer",a.adParameters=i,a.mediaFile=n,a.iframe=null,a.adLoaded=!1,a.adPlaying=!1,a.startOnReady=!1,a.hasCompletedOnce=!1,a.eventCallbacks={},a}return t=o,(n=[{key:"initAd",value:function(){var e=this;this.iframe=document.createElement("iframe"),this.iframe.src="about:blank",this.iframe.style.width="100%",this.iframe.style.height="100%",this.iframe.style.display="block",this.iframe.style.opacity="0",this.iframe.style.border="none";var t=document.createElement("script");t.src=this.mediaFile.fileURL,this.iframe.addEventListener("load",(function(){var n=e.iframe.contentWindow.document.body;n.style.margin="0px",n.appendChild(t)})),t.addEventListener("load",(function(){var t=e.iframe.contentWindow.document.body,n=e.adContainer.parentElement.getBoundingClientRect();e.setVPAIDCreative(e.iframe.contentWindow.getVPAIDAd()),q(K(o.prototype),"initAd",e).call(e,n.width,n.height,"normal",e.mediaFile.bitrate,{AdParameters:e.adParameters},{slot:t,videoSlot:e.video,videoSlotCanAutoPlay:!0}),e.mute(!0)})),this.adContainer.append(this.iframe)}},{key:"startAd",value:function(){this.adLoaded?(q(K(o.prototype),"startAd",this).call(this),this.iframe.style.opacity="1",this.creative.startAd()):(this.startOnReady=!0,this.hasCompletedOnce&&this.initAd())}},{key:"stopAd",value:function(){q(K(o.prototype),"stopAd",this).call(this),this.startOnReady=!1,this.adLoaded=!1,this.iframe.style.opacity="0",this.iframe.remove()}},{key:"resumeAd",value:function(){this.creative&&!this.adPlaying&&this.creative.resumeAd()}},{key:"pauseAd",value:function(){this.creative&&this.adPlaying&&this.creative.pauseAd()}},{key:"onAdLoaded",value:function(){q(K(o.prototype),"onAdLoaded",this).call(this),this.adLoaded=!0,this.startOnReady&&this.startAd()}},{key:"onAdPlaying",value:function(){q(K(o.prototype),"onAdPlaying",this).call(this),this.adPlaying=!0}},{key:"onAdPaused",value:function(){q(K(o.prototype),"onAdPaused",this).call(this),this.adPlaying=!1}},{key:"onAdStopped",value:function(){q(K(o.prototype),"onAdStopped",this).call(this),this.adPlaying=!1,this.hasCompletedOnce||(this.hasCompletedOnce=!0)}},{key:"onAdError",value:function(){q(K(o.prototype),"onAdError",this).call(this),this.adPlaying=!1}},{key:"getRemainingTime",value:function(){return this.creative.getAdRemainingTime()}},{key:"getAdDuration",value:function(){return this.creative.getAdDuration()}},{key:"mute",value:function(e){return this.creative.setAdVolume(e?0:100),0===this.creative.getAdVolume()}},{key:"resize",value:function(){var e=this.adContainer.parentElement.getBoundingClientRect();this.creative.resizeAd(e.width,e.height,"normal")}}])&&z(t.prototype,n),i&&z(t,i),Object.defineProperty(t,"prototype",{writable:!1}),o}(W);function $(e){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$(e)}function J(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(r=i.key,o=void 0,o=function(e,t){if("object"!==$(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==$(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===$(o)?o:String(o)),i)}var r,o}function ee(e,t){return ee=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ee(e,t)}function te(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ie(e);if(t){var r=ie(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ne(this,n)}}function ne(e,t){if(t&&("object"===$(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ie(e){return ie=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ie(e)}var re=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ee(e,t)}(o,e);var t,n,i,r=te(o);function o(e,t,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(i=r.call(this,e,t)).id="VideoPlayer",i.mediaFiles=n,i.timers=[],i.lastProgress=0,i.started=!1,i}return t=o,(n=[{key:"initAd",value:function(){var e=this;this.mediaFiles.forEach((function(t){var n=document.createElement("source");n.src=t.fileURL,n.type=t.mimeType,e.video.appendChild(n)})),this.setAdVolume(0),this.addListeners()}},{key:"startAd",value:function(){this.video.isConnected&&this.triggerOnce(L.AdImpression),this.video.play()}},{key:"stopAd",value:function(){this.started=!1,this.video.pause(),this.triggerEvent(L.AdStopped)}},{key:"resumeAd",value:function(){this.video.play()}},{key:"pauseAd",value:function(){this.video.pause()}},{key:"addListeners",value:function(){var e=this;this.video.addEventListener("loadeddata",(function(){})),this.video.addEventListener("durationchange",(function(t){e.duration=t.target.duration,e.triggerEvent(L.AdDurationChange)})),this.video.addEventListener("canplay",(function(){e.triggerEvent(L.AdLoaded),e.video.isConnected&&e.triggerOnce(L.AdImpression)})),this.video.addEventListener("play",(function(){e.started||(e.started=!0,e.triggerEvent(L.AdStarted)),e.triggerEvent(L.AdPlaying)})),this.video.addEventListener("pause",(function(){e.started&&e.triggerEvent(L.AdPaused)})),this.video.addEventListener("ended",(function(){e.triggerEvent(L.AdVideoComplete),e.triggerEvent(L.AdStopped)})),this.video.addEventListener("timeupdate",(function(t){var n=Math.round(e.getAdElapsedTime());n>e.lastProgress&&(e.lastProgress=n,e.triggerEvent(L.AdProgress,n))})),this.video.addEventListener("volumechange",(function(t){e.triggerEvent(L.AdVolumeChange,t.target.volume)})),this.video.addEventListener("error",(function(){e.triggerEvent(L.AdError,"405")}))}},{key:"getAdRemainingTime",value:function(){return this.video.duration-this.video.currentTime}},{key:"getAdDuration",value:function(){return this.video.duration}},{key:"getAdVolume",value:function(){return this.video.volume}},{key:"setAdVolume",value:function(e){0===e?(this.video.volume=0,this.video.muted=!0,this.video.setAttribute("muted","")):(this.video.volume=e,this.video.muted=!1,this.video.removeAttribute("muted"))}}])&&J(t.prototype,n),i&&J(t,i),Object.defineProperty(t,"prototype",{writable:!1}),o}(j);function oe(e){return oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oe(e)}function ae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function se(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(r=i.key,o=void 0,o=function(e,t){if("object"!==oe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==oe(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===oe(o)?o:String(o)),i)}var r,o}function le(e,t,n){return t&&se(e.prototype,t),n&&se(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var ce="viewable",ue="not_viewable",de="mrc_video_viewable",pe=function(){function e(t){ae(this,e),this.callback=t,this.mrc_sent=!1,this.mrc_timeout=-1}return le(e,[{key:"onViewabilityChange",value:function(e,t){var n=this;this.callback(e?ce:ue),this.mrc_sent||(e?-1===this.mrc_timeout&&(this.mrc_timeout=window.setTimeout((function(){n.callback(de,t),n.mrc_sent=!0}),2e3)):this.mrc_timeout>-1&&(window.clearTimeout(this.mrc_timeout),this.mrc_timeout=-1))}}]),e}(),he=new(function(){function e(t){var n=this;ae(this,e),this.registeredElement={},this.observer=new IntersectionObserver((function(e,t){e.forEach((function(e){var t;null===(t=n.registeredElement[e.target.id])||void 0===t||t.onViewabilityChange(e.isIntersecting)}))}),{threshold:.5})}return le(e,[{key:"addListener",value:function(e,t){e.id?(this.registeredElement[e.id]=new pe(t),this.observer.observe(e)):k(w.WARN,"Cannot register viewability without element id.")}}]),e}());function fe(e,t){var n=document.createElement("img");n.setAttribute("style","position:absolute; width:1px; opacity: 0; height:1px; display:block;");var i=n;i.onload=function(){i.parentNode&&"img"===i.tagName&&i.parentNode.removeChild(i),t&&t()},n.src=e}function ve(e){return ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ve(e)}function ye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function me(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(r=i.key,o=void 0,o=function(e,t){if("object"!==ve(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==ve(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===ve(o)?o:String(o)),i)}var r,o}var ge=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;ye(this,e),Object.assign(this,t),this.start=0,n&&this.update(n)}var t,n,i;return t=e,(n=[{key:"update",value:function(e){this.clearTimeouts(),this.endRemaining=e,this.firstRemaining=e/4,this.midRemaining=e/2,this.thirdRemaining=e/4*3}},{key:"clearTimeouts",value:function(){window.clearTimeout(this.endTimerId),window.clearTimeout(this.firstTimerId),window.clearTimeout(this.midTimerId),window.clearTimeout(this.thirdTimerId),this.endTimerId=0,this.firstTimerId=0,this.midTimerId=0,this.thirdTimerId=0}},{key:"pause",value:function(){this.clearTimeouts();var e=Date.now()-this.start;this.firstRemaining-=e,this.midRemaining-=e,this.thirdRemaining-=e,this.endRemaining-=e}},{key:"resume",value:function(){this.endTimerId||(this.start=Date.now(),this.firstRemaining>0&&(this.firstTimerId=window.setTimeout(this.onFirstQuartile,this.firstRemaining)),this.midRemaining>0&&(this.midTimerId=window.setTimeout(this.onMidPoint,this.midRemaining)),this.thirdRemaining>0&&(this.thirdTimerId=window.setTimeout(this.onThirdQuartile,this.thirdRemaining)),this.endRemaining>0&&(this.endTimerId=window.setTimeout(this.onTimerEnd,this.endRemaining)))}}])&&me(t.prototype,n),i&&me(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function be(e){return be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},be(e)}function Ae(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(r=i.key,o=void 0,o=function(e,t){if("object"!==be(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==be(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===be(o)?o:String(o)),i)}var r,o}function we(e,t){return we=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},we(e,t)}function ke(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Oe(e);if(t){var r=Oe(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Te(this,n)}}function Te(e,t){if(t&&("object"===be(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ee(e)}function Ee(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Re(){return Re="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var i=Se(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},Re.apply(this,arguments)}function Se(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Oe(e)););return e}function Oe(e){return Oe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Oe(e)}var Ce=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&we(e,t)}(o,e);var t,n,i,r=ke(o);function o(e,t,n,i){var a,s,l,c,u;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(u=r.call(this,e,t,n)).id="TrackerWrapper",u.tracker=i,u.tracker.on("clickthrough",u.applyClick),n.addEventListener("click",u.onAdClickThru.bind(Ee(u))),n.addEventListener("touch",u.onAdClickThru.bind(Ee(u))),n.style.cursor="pointer",u.adLoaded=!1,u.adPlaying=!1,u.startOnReady=!1,u.hasCompletedOnce=!1,u.mrc_viewable_sent=!1,u.quartileTimer=new ge({onFirstQuartile:function(){Re((a=Ee(u),Oe(o.prototype)),"triggerOnce",a).call(a,L.AdVideoFirstQuartile)},onMidPoint:function(){Re((s=Ee(u),Oe(o.prototype)),"triggerOnce",s).call(s,L.AdVideoMidpoint)},onThirdQuartile:function(){Re((l=Ee(u),Oe(o.prototype)),"triggerOnce",l).call(l,L.AdVideoThirdQuartile)},onTimerEnd:function(){Re((c=Ee(u),Oe(o.prototype)),"triggerOnce",c).call(c,L.AdVideoComplete)}}),u}return t=o,n=[{key:"onAdLoaded",value:function(){this.tracker.emit(L.AdLoaded),Re(Oe(o.prototype),"onAdLoaded",this).call(this)}},{key:"onAdDurationChange",value:function(){Re(Oe(o.prototype),"onAdDurationChange",this).call(this),this.tracker.setDuration(this.duration),this.duration>0&&this.quartileTimer.update(1e3*this.duration)}},{key:"onAdRemainingTimeChange",value:function(){this.handleTimeEvent(L.AdRemainingTimeChange),Re(Oe(o.prototype),"onAdRemainingTimeChange",this).call(this)}},{key:"onAdStarted",value:function(){var e=this;this.handleTimeEvent(L.AdVideoStart),he.addListener(this.adContainer,(function(t){var n;e.mrc_viewable_sent||t===de&&(null===(n=e.tracker.ad.viewableImpression)||void 0===n||n.forEach((function(e){fe(e.viewable)})),e.mrc_viewable_sent=!0),t===ue?e.pauseAd():t===ce&&e.resumeAd()})),this.adPlaying=!0,Re(Oe(o.prototype),"onAdStarted",this).call(this)}},{key:"onAdVideoFirstQuartile",value:function(){this.handleTimeEvent(L.AdVideoFirstQuartile),Re(Oe(o.prototype),"onAdVideoFirstQuartile",this).call(this)}},{key:"onAdVideoMidpoint",value:function(){this.handleTimeEvent(L.AdVideoMidpoint),Re(Oe(o.prototype),"onAdVideoMidpoint",this).call(this)}},{key:"onAdVideoThirdQuartile",value:function(){this.handleTimeEvent(L.AdVideoThirdQuartile),Re(Oe(o.prototype),"onAdVideoThirdQuartile",this).call(this)}},{key:"onAdProgress",value:function(e){this.tracker.setProgress(e),Re(Oe(o.prototype),"onAdProgress",this).call(this,e)}},{key:"handleTimeEvent",value:function(e){this.tracker.setProgress(this.getAdElapsedTime()),this.tracker.emit(e)}},{key:"onAdImpression",value:function(){this.tracker.trackImpression(),Re(Oe(o.prototype),"onAdImpression",this).call(this)}},{key:"onAdPlaying",value:function(){this.adPlaying=!0,this.hasCompletedOnce||this.tracker.setPaused(!1),this.tracker.emit(L.AdPlaying),Re(Oe(o.prototype),"onAdPlaying",this).call(this),this.quartileTimer.resume()}},{key:"onAdPaused",value:function(){this.adPlaying=!1,this.hasCompletedOnce?this.tracker.emit(L.AdPaused):this.tracker.setPaused(!0),Re(Oe(o.prototype),"onAdPaused",this).call(this),this.quartileTimer.pause()}},{key:"onAdStopped",value:function(){var e;this.adPlaying=!1,this.mrc_viewable_sent||null===(e=this.tracker.ad.viewableImpression)||void 0===e||e.forEach((function(e){fe(e.notviewable)})),Re(Oe(o.prototype),"onAdStopped",this).call(this),this.quartileTimer.pause()}},{key:"onAdVideoComplete",value:function(){this.adPlaying=!1,this.hasCompletedOnce?this.tracker.emit(L.AdVideoComplete):(this.tracker.complete(),this.hasCompletedOnce=!0),Re(Oe(o.prototype),"onAdVideoComplete",this).call(this)}},{key:"onAdVolumeChange",value:function(){this.tracker.setMuted(0===this.creative.getAdVolume()),Re(Oe(o.prototype),"onAdVolumeChange",this).call(this)}},{key:"onAdClickThru",value:function(){this.tracker.click(),Re(Oe(o.prototype),"onAdClickThru",this).call(this)}},{key:"applyClick",value:function(e){var t=this;this.hasTriggerred||(this.hasTriggerred=!0,window.open(e,"_blank"),setTimeout((function(){t.hasTriggerred=!1}),50))}},{key:"onAdError",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"900";this.adPlaying=!1,this.tracker.error({ERRORCODE:e}),Re(Oe(o.prototype),"onAdError",this).call(this),this.quartileTimer.pause()}}],n&&Ae(t.prototype,n),i&&Ae(t,i),Object.defineProperty(t,"prototype",{writable:!1}),o}(W);function Pe(e){return Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pe(e)}function xe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(r=i.key,o=void 0,o=function(e,t){if("object"!==Pe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==Pe(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===Pe(o)?o:String(o)),i)}var r,o}function Le(){return Le="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var i=Ie(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},Le.apply(this,arguments)}function Ie(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ue(e)););return e}function Ne(e,t){return Ne=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ne(e,t)}function je(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Ue(e);if(t){var r=Ue(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return De(this,n)}}function De(e,t){if(t&&("object"===Pe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ue(e){return Ue=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ue(e)}var Ve=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ne(e,t)}(o,e);var t,n,i,r=je(o);function o(e,t,n,i){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(a=r.call(this,e,t,n)).id="BaseFormat",a.config=i,a.video=t,a.adContainer=n,a.playerDiv=document.createElement("div"),a.playerDiv.setAttribute("id","rsplayer"),a.playerDiv.style.position="relative",a.playerDiv.style.margin="auto",a.video.volume=0,a.video.style.width="100%",a.video.style.height="100%",a.video.style.position="absolute",a.video.style.top="0px",a.video.style.left="0px",a.video.style.backgroundColor=i.videoBackground||"transparent",i.videoFit&&(a.video.style.objectFit=i.videoFit),a.adContainer.style.width="100%",a.adContainer.style.height="100%",a.adContainer.style.position="absolute",a.adContainer.style.top="0px",a.adContainer.style.left="0px",a.playerDiv.appendChild(a.video),a.playerDiv.appendChild(a.adContainer),window.setTimeout((function(){a.insertPlayer(i.positionSelector,i.target)}),0),a}return t=o,(n=[{key:"insertPlayer",value:function(e,t){(t=t||window.document.querySelector(e))&&t.appendChild(this.playerDiv)}},{key:"initAd",value:function(e,t,n,i,r,a){e&&(this.playerDiv.style.width="".concat(e,"px")),t&&(this.playerDiv.style.height="".concat(t,"px")),Le(Ue(o.prototype),"initAd",this).call(this,e,t,n,i,r,a)}},{key:"resizeAd",value:function(e,t,n){this.playerDiv.style.width="".concat(e,"px"),this.playerDiv.style.height="".concat(t,"px"),Le(Ue(o.prototype),"resizeAd",this).call(this,e,t,n)}},{key:"onAdLoaded",value:function(){Le(Ue(o.prototype),"onAdLoaded",this).call(this),this.startAd()}}])&&xe(t.prototype,n),i&&xe(t,i),Object.defineProperty(t,"prototype",{writable:!1}),o}(W);function _e(e){return function(e){if(Array.isArray(e))return Be(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Be(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Be(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Be(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Me(e){function t(e,t){var n=[],i=-1;return e.forEach((function(e){var r,o,a,s,l=e.getBoundingClientRect();if(l&&!["A","NOSCRIPT","IMG"].includes(e.nodeName)){var c=l.width,u=l.x,d=l.x+l.width;c>t&&c<window.innerWidth-200&&(-1===i&&(i=c),c===i&&u>-20&&d<=window.innerWidth+20&&(r=e,o=r.getBoundingClientRect(),a=window.pageXOffset||document.documentElement.scrollLeft,s=window.pageYOffset||document.documentElement.scrollTop,{top:o.top+s,left:o.left+a,right:o.left+a+o.width,bottom:o.top+s+o.height}).bottom>window.innerHeight/2&&n.push(e))}})),n}function n(e,i){var r,o=i,a=parseInt(window.innerWidth,10)/2,s=Array.from(e.children),l=t(s,a);l.length>1&&(r=o).push.apply(r,_e(l));return s.forEach((function(e){var t=e.getBoundingClientRect().width;e.children.length>0&&t>a&&(o=n(e,o))})),o}return new Promise((function(t,i){var r=n(e||window.document.body,[]);0===r.length&&i(new Error("AutoPositioning: Target Not found.")),l((function(){t(c(r))}))}))}function Fe(e){return Fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fe(e)}function We(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(r=i.key,o=void 0,o=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==Fe(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===Fe(o)?o:String(o)),i)}var r,o}function He(){return He="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var i=ze(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},He.apply(this,arguments)}function ze(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Xe(e)););return e}function qe(e,t){return qe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},qe(e,t)}function Ge(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Xe(e);if(t){var r=Xe(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Qe(this,n)}}function Qe(e,t){if(t&&("object"===Fe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Xe(e){return Xe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Xe(e)}var Ye=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qe(e,t)}(o,e);var t,n,i,r=Ge(o);function o(e,t,n,i){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(a=r.call(this,e,t,n,i)).id="IntextFormat",a.speed=.7,a.animatedDiv=document.createElement("div"),a.animatedDiv.style.overflow="hidden",a.animatedDiv.style.height="0px",a.animatedDiv.style.width="100%",a.animatedDiv.style.transition="height ease ".concat(a.speed,"s"),a.adLoaded=!1,a}return t=o,(n=[{key:"insertPlayer",value:function(e,t){var n=this;Me(window.document.querySelector(e)).then((function(e){var t;k(w.DEBUG,"Autopositioning success : ",e),t=e,n.playerDiv.style.margin="auto",n.animatedDiv.appendChild(n.playerDiv),t.appendChild(n.animatedDiv),n.startAd()})).catch((function(e){k(w.DEBUG,"Autopositioning err : ",e.message)}))}},{key:"initAd",value:function(e,t,n,i,r,a){He(Xe(o.prototype),"initAd",this).call(this,e,t,n,i,r,a)}},{key:"onAdLoaded",value:function(){this.adLoaded=!0,He(Xe(o.prototype),"onAdLoaded",this).call(this)}},{key:"startAd",value:function(){this.animatedDiv.parentElement&&this.adLoaded&&He(Xe(o.prototype),"startAd",this).call(this)}},{key:"onAdStarted",value:function(){He(Xe(o.prototype),"onAdStarted",this).call(this),this.open()}},{key:"open",value:function(){this.animatedDiv.style.height=this.playerDiv.style.height}},{key:"close",value:function(){var e=this;this.animatedDiv.style.height="0px",window.setTimeout((function(){e.animatedDiv.parentElement&&e.animatedDiv.parentElement.removeChild(e.animatedDiv)}),1e3*this.speed)}},{key:"onAdStopped",value:function(){He(Xe(o.prototype),"onAdStopped",this).call(this),this.close()}},{key:"onAdVideoComplete",value:function(){He(Xe(o.prototype),"onAdVideoComplete",this).call(this),this.close()}}])&&We(t.prototype,n),i&&We(t,i),Object.defineProperty(t,"prototype",{writable:!1}),o}(Ve);function Ke(e){return Ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ke(e)}function Ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function $e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(n),!0).forEach((function(t){Je(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Je(e,t,n){return(t=tt(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function et(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,tt(i.key),i)}}function tt(e){var t=function(e,t){if("object"!==Ke(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==Ke(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Ke(t)?t:String(t)}function nt(){return nt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var i=it(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},nt.apply(this,arguments)}function it(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=st(e)););return e}function rt(e,t){return rt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},rt(e,t)}function ot(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=st(e);if(t){var r=st(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return at(this,n)}}function at(e,t){if(t&&("object"===Ke(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function st(e){return st=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},st(e)}var lt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rt(e,t)}(o,e);var t,n,i,r=ot(o);function o(e,t,n,i){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(a=r.call(this,e,t,n,i)).id="SliderFormat",a.vmargin="number"==typeof i.vmargin?i.vmargin:30,a.hmargin="number"==typeof i.hmargin?i.hmargin:30,a.speed=.7,a.playerDiv.style.position="fixed",a.playerDiv.style.zIndex=1e6,a.playerDiv.style.transition="top ease ".concat(a.speed,"s, left ease ").concat(a.speed,"s, right ease ").concat(a.speed,"s, bottom ease ").concat(a.speed,"s"),a.playerDiv.style.boxShadow="rgba(0, 0, 0, 0.7) 0px 0px 20px",a.setPositions(i),a.applyPosition(a.startPosition),a}return t=o,(n=[{key:"insertPlayer",value:function(e){window.document.body.appendChild(this.playerDiv)}},{key:"setPositions",value:function(e){var t,n,i="right";this.vmargin<this.hmargin&&(i="bottom");var r=window.innerHeight-e.height-this.vmargin;(null===(t=e.align)||void 0===t?void 0:t.indexOf("top"))>=0&&(r=this.vmargin,this.vmargin<this.hmargin&&(i="top"));var o,a=window.innerWidth-e.width-this.hmargin;switch((null===(n=e.align)||void 0===n?void 0:n.indexOf("left"))>=0&&(a=this.hmargin,this.vmargin>=this.hmargin&&(i="left")),this.targetPosition={top:"".concat(r,"px"),left:"".concat(a,"px")},e.anim||i){case"top":o={top:"".concat(-e.height,"px")};break;case"left":o={left:"".concat(-e.width,"px")};break;case"bottom":o={top:"".concat(parseInt(e.height,10)+parseInt(window.innerHeight,10),"px")};break;case"right":o={left:"".concat(parseInt(e.width,10)+parseInt(window.innerWidth,10),"px")}}this.startPosition=$e($e({},this.targetPosition),o)}},{key:"applyPosition",value:function(e){var t=this;Object.keys(e).forEach((function(n){t.playerDiv.style[n]=e[n]}))}},{key:"initAd",value:function(e,t,n,i,r,a){nt(st(o.prototype),"initAd",this).call(this,e,t,n,i,r,a)}},{key:"onAdLoaded",value:function(){nt(st(o.prototype),"onAdLoaded",this).call(this),this.applyPosition(this.targetPosition)}},{key:"close",value:function(){var e=this;this.applyPosition(this.startPosition),window.setTimeout((function(){window.document.body.removeChild(e.playerDiv)}),1e3*this.speed)}},{key:"onAdStopped",value:function(){nt(st(o.prototype),"onAdStopped",this).call(this),this.close()}},{key:"onAdVideoComplete",value:function(){nt(st(o.prototype),"onAdVideoComplete",this).call(this),this.close()}}])&&et(t.prototype,n),i&&et(t,i),Object.defineProperty(t,"prototype",{writable:!1}),o}(Ve),ct=new RegExp(["€","$","£","%"].map((function(e){return"\\".concat(e)})).join("|")),ut=null;function dt(e){return ct.test(e)}function pt(e,t,n){if(!e||"A"!==e.nodeName&&"DIV"!==e.nodeName&&"LI"!==e.nodeName&&"ARTICLE"!==e.nodeName)return!1;var i=0,r=0,o=0;try{var a=getComputedStyle(e);i=Math.floor(parseInt(a.width,10)),r=Math.floor(parseInt(a.height,10)),o=Math.floor(e.offsetTop);var s=i>100&&r>100,l=t&&Math.abs(i-t)>10&&n&&Math.abs(r-n)>10;if(!s||l)return!1}catch(e){return!1}return{hasPrice:dt(e.innerText),width:i,height:r,top:o}}function ht(e){if(!ut||e){var t=e?[e]:Array.from(document.querySelectorAll("div:has(> *:nth-child(4)), ul:has(> *:nth-child(4)), section:has(> *:nth-child(4))")),n=null,i=null,r=!1,o=0,a=0;t.length>0&&(i=t.find((function(e){var t;if("absolute"===e.style.position||"fixed"===e.style.position||"none"===e.style.display||null===e.offsetParent)return!1;var i=0,s=0;r=!1;for(var l=[[]],c=l[0],u=0,d=0,p=e.firstElementChild,h=null===(t=p)||void 0===t?void 0:t.offsetTop,f=!1;p&&s<2;)if(p.offsetParent){var v=pt(p,u,d),y=p.getBoundingClientRect();v&&v.hasPrice?(f=!0,y.x>0?r||(r=p):o++,y.x<window.innerWidth&&a++,u=v.width,d=v.height,h!==v.top&&c.length>0&&(c=[],l.push(c),h=v.top),c.push(v),p=p.nextElementSibling,i+=1,s=0):(p=p.nextElementSibling,s+=1)}else p=p.nextElementSibling;return n=l,i>=4&&f})));var s=i;k(w.DEBUG,"Retail tools, Found item grid: ",s),k(w.DEBUG,"Grid: ",n),ut={itemList:s,gridProfile:n,clonedElement:r,startIndex:o,endIndex:a-1}}return ut}function ft(e){return ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ft(e)}function vt(e){return function(e){if(Array.isArray(e))return yt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return yt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return yt(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function mt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(r=i.key,o=void 0,o=function(e,t){if("object"!==ft(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==ft(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===ft(o)?o:String(o)),i)}var r,o}var bt=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];mt(this,e),this.container=t,this.readOnly=i,this.sponsoredAlign=n,this.title=null,this.desc=null,this.ctatext=null,this.sponsoredBy=null,this.price=null,this.img=null,this.brandImg=null,this.sponsoredLabel=null,this.link=null,this.buttonsEls=[],this.textEls=[],this.imgEls=[],this.pricesEls=[],this.descEls=[],this.garbageEls=[],this.aEls=[],this.applyChange((function(){t.onclick=function(e){e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation()}}))}var t,n,i;return t=e,n=[{key:"isImg",value:function(e){return 1===e.children.length&&"svg"===e.children[0].nodeName||"IMG"===e.nodeName||"PICTURE"===e.nodeName||e.style.background.includes("url(")}},{key:"fetchLink",value:function(e){if(this.isLink(e)){this.aEls.push(e);var t=window.getComputedStyle(e);e.area=parseInt(t.width,10)*parseInt(t.height,10)}}},{key:"isLink",value:function(e){return"A"===e.nodeName}},{key:"isText",value:function(e){if(e.canBeIgnored)return!1;var t,n,i=0,r=e.innerText;"INPUT"===e.nodeName&&"button"===e.getAttribute("type")&&(i=null!==(t=null===(n=r=e.value)||void 0===n?void 0:n.length)&&void 0!==t?t:0);var o=Array.from(e.childNodes).filter((function(e){return"svg"!==e.nodeName&&"#comment"!==e.nodeName}));if(1===o.length&&3!==o[0].nodeType)return!1;if(1===e.children.length&&r===e.children[0].innerText)return!1;var a=!1,s=0;if(0===i)for(;s<o.length;){var l,c=o[s];if(3!==c.nodeType&&"SPAN"!==c.nodeName&&"STRONG"!==c.nodeName){i=0;break}i+=(null===(l=c.textContent)||void 0===l?void 0:l.trim().length)||0,s++}if(i>1){var u,d=!0;if(o.forEach((function(e){["SUP","EM","A","STRONG","SVG","svg","#text"].includes(e.nodeName)||e instanceof Element&&window.getComputedStyle(e).display.indexOf("inline")>-1||(d=!1)})),d)e.originalValue=r,o.forEach((function(e){e.canBeIgnored=!0})),this.applyChange((function(){e.innerHTML=r}));else if(e.childNodes.length===e.childElementCount)return!1;a=!0,"SUP"===(null===(u=e.nextSibling)||void 0===u?void 0:u.nodeName)&&(this.applyChange((function(){e.innerHTML+=e.nextSibling.innerText})),e.originalValue=e.innerHTML+e.nextSibling.innerText)}else 1===i&&this.garbageEls.push(e);return a}},{key:"isDesc",value:function(e){return 0!==e.lineHeight&&e.height>=2*e.lineHeight}},{key:"isButton",value:function(e){if("button"===e.getAttribute("type"))return!0;for(var t=!1,n=e;!t&&n.children.length<=1;){var i=window.getComputedStyle(n);t=!i.background.includes("rgba(0, 0, 0, 0)")&&!i.background.includes("url("),n=n.parentElement}return t}},{key:"isPrice",value:function(e){var t=(e.originalValue||e.innerText).replace("dès","").replace("à partir de","").replace("/mois","").replace("en 24 fois","");return t.length<=10&&!Number.isNaN(parseInt(t,10))&&dt(t)}},{key:"isOrContainElements",value:function(e){return this.title&&(this.title===e||e.contains(this.title))||this.desc&&(this.desc===e||e.contains(this.desc))||this.ctatext&&(this.ctatext===e||e.contains(this.ctatext))||this.sponsoredBy&&(this.sponsoredBy===e||e.contains(this.sponsoredBy))||this.price&&(this.price===e||e.contains(this.price))||this.img&&(this.img===e||e.contains(this.img))||this.brandImg&&(this.brandImg===e||e.contains(this.brandImg))||this.sponsoredLabel&&(this.sponsoredLabel===e||e.contains(this.sponsoredLabel))}},{key:"removeLineThrough",value:function(e){var t=this;u(e,(function(e){0===window.getComputedStyle(e).textDecoration.indexOf("line-through")&&t.applyChange((function(){e.style.textDecoration="none"}))}),(function(e){return e===t.container}))}},{key:"applyChange",value:function(e){this.readOnly||e()}},{key:"fetchElements",value:function(){var e=this;this.fetchLink(this.container);var t=this.container.querySelectorAll("*"),n=Array.from(t);n.forEach((function(t){if(t.childNodes.length>1&&t.childNodes.forEach((function(t){"svg"===t.nodeName&&e.applyChange((function(){t.style.visibility="hidden"}))})),"SUP"===t.nodeName&&e.applyChange((function(){t.style.display="none"})),t.offsetParent)if(e.isLink(t)&&0===t.offsetHeight&&e.applyChange((function(){t.style.display="none"})),e.fetchLink(t),e.isText(t)){var n,i=window.getComputedStyle(t);t.fontSize=parseInt(i.fontSize,10),t.lineHeight=parseInt(i.lineHeight,10),t.height=parseInt(i.height,10),t.computedColor=i.color,t.fontWeight=i.fontWeight,e.removeLineThrough(t),t.rotate=null===(n=i.transform)||void 0===n?void 0:n.includes("matrix"),t.isSquare=parseInt(i.width,10)-parseInt(i.height,10)<3,t.rotate||t.isSquare?e.garbageEls.push(t):e.isPrice(t)?e.pricesEls.push(t):e.isButton(t)?e.buttonsEls.push(t):e.isDesc(t)?e.descEls.push(t):e.textEls.push(t)}else if(e.isImg(t)){var r=window.getComputedStyle(t);t.compWidth=r.width,t.compHeight=r.height,t.compBackground=r.background,t.compMargin=r.margin,t.compMarginLeft=r.marginLeft,t.compMarginRight=r.marginRight,t.area=parseInt(r.width,10)*parseInt(r.height,10),e.imgEls.push(t)}else t.childNodes.forEach((function(n){3===n.nodeType&&n.textContent.trim().length>0&&(t.origHeight||(t.origHeight=window.getComputedStyle(t).height),e.applyChange((function(){n.nodeValue=""})))})),t.origHeight&&e.applyChange((function(){t.style.height=t.origHeight}))})),this.aEls.sort((function(e,t){return t.area-e.area})),this.link=this.aEls.shift(),this.imgEls.sort((function(e,t){return t.area-e.area})),this.img=this.imgEls.shift(),this.brandImg=this.imgEls.shift();var i=this.container.offsetHeight,r=function(e,t){if(!e.rotate&&t.rotate)return-1;if(e.rotate&&!t.rotate)return 1;var n=0;return 0==(n=t.fontSize-e.fontSize)&&(n=t.fontWeight-e.fontWeight),0===n&&(n=Math.abs(e.offsetTop-i/2)-Math.abs(t.offsetTop-i/2)),n};if(this.textEls.sort(r),this.title=this.textEls.shift(),this.descEls.length)this.desc=this.descEls[0];else{var o=this.textEls.slice().sort((function(e,t){return t.innerText.trim().length-e.innerText.trim().length})).shift();if((null==o?void 0:o.innerText.trim().length)>16){this.desc=o;var a=this.textEls.indexOf(this.desc);this.textEls.splice(a,1)}}this.sponsoredBy=this.textEls.shift(),this.sponsoredLabel=this.textEls.shift()||this.buttonsEls.shift(),this.buttonsEls.sort(r),this.ctatext=this.buttonsEls.shift(),this.pricesEls.sort((function(e,t){return e.innerText.includes("%")&&!t.innerText.includes("%")?1:!e.innerText.includes("%")&&t.innerText.includes("%")?-1:r(e,t)})),this.price=this.pricesEls.shift(),this.garbageEls=this.garbageEls.concat(n.filter((function(t){return!e.isOrContainElements(t)}))),this.applyChange((function(){e.hideUnused([].concat(vt(e.imgEls),vt(e.textEls),vt(e.pricesEls),vt(e.buttonsEls),vt(e.garbageEls)))})),k(w.DEBUG,"title : ",this.title),k(w.DEBUG,"description : ",this.desc),k(w.DEBUG,"ctaText : ",this.ctatext),k(w.DEBUG,"brand : ",this.sponsoredBy),k(w.DEBUG,"price : ",this.price),k(w.DEBUG,"img : ",this.img),k(w.DEBUG,"brandImg : ",this.brandImg),k(w.DEBUG,"Link : ",this.link)}},{key:"hideUnused",value:function(e){var t=this;e.forEach((function(e){d(e,(function(e){e.style.visibility="hidden"}),t.container)}))}},{key:"scaleWidth",value:function(e){var t=this;if(e>1&&this.img){!this.img.style.height&&this.img.compHeight&&(this.img.style.height=this.img.compHeight);var n=0;u(this.img,(function(t){var i=Math.floor(t.getBoundingClientRect().width);n=Math.floor(i*e),t.style.minWidth="".concat(n,"px")}),(function(e){return e===t.container}));var i=window.getComputedStyle(this.container),r=i.marginLeft,o=i.marginRight,a=parseInt(r,10)+parseInt(o,10);if(a){var s=a*e-2-a;this.container.style.width="".concat(n+s,"px")}}}},{key:"fillText",value:function(e,t){e&&(t?"INPUT"===e.nodeName&&"button"===e.getAttribute("type")?e.value=t:e.innerText=t:d(e,(function(e){e.style.visibility="hidden"}),this.container))}},{key:"fillImg",value:function(e,t){var n=!1;e&&!e.canBeIgnored&&(t&&(e.style.width=e.compWidth,e.style.height=e.compHeight,"IMG"===e.nodeName?(e.style.objectFit="cover",e.src=t,n=!0):e.compBackground.includes("url(")?(e.style.background=e.compBackground.replace(/(.*url\()([^)"']*)(\).*)/,"$1".concat(t,"$3")),n=!0):"PICTURE"===e.nodeName&&Array.from(e.children).forEach((function(i){"IMG"===i.nodeName?(i.style.width=e.compWidth,i.style.height=e.compHeight,i.canBeIgnored=!0,i.style.objectFit="cover",i.src=t,i.setAttribute("srcset",t),n=!0):"SOURCE"===i.nodeName&&(i.setAttribute("srcset",t),i.src=t,n=!0)}))),n||d(e,(function(e){e.style.visibility="hidden"}),this.container))}},{key:"applyValues",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.fillText(this.title,n.title),this.fillText(this.desc,n.desc),this.fillText(this.ctatext,n.ctatext),this.fillText(this.sponsoredBy,n.sponsoredBy||n.domain),this.fillText(this.price,n.price),this.fillText(this.sponsoredLabel,n.sponsoredLabel||"Sponsorisé"),this.fillImg(this.img,null===(e=n.image)||void 0===e?void 0:e.url),this.fillImg(this.brandImg,null===(t=n.brandLogo)||void 0===t?void 0:t.url)}},{key:"replaceImg",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null!==(t=this.img)&&void 0!==t&&t.parentElement){var i=this.img;"PICTURE"===this.img.parentElement.nodeName&&(i=this.img.parentElement);var r=null;u(i,(function(e){r=e.getBoundingClientRect()}),(function(e){return r.width>50&&r.height>50}));var o=document.createElement("DIV"),a=i.parentElement;if(a.replaceChild(o,i),o.style.width="".concat(r.width,"px"),o.style.height="".concat(r.height,"px"),o.style.position=this.img.style.position,o.style.left=this.img.style.left,o.style.top=this.img.style.top,o.style.right=this.img.style.right,o.style.bottom=this.img.style.bottom,e.style.width="".concat(r.width,"px"),e.style.height="".concat(r.height,"px"),n)if(parseInt(this.img.compMarginLeft,10)){var s=r.width+parseInt(this.img.compMarginLeft,10)+parseInt(this.img.compMarginRight,10);o.style.width="".concat(s,"px"),e.style.width="".concat(s,"px"),o.style.left="0px",o.style.right="0px",o.style.margin="0px auto",e.style.margin="0px"}else{var l=16/9*r.height;o.style.width="".concat(l,"px"),e.style.width="".concat(l,"px"),o.style.left="0px",o.style.right="0px",o.style.margin="Opx auto",e.style.margin="0px"}else o.style.margin="0px"===this.img.compMargin?"auto":this.img.compMargin;o.appendChild(e)}}},{key:"setAdOverlay",value:function(e){var t=this;this.overlay=document.createElement("div"),this.container.style.position||(this.container.style.position="relative");var n=this.overlay.style;if(n.position="absolute",n.top="0px",n.left="0px",n.width="100%",n.height="100%",n.cursor="pointer",this.overlay.addEventListener("click",(function(n){e.url&&window.open(e.url,"_blank"),"function"==typeof t.onclick&&t.onclick(n)})),!this.sponsoredLabel){var i=document.createElement("div");i.style.color="#595959",i.style.position="absolute",i.style.width="100%",i.style.padding="0px 10px",this.sponsoredAlign.indexOf("bottom")>-1?i.style.bottom="10px":i.style.top="10px";var r="center";this.sponsoredAlign.indexOf("left")>-1?r="left":this.sponsoredAlign.indexOf("right")>-1&&(r="right"),i.style.textAlign=r,i.innerText=e.sponsoredLabel,this.overlay.appendChild(i)}if(e.privacyIcon){var o=document.createElement("img");o.style.position="absolute",o.style.top="0px",o.style.right="0px",o.style.width="20px",o.style.height="20px",o.src=e.privacyIcon,e.privacyUrl&&o.addEventListener("click",(function(){window.open(e.privacyUrl,"_blank")})),this.overlay.appendChild(o)}this.container.appendChild(this.overlay)}},{key:"insertNativeAd",value:function(e){this.applyValues(e),this.setAdOverlay(e)}},{key:"addOverlayElement",value:function(e,t){null!==e.parentElement&&e.parentElement.removeChild(e),this.overlay.appendChild(e),e.style.position="absolute",e.style.width="".concat(t.width,"px"),e.style.height="".concat(t.height,"px"),e.style.left="".concat(t.left,"px"),e.style.top="".concat(t.top,"px")}},{key:"getImgSrc",value:function(){var e=null;if(this.img)if("IMG"===this.img.nodeName)e=this.img.src;else if("PICTURE"===this.img.nodeName){var t,n=this.img.querySelector("source"),i=null==n?void 0:n.getAttribute("srcset");e=(null==i?void 0:i.split(" ").filter((function(e){return e.length>10})).pop())||(null===(t=this.img.querySelector("img"))||void 0===t?void 0:t.src)}return e}},{key:"getDescriptiveText",value:function(){var e,t,n,i=null===(e=this.title)||void 0===e?void 0:e.innerText;(null===(t=i)||void 0===t?void 0:t.toLowerCase().indexOf("retrait"))>-1&&(i="");var r=null===(n=this.desc)||void 0===n?void 0:n.innerText;return(!i||i.length<10)&&r&&(i=r),i}}],n&&gt(t.prototype,n),i&&gt(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}(),At=null;function wt(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"top",a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=new bt((i=i||e).cloneNode(!0),o);if(s.container.widthRatio=r,t.insertBefore(s.container,e),s.fetchElements(),r>1&&(s.scaleWidth(r),a)){var l=s.container.nextSibling;l.style.display="none",At=function(){l.style.visibility=""}}if(n[0].length>1){var c=n[0].length,u=0;Array.from(t.children).forEach((function(e){e.style.clear=u%c==0?"left":"none",u+=e.widthRatio||1}))}return s}function kt(e,t,n){if(At&&At(),e.parentElement.removeChild(e),n[0].length>1){var i=n[0].length;Array.from(t.children).forEach((function(e,t){e.style.clear=t%i==0?"left":"none"}))}}function Tt(e){return Tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tt(e)}function Et(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(r=i.key,o=void 0,o=function(e,t){if("object"!==Tt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==Tt(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===Tt(o)?o:String(o)),i)}var r,o}function Rt(){return Rt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var i=St(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},Rt.apply(this,arguments)}function St(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=xt(e)););return e}function Ot(e,t){return Ot=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ot(e,t)}function Ct(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=xt(e);if(t){var r=xt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Pt(this,n)}}function Pt(e,t){if(t&&("object"===Tt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function xt(e){return xt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},xt(e)}var Lt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ot(e,t)}(o,e);var t,n,i,r=Ct(o);function o(e,t,n,i){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(a=r.call(this,e,t,n,i)).id="IngridFormat",a.speed=.7,a.animatedDiv=document.createElement("div"),a.animatedDiv.style.overflow="hidden",a.animatedDiv.style.height="100%",a.animatedDiv.style.width="0px",a.animatedDiv.style.transition="width ease ".concat(a.speed,"s"),a.adLoaded=!1,a}return t=o,n=[{key:"callStart",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.placeholder=wt(e,t,n,i,Math.min(n[0].length,this.config.ingridSize),this.config.sponsoredAlign,this.config.hideNext);var r=getComputedStyle(this.placeholder.container),o=r.width,a=r.height;this.resizeAd(parseInt(o,10),parseInt(a,10),"normal"),this.placeholder.container.style.minHeight="".concat(a,"px"),this.placeholder.container.replaceChildren(this.animatedDiv),this.placeholder.applyValues(),this.playerDiv.style.margin="auto",this.animatedDiv.appendChild(this.playerDiv),this.playerInserted=!0,this.startAd()}},{key:"insertPlayer",value:function(e){var t=this,n=ht(window.document.querySelector(e)),i=n.itemList,r=n.gridProfile,o=n.clonedElement,a=n.startIndex,s=n.endIndex;i?l((function(){var e=r[0].length,n=r.length,l=a;"right"===t.config.align?l=1===n?s-parseInt(t.config.ingridSize,10)-1:e-parseInt(t.config.ingridSize,10)-1:"center"===t.config.align&&(l=Math.floor((e-1)/2));var u=Array.from(i.children);e>1&&(u=Array.from(i.children).filter((function(e,t){return!!e.offsetParent})).filter((function(t,n){return n%e===l})));var d=c(u);t.itemList=i,t.gridProfile=r,t.callStart(d,i,r,o)})):k(w.DEBUG,"Cannot find retail item grid.")}},{key:"initAd",value:function(e,t,n,i,r,a){Rt(xt(o.prototype),"initAd",this).call(this,e,t,n,i,r,a)}},{key:"onAdLoaded",value:function(){this.adLoaded=!0,Rt(xt(o.prototype),"onAdLoaded",this).call(this)}},{key:"startAd",value:function(){this.adLoaded&&this.playerInserted&&Rt(xt(o.prototype),"startAd",this).call(this)}},{key:"onAdStarted",value:function(){Rt(xt(o.prototype),"onAdStarted",this).call(this),this.open()}},{key:"open",value:function(){this.animatedDiv.style.width=this.playerDiv.style.width}},{key:"close",value:function(){var e=this;this.animatedDiv.style.width="0px",window.setTimeout((function(){var t;null!==(t=e.placeholder.container)&&void 0!==t&&t.parentElement&&kt(e.placeholder.container,e.itemList,e.gridProfile)}),1e3*this.speed)}},{key:"onAdStopped",value:function(){Rt(xt(o.prototype),"onAdStopped",this).call(this),this.close()}},{key:"onAdVideoComplete",value:function(){Rt(xt(o.prototype),"onAdVideoComplete",this).call(this),this.close()}}],n&&Et(t.prototype,n),i&&Et(t,i),Object.defineProperty(t,"prototype",{writable:!1}),o}(Ve);function It(e){return It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},It(e)}function Nt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(r=i.key,o=void 0,o=function(e,t){if("object"!==It(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==It(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===It(o)?o:String(o)),i)}var r,o}function jt(e,t){return jt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},jt(e,t)}function Dt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Vt(e);if(t){var r=Vt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Ut(this,n)}}function Ut(e,t){if(t&&("object"===It(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Vt(e){return Vt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Vt(e)}var _t=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jt(e,t)}(o,e);var t,n,i,r=Dt(o);function o(e,t,n,i){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(a=r.call(this,e,t,n,i)).id="IngridNativeFormat",a}return t=o,n=[{key:"callStart",value:function(e,t,n){var i=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.placeholder=wt(e,t,n,r,Math.min(n[0].length,this.config.ingridSize),this.config.sponsoredAlign,this.config.hideNext);var o=getComputedStyle(this.placeholder.container),s=o.width,l=o.height;this.resizeAd(parseInt(s,10),parseInt(l,10),"normal"),this.placeholder.container.style.minHeight="".concat(l,"px"),this.config.bgColor&&(this.placeholder.container.style.backgroundColor=this.config.bgColor),this.placeholder.insertNativeAd(this.config.nativeData),this.placeholder.onclick=function(e){i.getInnerCreative().onAdClickThru()},this.placeholder.replaceImg(this.playerDiv,this.config.enlargeVideo);var c=a(this.playerDiv,this.placeholder.container);this.placeholder.addOverlayElement(this.adContainer,c),this.playerDiv.style.margin="auto",this.playerInserted=!0,this.startAd()}}],n&&Nt(t.prototype,n),i&&Nt(t,i),Object.defineProperty(t,"prototype",{writable:!1}),o}(Lt);function Bt(e){return Bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bt(e)}function Mt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(r=i.key,o=void 0,o=function(e,t){if("object"!==Bt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==Bt(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===Bt(o)?o:String(o)),i)}var r,o}function Ft(){return Ft="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var i=Wt(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},Ft.apply(this,arguments)}function Wt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Gt(e)););return e}function Ht(e,t){return Ht=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ht(e,t)}function zt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Gt(e);if(t){var r=Gt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return qt(this,n)}}function qt(e,t){if(t&&("object"===Bt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Gt(e){return Gt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Gt(e)}var Qt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ht(e,t)}(o,e);var t,n,i,r=zt(o);function o(e,t,n,i){var a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);var s=i.ingridSize;return i.ingridSize-=1,(a=r.call(this,e,t,n,i)).totalSize=s,a.id="IngridSideBySideFormat",a}return t=o,n=[{key:"callStart",value:function(e,t,n){var i=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.config.videoPosition===O&&Ft(Gt(o.prototype),"callStart",this).call(this,e,t,n,r),this.placeholder2=wt(e,t,n,r,1,this.config.sponsoredAlign,this.config.hideNext);var a=getComputedStyle(this.placeholder2.container),s=a.height;this.placeholder2.container.style.minHeight="".concat(s,"px"),this.config.bgColor&&(this.placeholder2.container.style.backgroundColor=this.config.bgColor),this.placeholder2.insertNativeAd(this.config.nativeData),this.placeholder2.onclick=function(e){i.getInnerCreative().onAdClickThru()},this.config.videoPosition===C&&Ft(Gt(o.prototype),"callStart",this).call(this,e,t,n,r)}},{key:"close",value:function(){var e=this;Ft(Gt(o.prototype),"close",this).call(this),window.setTimeout((function(){var t;null!==(t=e.placeholder2.container)&&void 0!==t&&t.parentElement&&kt(e.placeholder2.container,e.itemList,e.gridProfile)}),1e3*this.speed)}}],n&&Mt(t.prototype,n),i&&Mt(t,i),Object.defineProperty(t,"prototype",{writable:!1}),o}(Lt);function Xt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R.AUTO,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:T,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};switch(e){case R.INTEXT:return Ye;case R.INGRID:return t!==E?Lt:n.videoPosition===O||n.videoPosition===C?(1===n.ingridSize&&(k(w.WARN,"ingridSize should be increase to show video and article side-by-side."),n.ingridSize=2),Qt):_t;case R.SLIDER:return lt;default:return Ve}}function Yt(e){return Yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yt(e)}function Kt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(r=i.key,o=void 0,o=function(e,t){if("object"!==Yt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==Yt(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===Yt(o)?o:String(o)),i)}var r,o}var Zt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.OM_SERVICE_URL="".concat(A,"omweb-v1.js"),this.OM_SESSION_URL="".concat(A,"omid-session-client-v1.js")}var t,n,i;return t=e,(n=[{key:"insertOMScript",value:function(e){var t=this,n=h();if(n.document.getElementsByClassName("rs-om-service").length>0)this.OmidSessionClient=n.OmidSessionClient&&n.OmidSessionClient.default,e();else{var i=document.createElement("script");i.className="ayl-om_service",i.type="text/javascript",i.setAttribute("src",this.OM_SERVICE_URL),i.addEventListener("load",(function(){var i=document.createElement("script");i.className="ayl-om_service",i.type="text/javascript",i.setAttribute("src",t.OM_SESSION_URL),i.addEventListener("load",(function(){t.OmidSessionClient=n.OmidSessionClient&&n.OmidSessionClient.default,e()})),n.document.body.appendChild(i)})),n.document.head.appendChild(i)}}},{key:"createOMSession",value:function(e,t,n){var i=this;this.vpaid=t,this.video=n;var r=h(),o=r.document.URL,a=g,s=new this.OmidSessionClient.Partner("RetailSpot",a),l=e.adVerifications.map((function(e){var t=e.resource;return new i.OmidSessionClient.VerificationScriptResource(t,e.vendor,e.verificationParameters,"full")})),c=new this.OmidSessionClient.Context(s,l,o);c.setServiceWindow(r),c.setVideoElement(n),this.adSession=new this.OmidSessionClient.AdSession(c),this.adSession.isSupported()&&(this.adSession.setCreativeType("video"),this.adEvents=new this.OmidSessionClient.AdEvents(this.adSession),this.mediaEvents=new this.OmidSessionClient.MediaEvents(this.adSession),this.adSession.start(),this.addListeners())}},{key:"addListeners",value:function(){var e=this;this.vpaid.subscribe((function(){var t=new e.OmidSessionClient.VastProperties(!1,0,!0,"standalone");e.adEvents.loaded(t)}),L.AdLoaded),this.vpaid.subscribe((function(){e.adEvents.impressionOccurred(),e.mediaEvents.start(e.video.duration,e.video.volume)}),L.AdStarted),this.vpaid.subscribe((function(){e.mediaEvents.firstQuartile()}),L.AdVideoFirstQuartile),this.vpaid.subscribe((function(){e.mediaEvents.midpoint()}),L.AdVideoMidpoint),this.vpaid.subscribe((function(){e.mediaEvents.thirdQuartile()}),L.AdVideoThirdQuartile),this.vpaid.subscribe((function(){e.mediaEvents.complete(),setTimeout((function(){var t;null===(t=e.adSession)||void 0===t||t.finish()}),3e3)}),L.AdVideoComplete)}}])&&Kt(t.prototype,n),i&&Kt(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}(),$t='<svg xmlns="http://www.w3.org/2000/svg" height="{{HEIGHT}}px" viewBox="0 0 24 24" width="{{WIDTH}}px" fill="#FFFFFF"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>',Jt='<svg xmlns="http://www.w3.org/2000/svg" height="{{HEIGHT}}px" viewBox="0 0 24 24" width="{{WIDTH}}px" fill="#FFFFFF"><path d="M0 0h24v24H0z" fill="none"/><path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"/></svg>',en='<svg xmlns="http://www.w3.org/2000/svg" height="{{HEIGHT}}px" viewBox="0 0 24 24" width="{{WIDTH}}px" fill="#FFFFFF"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/></svg>';function tn(e,t,n){var i=document.createElement("div");return i.innerHTML=e.replace("{{HEIGHT}}",n||48).replace("{{WIDTH}}",t||48),i}function nn(e){return nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nn(e)}function rn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(r=i.key,o=void 0,o=function(e,t){if("object"!==nn(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==nn(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===nn(o)?o:String(o)),i)}var r,o}function on(){return on="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var i=an(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},on.apply(this,arguments)}function an(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=un(e)););return e}function sn(e,t){return sn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},sn(e,t)}function ln(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=un(e);if(t){var r=un(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return cn(this,n)}}function cn(e,t){if(t&&("object"===nn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function un(e){return un=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},un(e)}var dn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sn(e,t)}(o,e);var t,n,i,r=ln(o);function o(e,t,n,i){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(a=r.call(this,e,t,n,i)).id="DisplayWrapper",a.config=i,a.currentVolume=0,a}return t=o,(n=[{key:"onAdLoaded",value:function(){on(un(o.prototype),"onAdLoaded",this).call(this);var e=18;if(this.playerWidth&&(e=Math.min(18,Math.min(32,this.playerWidth/10))),this.config.closeButton){var t=tn($t,e,e);t.onclick=this.handleClose.bind(this),t.style.position="absolute",t.style.right="8px",t.style.top="8px",t.style.cursor="pointer",this.adContainer.appendChild(t)}this.config.soundButton&&(this.soundon=tn(en,e,e),this.soundon.onclick=this.handleToggleAdVolume.bind(this),this.soundon.style.position="absolute",this.soundon.style.right="8px",this.soundon.style.bottom="8px",this.soundon.style.cursor="pointer",this.soundon.style.display="none",this.soundon.style.lineHeight="0px",this.soundon.style.backgroundColor="rgb(0 0 0 / 30%)",this.soundon.style.borderRadius="50px",this.soundon.style.padding="4px",this.adContainer.appendChild(this.soundon),this.soundoff=tn(Jt,e,e),this.soundoff.onclick=this.handleToggleAdVolume.bind(this),this.soundoff.style.position="absolute",this.soundoff.style.right="8px",this.soundoff.style.bottom="8px",this.soundoff.style.cursor="pointer",this.soundoff.style.display="visible",this.soundoff.style.lineHeight="0px",this.soundoff.style.backgroundColor="rgb(0 0 0 / 30%)",this.soundoff.style.borderRadius="50px",this.soundoff.style.padding="4px",this.adContainer.appendChild(this.soundoff))}},{key:"onAdStarted",value:function(){on(un(o.prototype),"onAdStarted",this).call(this),on(un(o.prototype),"setAdVolume",this).call(this,0)}},{key:"stopAd",value:function(){on(un(o.prototype),"stopAd",this).call(this)}},{key:"handleClose",value:function(e){e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation(),this.stopAd()}},{key:"handleToggleAdVolume",value:function(e){e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation();var t=this.getAdVolume();0===t?(this.soundon.style.display="",this.soundoff.style.display="none",t=1):(this.soundon.style.display="none",this.soundoff.style.display="",t=0),on(un(o.prototype),"setAdVolume",this).call(this,t)}}])&&rn(t.prototype,n),i&&rn(t,i),Object.defineProperty(t,"prototype",{writable:!1}),o}(W);function pn(t){var n=(new DOMParser).parseFromString(t,"text/xml");return(new e.VASTParser).parseVAST(n).catch((function(e){throw k(w.WARN,"VAST Parse error.",e),e}))}function hn(e,t){return new Promise((function(n,i){try{var r=new XMLHttpRequest;r.open("POST",e,!0),r.setRequestHeader("Content-Type","application/json"),r.onreadystatechange=function(){4===r.readyState&&(200===r.status?n(r.responseText):i(new Error("POST request status code: ".concat(r.status))))},r.send(JSON.stringify(t))}catch(e){i(e)}}))}function fn(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"vast4",i=e.placement.split("-");if("eq"!==i[0])throw new Error("Wrong placement id format: ".concat(e.placementId));var r=i[1],o=i[2],a=i[3],s=i[4],l={timestamp:(new Date).getTime(),networkId:r,siteId:o,pageId:a,master:"m",screen:{height:window.screen.height,width:window.screen.width},ads:[{formatId:s}],output:n,gdpr_consent:t.gdpr_consent_string};return new Promise((function(e,t){hn("https://prg.smartadserver.com/genericpost",l).then((function(n){pn(n).then((function(t){e(t)})).catch((function(e){t(e)}))})).catch((function(e){t(e)}))}))}function vn(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return k(w.WARN,"call with not : ".concat(n)),new Promise((function(i,r){fn(e,t).then((function(e){var t;if((null===(t=e.ads)||void 0===t||!t.length)&&n>0)throw new Error("Vast Empty");i(e)})).catch((function(o){k(w.WARN,"Equative - no ad. retry : ".concat(n)),0===n?r(o):setTimeout((function(){vn(e,t,--n).then((function(e){i(e)}))}),500)}))}))}function yn(e,t,n){return new Promise((function(i,r){e.preloaded?pn(e.preloaded).then((function(e){i(e)})):e.vastUrl?n.get(e.vastUrl).then((function(e){i(e)})).catch((function(e){r(e)})):e.placement?vn(e,t,e.retryrequest).then((function(e){i(e)})).catch((function(e){r(e)})):r(new Error("Missing Config.placement."))}))}function mn(e){return mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mn(e)}function gn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function bn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gn(Object(n),!0).forEach((function(t){An(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function An(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==mn(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==mn(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===mn(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wn(e,t,n){fn(e,n,"json").then((function(e){e.ad||(k("No ad."),t&&t(null)),e={title:"ZOE E-TECH Electrique",price:"33 700 €",desc:"Essayez la nouvelle Zoe 100% électrique",ctatext:"En savoir plus",url:"https://www.renault.fr/vehicules-electriques/zoe/prix-versions.html",domain:"renault.fr",image:{url:"http://localhost:3000/docs/sample/zoe.jpeg"},brandLogo:{url:"http://no.link.no"},privacyIcon:"https://static.criteo.net/flash/icon/privacy_small.svg",privacyUrl:"https://www.amazon.fr/adprefs/ref=cs_aap_584215806745266336"};var n=function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"top",n=ht(),i=n.itemList,r=n.gridProfile,o=n.clonedElement,a=[],s=i.children[e-1],l=new bt((o||s).cloneNode(!0),t);if(a.push(l),i.insertBefore(a[0].container,s.nextSibling),l.fetchElements(),r[0].length>1){var c=r[0].length;Array.from(i.children).forEach((function(e,t){e.style.clear=t%c==0?"left":"none"}))}return a}(1,1)[0];n.container.id="RS-ad-".concat(Math.round(1e4*Math.random())),n.insertNativeAd(e)})).catch((function(e){k(w.WARN,"Error loading native ad. ".concat(e.stack))}))}function kn(t,n,i){var r=bn(bn({},function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R.AUTO,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:T;return e===R.INGRID?t===E?P:x:S}(t.format,t.mediatype)),t);"native"===r.mediatype&&r.hasNative?wn(r,n,i):function(t,n,i){var r=new e.VASTClient;yn(t,i,r).then((function(i){var o;if(null===(o=i.ads)||void 0===o||!o.length)return k("No ad."),void(n&&n(null));var a=document.createElement("video");a.setAttribute("playsinline","true"),a.setAttribute("webkit-playsinline","true");var s,l,c,u,d=document.createElement("div");d.id="RS-ad-".concat(Math.round(1e4*Math.random()));try{l=(s=i.ads[0]).creatives.find((function(e){var t;return(null===(t=e.mediaFiles)||void 0===t?void 0:t.length)>0})),c=new e.VASTTracker(r,s,l)}catch(e){k(w.WARN,"Error retreiving creative. ",e),n&&n(null)}var p=[],h=[];l.mediaFiles.forEach((function(e){"VPAID"===e.apiFramework&&"application/x-shockwave-flash"!==e.mimeType?p.push(e):h.push(e)})),p.length>0?u=new Z(a,d,p[0],l.adParameters):h.length>0?u=new re(a,d,h):k(w.WARN,"No mediafile to play for vast"),u=new Ce(u,a,d,c);var f=Xt(t.format,t.mediatype,t);if(u=new f(u,a,d,t),u=new dn(u,a,d,t),c.ad.adVerifications.length>0){var v=new Zt;try{v.insertOMScript((function(){try{v.createOMSession(c.ad,u,a)}catch(e){k(w.INFO,"Couldn't create OM session")}u.initAd(t.width,t.height,"normal",null,{},t)}))}catch(e){k(w.INFO,"Couldn't insert OM script")}}else u.initAd(t.width,t.height,"normal",null,{},t);"function"==typeof n&&n(u)})).catch((function(e){k(w.WARN,"Error loading vast file. ".concat(e.stack))}))}(r,n,i)}function Tn(e,t){y((function(n){k("Show ad with config:",e),n&&k("Consent:",n),Array.isArray(e)?e.forEach((function(e){return kn(e)})):kn(e,t,n)}))}window.RetailSpotConfig&&Tn(window.RetailSpotConfig)})(),RetailSpot=i})();